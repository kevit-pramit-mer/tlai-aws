{"version":3,"file":"scripts.js","sources":["../../.tmp/concat/scripts/scripts.js"],"names":["createAudioMeter","audioContext","clipLevel","averaging","clipLag","processor","createScriptProcessor","onaudioprocess","volumeAudioProcess","clipping","lastClip","volume","connect","destination","checkClipping","this","window","performance","now","shutdown","disconnect","event","x","buf","inputBuffer","getChannelData","bufLength","length","sum","i","Math","abs","rms","sqrt","max","$","JsonRpcClient","options","self","extend","ajaxUrl","socketUrl","onmessage","login","passwd","sessid","loginParams","userVariables","getSocket","onmessage_cb","_getSocket","ws_cnt","wsOnMessage","_wsOnMessage","prototype","_ws_socket","_ws_callbacks","_current_id","speedTest","bytes","cb","socket","speedCB","speedBytes","send","loops","rem","data","Array","join","call","method","params","success_cb","error_cb","request","jsonrpc","id","e","console","log","_wsCall","ajax","type","url","toJSON","dataType","cache","success","error","result","jqXHR","textStatus","errorThrown","response","parseJSON","responseText","err","notify","batch","callback","all_done_cb","_batchObject","_execute","socketReady","readyState","closeSocket","onclose","w","close","loginData","connectSocket","to","clearTimeout","authing","WebSocket","ws_sleep","onWSClose","setTimeout","onopen","onWSConnect","req","q","pop","stopRetrying","request_json","push","request_obj","orig_req","code","onWSLogin","eventData","reply","msg","up_dur","parseInt","substring","down_dur","up_kps","toFixed","down_kps","info","upDur","downDur","upKPS","downKPS","jsonrpcclient","_requests","batch_request","handlers","undefined","_batchCb","jQuery","findLine","sdpLines","prefix","substr","findLineInRange","startLine","endLine","realEndLine","indexOf","toLowerCase","getCodecPayloadType","sdpLine","pattern","RegExp","match","setCompat","checkCompat","onStreamError","doCallback","onStreamSuccess","stream","onICE","candidate","mediaData","candidateList","func","arg","callbacks","onICEComplete","onChannelError","onICESDP","sdp","SDP","stereoHack","onRemoteStream","useVideo","style","display","element","useAudio","FSRTCattachMediaStream","play","remoteStream","onOfferSDP","getMediaParams","obj","audio","useMic","videoParams","screenShare","advanced","deviceId","exact","audioParams","key","con","localVideo","getUserMedia","constraints","video","onsuccess","localVideoStream","onerror","bestFrameRate","vertoBestFrameRate","minFrameRate","opt","sourceId","useCamera","maxFrameRate","mandatory","optional","width","min","minWidth","maxWidth","height","minHeight","maxHeight","frameRate","ideal","FSRTCPeerConnection","ice_handler","done","gathering","peer","localDescription","createOffer","sessionDescription","serializeSdp","setLocalDescription","onSdpError","createAnswer","setRemoteDescription","RTCSessionDescription","offerSDP","onSdpSuccess","onAnswerSDP","openOffererChannel","onChannelMessage","_openOffererChannel","channel","createDataChannel","reliable","setChannelEvents","onChannelOpened","onChannelClosed","warn","config","default_ice","urls","iceServers","RTCPeerConnection","onicecandidate","attachStream","addStream","attachStreams","streams","onaddstream","remoteMediaStream","oninactive","onRemoteStreamEnded","addAnswerSDP","cbSuccess","cbError","addICE","addIceCandidate","RTCIceCandidate","sdpMLineIndex","sendData","message","stop","active","streaming","URL","createObjectURL","media","n","navigator","getMedia","video_constraints","FSRTC","useStereo","userData","audioEnabled","videoEnabled","profile","offerToReceiveAudio","useSpeak","offerToReceiveVideo","validRes","local","on","opusPayload","split","opusIndex","fmtpLineIndex","toString","concat","attachMediaStream","srcObject","src","answer","onSuccess","onError","stopPeer","localStream","tracks","getTracks","forEach","track","index","getMute","setMute","what","audioTracks","getAudioTracks","len","enabled","getVideoMute","setVideoMute","videoTracks","getVideoTracks","remoteSDP","debug","mediaParams","screen","resSupported","h","bestResSupported","resList","resI","ttl","checkRes","cam","res","localStorage","setItem","getValidRes","cached","getItem","checkPerms","runtime","check_audio","check_video","drop_bad","verto","eventSUBS","mark_ready","j","ready","readyHandler","do_subscribe","subChannels","sparams","eventChannel","handler","serno","SERNO","isnew","createMainModeratorMethods","conf","listVideoLayouts","modCommand","file","deaf","memberID","undeaf","record","stopRecord","snapshot","hasVid","setVideoLayout","layout","canvasID","kick","muteMic","muteVideo","presenter","videoFloor","banner","text","escape","volumeDown","volumeUp","gainDown","gainUp","transfer","exten","sendChat","rpcClient","laData","chatChannel","action","checkStateChange","oldS","newS","state","purge","states","name","find_name","audioOutDevices","source","generateGUID","crypto","Uint16Array","getRandomValues","S4","num","ret","replace","c","r","random","v","saved","tag","localTag","deviceParams","onResCheck","ringSleep","dialogs","handleMessage","o","ringFile","ringer","logout","body","sendMethod","processReply","unauthorizedChannels","subscribedChannels","subscribe","subParams","unsubscribe","handle","unsubChannels","sendChannels","repl","u","broadcast","callID","setState","hangup","dialog","newCall","args","direction","outbound","invite","rtc","handleAnswer","handleMedia","handleDisplay","handleInfo","attach","inbound","recovering","wantVideo","list","onMessage","pvtEvent","sendMessage","sub","onEvent","from","del_array","array","hashArray","vha","hash","reorder","a","clear","add","val","insertAt","redraw","del","get","order","arrayLen","asArray","each","dump","html","str","JSON","stringify","liveArray","context","la","lastSerno","binding","user_obj","userObj","_add","_del","_reorder","_clear","errs","onChange","checkSerno","onErr","bootstrap","init","bootObj","modify","ok","eventHandler","packet","wireSerno","hashKey","arrIndex","destroy","sendCommand","cmd","command","changepage","heartbeat","hb_pid","liveTable","jq","genRow","tmp","oldStatus","genArray","dt","lt","dataTable","fnDestroy","iserr","aoColumns","sTitle","fnClearTable","fnAddData","fnAdjustColumnSizing","fnUpdate","fnDeleteRow","hide","show","CONFMAN_SERNO","onBroadcast","onLaChange","onLaRow","modChannel","chatCallback","value","application","destroyed","modfuncs","confMan","genMainMod","play_id","stop_id","recording_id","snapshot_id","rec_stop_id","div_id","change_video_layout","canvas_id","canvasCount","vlayout_id","vlselect_id","vlhtml","append","click","prompt","genControls","rowid","kick_id","canvas_in_next_id","canvas_in_prev_id","canvas_out_next_id","canvas_out_prev_id","canvas_in_set_id","canvas_out_set_id","layer_set_id","layer_next_id","layer_prev_id","tmute_id","tvmute_id","vbanner_id","tvpresenter_id","tvfloor_id","box_id","gainup_id","gaindn_id","volup_id","voldn_id","transfer_id","mouseover","mouse","mouseout","xten","cid","tableID","statusID","mainModID","atitle","awidth","role","displayID","selectmenu","empty","Option","responseData","rdata","sort","b","ga","gb","lastTimeout","row_callback","nRow","aData","iDisplayIndex","iDisplayIndexFull","$row","laChannel","laName","confEvent","laChange","aaData","sWidth","bAutoWidth","bDestroy","bSort","bInfo","bFilter","bLengthChange","bPaginate","iDisplayLength","oLanguage","sEmptyTable","fnRowCallback","lastState","answered","audioStream","document","getElementById","videoStream","RTCcallbacks","display_direction","remote_caller_id_name","caller_id_name","remote_caller_id_number","caller_id_number","callee_id_name","callee_id_number","destination_number","requesting","answering","location","reload","onStream","permissionCallback","onGranted","onDenied","cause","ring","dialogParams","setAudioPlaybackDevice","sinkId","devname","setSinkId","then","errorMessage","ringing","stopRinging","causeCode","onDialogState","early","speaker","trying","remove","holdState","held","indicateRing","attr","dtmf","digits","dest","hold","unhold","toggleHold","gotAnswer","gotEarly","cidString","enc","party","display_name","display_number","ENUM","s","map","Object","freeze","new","unloadJobs","bind","f","warnOnUnload","videoDevices","audioInDevices","checkDevices","aud_in","aud_out","vid","mediaDevices","enumerateDevices","MediaStreamTrack","getSources","devices","device","kind","label","media_sources","refreshDevices","skipPermCheck","skipDeviceCheck","status","genUUID","AdapterJS","exports","module","VERSION","onwebrtcready","isUsingPlugin","_onwebrtcreadies","webRTCReady","Error","onwebrtcreadyDone","WebRTCPlugin","plugin","pluginInfo","plugName","pluginId","onload","portalLink","downloadLink","companyName","platform","TAGS","NONE","AUDIO","VIDEO","pageId","slice","setLogLevel","defineWebRTCInterface","isPluginInstalled","pluginInjectionInterval","injectPlugin","PLUGIN_STATES","INITIALIZING","INJECTING","INJECTED","READY","pluginState","PLUGIN_LOG_LEVELS","ERROR","WARNING","INFO","VERBOSE","SENSITIVE","WaitForPluginReady","callWhenPluginReady","__TemWebRTCReady0","maybeThroughWebRTCReady","timer","setInterval","clearInterval","TEXT","PLUGIN","REQUIRE_INSTALLATION","NOT_SUPPORTED","BUTTON","REFRESH","REQUIRE_REFRESH","_iceConnectionStates","starting","checking","connected","completed","disconnected","failed","closed","_iceConnectionFiredStates","isDefined","parseWebrtcDetectedBrowser","hasMatch","opr","addons","opera","userAgent","webrtcDetectedBrowser","webrtcDetectedType","webrtcMinimumVersion","exec","webrtcDetectedVersion","InstallTrigger","HTMLElement","documentMode","StyleMedia","chrome","webstore","CSS","addEvent","elem","evnt","addEventListener","attachEvent","renderNotificationBar","buttonText","buttonLink","openNewTab","displayRefreshBar","createElement","position","top","left","right","backgroundColor","border","borderBottom","zIndex","webkitTransition","transition","appendChild","contentWindow","contentDocument","open","write","EXTENSION","preventDefault","cancelBubble","pluginInstallInterval","isIE","plugins","refresh","removeChild","webkitTransform","transform","checkMediaDataChannelSettings","peerBrowserAgent","peerBrowserVersion","beOfferer","isLocalFirefox","isLocalFirefoxInterop","isPeerFirefox","MozDontOfferDataChannel","prop","hasOwnProperty","checkIceConnectionState","peerId","iceConnectionState","createIceServer","createIceServers","reattachMediaStream","mozGetUserMedia","webkitGetUserMedia","define","amd","g","global","adapter","t","require","l",1,"SDPUtils","generateIdentifier","localCName","splitLines","blob","trim","line","splitSections","parts","part","matchPrefix","filter","parseCandidate","foundation","component","protocol","priority","ip","port","relatedAddress","relatedPort","tcpType","writeCandidate","toUpperCase","parseRtpMap","parsed","payloadType","shift","clockRate","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","uri","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","parameters","keys","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","getDtlsParameters","mediaSection","sessionpart","fpLine","dtlsParameters","fingerprints","algorithm","writeDtlsParameters","setupType","fp","getIceParameters","iceParameters","usernameFragment","password","writeIceParameters","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","mline","rtpmapline","fmtps","writeRtpDescription","caps","parseRtpEncodingParameters","secondarySsrc","encodingParameters","hasRed","hasUlpfec","ssrcs","primarySsrc","flows","apt","encParam","codecPayloadType","rtx","parse","fec","mechanism","bandwidth","maxBitrate","writeSessionBoilerplate","writeMediaSection","transceiver","iceGatherer","getLocalParameters","dtlsTransport","mid","rtpSender","rtpReceiver","msid","sendEncodingParameters","getDirection",2,"logging","browserDetails","extractVersion","disableLog","chromeShim","edgeShim","firefoxShim","safariShim","browser","shimPeerConnection","browserShim","shimGetUserMedia","shimMediaStream","shimSourceObject","shimOnTrack","./chrome/chrome_shim","./edge/edge_shim","./firefox/firefox_shim","./safari/safari_shim","./utils",3,"MediaStream","webkitMediaStream","defineProperty","_ontrack","set","removeEventListener","_ontrackpoly","te","Event","receiver","dispatchEvent","HTMLMediaElement","_srcObject","revokeObjectURL","pcConfig","pcConstraints","iceTransportPolicy","iceTransports","pc","webkitRTCPeerConnection","origGetStats","getStats","selector","successCallback","errorCallback","arguments","fixChromeStats_","standardReport","reports","report","standardStats","timestamp","names","stat","makeMapStats","stats","legacyStats","Map","successCallbackWrapper_","apply","Promise","resolve","reject","generateCertificate","nativeMethod","opts","version","promise","nativeAddIceCandidate","../utils.js","./getusermedia",4,"constraintsToChrome_","cc","oldname_","charAt","oc","mix","shimConstraints_","face","facingMode","getSupportedConstraints","d","back","find","shimError_","PermissionDeniedError","ConstraintNotSatisfiedError","constraint","constraintName","getUserMedia_","getUserMediaPromise_","kinds","groupId","origGetUserMedia","cs",5,"RTCIceGatherer","_eventTarget","createDocumentFragment","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onnegotiationneeded","ondatachannel","localStreams","remoteStreams","getLocalStreams","getRemoteStreams","remoteDescription","signalingState","iceGatheringState","iceOptions","gatherPolicy","TypeError","usingBundle","bundlePolicy","server","transceivers","_localIceCandidatesBuffer","_emitBufferedCandidates","sections","end","complete","every","clone","_maybeFireNegotiationNeeded","removeStream","idx","splice","getSenders","getReceivers","_getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","lCodec","rCodec","lHeaderExtension","rHeaderExtension","_createIceAndDtlsTransports","iceTransport","RTCIceTransport","onlocalcandidate","evt","sdpMid","cand","onicestatechange","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","_transceive","recv","encodings","cname","recvEncodingParameters","receive","_pendingOffer","isIceLite","rejected","remoteIceParameters","cands","setRemoteCandidates","remoteDtlsParameters","start","_updateSignalingState","hasCallback","p","receiverList","remoteSsrc","isComplete","addTrack","transports","RTCRtpReceiver","getCapabilities","localTrack","RTCRtpSender","item","trackEvent","newState","connecting","offerOptions","numAudioTracks","numVideoTracks","wantReceive","desc","addRemoteCandidate","mLineIndex","promises","results","all",6,7,"mozSrcObject","mozRTCPeerConnection","newIceServers","newServer","username","credential","mozRTCSessionDescription","mozRTCIceCandidate","nativeGetStats","onSucc","../utils",8,"SecurityError","The operation is insecure.","constraintsToFF37_","infos","orgEnumerateDevices",9,10,"logDisabled_","utils","bool","uastring","expr","pos","detectBrowser","successCb","facing","iceServer","urlParts","turnUrlParts","attachMediaStream_base","reattachMediaStream_base","requestUserMedia","dir","exception","trace","count","time","timeEnd","group","groupCollapsed","groupEnd","checkPluginReadyState","logLevel","frag","innerHTML","getAllCams","firstChild","comName","installedCb","notInstalledCb","ActiveXObject","pluginArray","variable","hasCredentials","ConstructSessionDescription","servers","isArray","invalidConstraits","constructor","PEER_CONNECTION_VERSION","PeerConnection","GetSources","failureCallback","parentNode","streamId","enableSoundTracks","elementId","nodeName","temp","classHTML","className","attributes","clientWidth","clientHeight","insertBefore","children","setStreamId","newElement","forwardEventHandlers","getPrototypeOf","getStreamWithId","destElem","srcElem","properties","getOwnPropertyNames","propName","subPrototype","ConstructIceCandidate","pluginNeededButNotInstalledCb","pluginNeededButNotInstalledCbPriv","hidePluginInstallPrompt","popupString","getScreenConstraints","screen_constraints","chromeMediaSource","chromeMediaSourceId","postMessage","iframe","isLoaded","captureSourceId","loadIFrame","loadCallback","documentElement","getScreenId","onIFrameCallback","chromeExtensionStatus","mozMediaSource","mediaSource","domain","k","m","String","fromCharCode","charCodeAt","unescape","encodeURIComponent","md5","vertoApp","angular","constant","languages","dialects","en","en_GB","en_US","it","it_IT","fr","fr_FR","fr_CA","pt_BR","pt_PT","de","de_DE","es","es_ES","pl","pl_PL","ru","ru_RU","sv","sv_SV","sv_FI","da","da_DK","id_ID","zh","zh_CN","zh_TW","zh_HK","$routeProvider","gravatarServiceProvider","$translateProvider","configLanguages","when","title","templateUrl","controller","otherwise","redirectTo","defaults","default","reg_langs","useStaticFilesLoader","suffix","registerAvailableLanguageKeys","preferredLanguage","determinePreferredLanguage","fallbackLanguage","useSanitizeValueStrategy","run","$rootScope","$location","toastr","$on","next","current","path","previous","$$route","safeProtocol","promptInput","input","isFunction","$scope","$timeout","storage","splashscreen","progress_percentage","interrupt_next","errors","link","activity","checkProgressState","current_progress","soft","interrupt","calculate","confirm","getProgressMessage","ev","$http","Fullscreen","$anchorScroll","$translate","scrollToChatBottom","querySelector","scrollTop","scrollHeight","clearConferenceChat","members","messages","CLEAN_MESSAGE","getResByLayout","layoutsData","confLayoutsData","resIDS","clearMembersResID","preserve","member","resID","reservationID","confResID","findMemberByUUID","uuid","found","translateMember","number","email","addMember","shortPrompt","$watch","activePane","chat_counter","created_at","Date","$apply","chatStatus","resIDs","currentLayout","layoutName","openId","watcher","master","memberIdx","conferenceMemberID","mutedMic","muted","mutedVideo","$applyAsync","closeChat","toggleModMenu","confRole","sendConferenceChat","confKick","confMuteMic","confMuteVideo","confPresenter","setResevartionId","confVideoFloor","confBanner","instant","confCanvasIn","setCanvasIn","confCanvasOut","setCanvasOut","confLayer","setLayer","confResetBanner","confVolumeDown","confVolumeUp","confGainDown","confGainUp","confTransfer","confToggleDeaf","origin","pathname","contributors","re","githash","CallHistory","eventQueue","extension","onHold","cur_call","dialpadNumber","called_number","mirrorInput","videoCall","warning","process","search","autocall","call_history","history_control","all_control","has_history","userStatus","calling","clearCallHistory","viewCallsList","calls","call_list","fillDialpadNumber","preview","loading","cancelled","testSpeedJoin","testSpeed","cancel","$modal","buildCanvasesData","canvases","callTemplate","dialpadTemplate","incall","openChat","toggleDialpad","openModal","cbMuteVideo","cbMuteMic","confChangeVideoLayout","videoLayout","$emit","confChangeSpeaker","speakerId","selectedSpeaker","confPopup","href","curCall","webcam","offsetWidth","offsetHeight","y","popup","moveTo","screenshare","shareCall","screenshareHangup","pluginUrl","allowHtml","$broadcast","preRoute","$q","$window","ws_modalInstance","backdrop","keyboard","showReconnectModal","autoBand","gapiClientLoaded","gapi","client","plus","people","userId","execute","handleEmailResponse","resp","primaryEmail","emails","displayName","image","sinkIdCallback","deviceName","onKeydownDtmfHistory","caracter","onKeydownDtmfEnabled","dtmfWidget","dtmfHistory","language","use","addClass","dialpad","myVideo","hasClass","redirect","connectCallback","hostname","wsURL","ui_connected","ws_connected","disconnectCallback","reset","auth","signOut","openModalSettings","modalInstance","animation","animationsEnabled","rendered","material","_options","showAbout","showContributors","backspace","toggleCallHistory","removeClass","toggleChat","toggleClass","toggleSettings","settingsEl","closeSettings","goFullscreen","fullscreenEnabled","isEnabled","enable","getElementsByTagName","$digest","page_incall","askRecoverCall","events","authResult","load","callActive","call_start","start_time","incomingCall","answerCall","declineCall","selectedVideo","disableOnKeydownDtmf","enableOnKeydownDtmf","originalPath","unbind","vidQual","bwp","bandDown","bandUp","iconClass","videoQuality","vidRes","$modalInstance","dismiss","ModalWsReconnectController","closeReconnect","instance","$inject","speakerFeature","mydata","copy","unshift","translation","selectedVideoName","changeData","useSTUN","changedLanguage","langKey","browserlang","lang","fail_lang","refreshDeviceList","showPreview","speedMsg","resetSettings","factoryReset","checkAutoBand","option","useDedenc","bestres","outgoingBandwidth","incomingBandwidth","checkUseDedRemoteEncoder","checkVideoQuality","resolution","videoResolution","stopMedia","streamObj","mediaStreamSource","createMediaStreamSource","meter","volumes","mirrored","selectedAudio","AudioContext","endPreview","directive","restrict","$element","focus","scope","attrs","fadeIn","parent","fadeOut","condition","videoElem","newParent","getElementsByClassName","resize","updateVideoSize","css","appendTo","regex","regex64","test","videoQualitySource","qqvga","qvga","vga","qvga_wide","vga_wide","hd","hhd","framerate","updateReq","ms","new_w","new_h","aspect","videoContainer","round","vertoService","service","$cookieStore","cleanShareCall","that","callState","cleanCall","confLayouts","chattingWith","last_state","updateResolutions","supportedResolutions","audioDevices","shareDevices","textTo","refreshDevicesCallback","speakerDevices","selectedShare","videoFlag","some","shareFlag","audioFlag","speakerFlag","canVideo","refreshVideoResolution","resolutions","qual","startConference","pvtData","chatID","fromDisplay","canvasInfo","callId","fromJson","stopConference","ourBootstrap","googEchoCancellation","googNoiseSuppression","googHighpassFilter","googAutoGainControl","googAutoGainControl2","reloaded","videoOnly","from_msg_name","mediaPerm","custom","callerid","dedEnc","avatar","stopSharing","StreamTrack","upBand","ceil","downBand","from_msg_number","configure","httpRequest","floor","httpReturn","googlelogin","googleclientid","autologin","autologin_done","fn","fn_return","emitNextProgress","$localStorage","verto_data","defaultSettings","$default","$reset","factory","history","addCallToHistory","getCallsFromHistory","checkBrowser","checkMediaPerm","refreshMediaDevices","checkConnectionSpeed","provisionConfig","configResponse","configPromise","checkLogin","checkUserStored","progress","progress_message","calculateProgress","_progress","nextProgress"],"mappings":"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","sourcesContent":["/*\n * Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n * Copyright (C) 2005-2014, Anthony Minessale II <anthm@freeswitch.org>\n *\n * Version: MPL 1.1\n *\n * The contents of this file are subject to the Mozilla Public License Version\n * 1.1 (the \"License\"); you may not use this file except in compliance with\n * the License. You may obtain a copy of the License at\n * http://www.mozilla.org/MPL/\n *\n * Software distributed under the License is distributed on an \"AS IS\" basis,\n * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n * for the specific language governing rights and limitations under the\n * License.\n *\n * The Original Code is jquery.jsonrpclient.js modified for Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n *\n * The Initial Developer of the Original Code is\n * Textalk AB http://textalk.se/\n * Portions created by the Initial Developer are Copyright (C)\n * the Initial Developer. All Rights Reserved.\n *\n * Contributor(s):\n *\n * Anthony Minessale II <anthm@freeswitch.org>\n *\n * jquery.jsonrpclient.js - JSON RPC client code\n *\n */\n/**\n * This plugin requires jquery.json.js to be available, or at least the methods $.toJSON and\n * $.parseJSON.\n *\n * The plan is to make use of websockets if they are available, but work just as well with only\n * http if not.\n *\n * Usage example:\n *\n *   var foo = new $.JsonRpcClient({ ajaxUrl: '/backend/jsonrpc' });\n *   foo.call(\n *     'bar', [ 'A parameter', 'B parameter' ],\n *     function(result) { alert('Foo bar answered: ' + result.my_answer); },\n *     function(error)  { console.log('There was an error', error); }\n *   );\n *\n * More examples are available in README.md\n */\n(function($) {\n  /**\n   * @fn new\n   * @memberof $.JsonRpcClient\n   *\n   * @param options An object stating the backends:\n   *                ajaxUrl    A url (relative or absolute) to a http(s) backend.\n   *                socketUrl  A url (relative of absolute) to a ws(s) backend.\n   *                onmessage  A socket message handler for other messages (non-responses).\n   *                getSocket  A function returning a WebSocket or null.\n   *                           It must take an onmessage_cb and bind it to the onmessage event\n   *                           (or chain it before/after some other onmessage handler).\n   *                           Or, it could return null if no socket is available.\n   *                           The returned instance must have readyState <= 1, and if less than 1,\n   *                           react to onopen binding.\n   */\n    $.JsonRpcClient = function(options) {\n        var self = this;\n        this.options = $.extend({\n            ajaxUrl       : null,\n            socketUrl     : null, ///< The ws-url for default getSocket.\n            onmessage     : null, ///< Other onmessage-handler.\n            login         : null, /// auth login\n            passwd        : null, /// auth passwd\n            sessid        : null,\n\t    loginParams   : null,\n\t    userVariables : null,\n            getSocket     : function(onmessage_cb) { return self._getSocket(onmessage_cb); }\n        }, options);\n\n        self.ws_cnt = 0;\n\n        // Declare an instance version of the onmessage callback to wrap 'this'.\n        this.wsOnMessage = function(event) { self._wsOnMessage(event); };\n    };\n\n    /// Holding the WebSocket on default getsocket.\n    $.JsonRpcClient.prototype._ws_socket = null;\n\n    /// Object <id>: { success_cb: cb, error_cb: cb }\n    $.JsonRpcClient.prototype._ws_callbacks = {};\n\n    /// The next JSON-RPC request id.\n    $.JsonRpcClient.prototype._current_id = 1;\n\n\n    $.JsonRpcClient.prototype.speedTest = function (bytes, cb) {\n        var socket = this.options.getSocket(this.wsOnMessage);\n\tif (socket !== null) {\n\t    this.speedCB = cb;\n\t    this.speedBytes = bytes;\n\t    socket.send(\"#SPU \" + bytes);\n\n\t    var loops = bytes / 1024;\n\t    var rem = bytes % 1024;\n\t    var i;\n\t    var data = new Array(1024).join(\".\");\n\t    for (i = 0; i < loops; i++) {\n\t\tsocket.send(\"#SPB \" + data);\n\t    }\n\t    \n\t    if (rem) {\n\t\tsocket.send(\"#SPB \" + data);\n\t    }\n\n\t    socket.send(\"#SPE\");\n\t}\n    };\n\n\n\n    /**\n     * @fn call\n     * @memberof $.JsonRpcClient\n     *\n     * @param method     The method to run on JSON-RPC server.\n     * @param params     The params; an array or object.\n     * @param success_cb A callback for successful request.\n     * @param error_cb   A callback for error.\n     */\n    $.JsonRpcClient.prototype.call = function(method, params, success_cb, error_cb) {\n    // Construct the JSON-RPC 2.0 request.\n\n        if (!params) {\n            params = {};\n        }\n\n        if (this.options.sessid) {\n            params.sessid = this.options.sessid;\n        }\n\n        var request = {\n            jsonrpc : '2.0',\n            method  : method,\n            params  : params,\n            id      : this._current_id++  // Increase the id counter to match request/response\n        };\n\n        if (!success_cb) {\n            success_cb = function(e){console.log(\"Success: \", e);};\n        }\n\n        if (!error_cb) {\n            error_cb = function(e){console.log(\"Error: \", e);};\n        }\n\n        // Try making a WebSocket call.\n        var socket = this.options.getSocket(this.wsOnMessage);\n        if (socket !== null) {\n            this._wsCall(socket, request, success_cb, error_cb);\n            return;\n        }\n\n        // No WebSocket, and no HTTP backend?  This won't work.\n        if (this.options.ajaxUrl === null) {\n            throw \"$.JsonRpcClient.call used with no websocket and no http endpoint.\";\n        }\n\n        $.ajax({\n            type     : 'POST',\n            url      : this.options.ajaxUrl,\n            data     : $.toJSON(request),\n            dataType : 'json',\n            cache    : false,\n\n            success  : function(data) {\n                if ('error' in data) error_cb(data.error, this);\n                success_cb(data.result, this);\n            },\n\n            // JSON-RPC Server could return non-200 on error\n            error    : function(jqXHR, textStatus, errorThrown) {\n                try {\n                    var response = $.parseJSON(jqXHR.responseText);\n\n                    if ('console' in window) console.log(response);\n\n                    error_cb(response.error, this);\n                } catch (err) {\n                    // Perhaps the responseText wasn't really a jsonrpc-error.\n                    error_cb({ error: jqXHR.responseText }, this);\n                }\n            }\n        });\n    };\n\n    /**\n     * Notify sends a command to the server that won't need a response.  In http, there is probably\n     * an empty response - that will be dropped, but in ws there should be no response at all.\n     *\n     * This is very similar to call, but has no id and no handling of callbacks.\n     *\n     * @fn notify\n     * @memberof $.JsonRpcClient\n     *\n     * @param method     The method to run on JSON-RPC server.\n     * @param params     The params; an array or object.\n     */\n    $.JsonRpcClient.prototype.notify = function(method, params) {\n        // Construct the JSON-RPC 2.0 request.\n\n        if (this.options.sessid) {\n            params.sessid = this.options.sessid;\n        }\n\n        var request = {\n            jsonrpc: '2.0',\n            method:  method,\n            params:  params\n        };\n\n        // Try making a WebSocket call.\n        var socket = this.options.getSocket(this.wsOnMessage);\n        if (socket !== null) {\n            this._wsCall(socket, request);\n            return;\n        }\n\n        // No WebSocket, and no HTTP backend?  This won't work.\n        if (this.options.ajaxUrl === null) {\n            throw \"$.JsonRpcClient.notify used with no websocket and no http endpoint.\";\n        }\n\n        $.ajax({\n            type     : 'POST',\n            url      : this.options.ajaxUrl,\n            data     : $.toJSON(request),\n            dataType : 'json',\n            cache    : false\n        });\n    };\n\n    /**\n     * Make a batch-call by using a callback.\n     *\n     * The callback will get an object \"batch\" as only argument.  On batch, you can call the methods\n     * \"call\" and \"notify\" just as if it was a normal $.JsonRpcClient object, and all calls will be\n     * sent as a batch call then the callback is done.\n     *\n     * @fn batch\n     * @memberof $.JsonRpcClient\n     *\n     * @param callback    The main function which will get a batch handler to run call and notify on.\n     * @param all_done_cb A callback function to call after all results have been handled.\n     * @param error_cb    A callback function to call if there is an error from the server.\n     *                    Note, that batch calls should always get an overall success, and the\n     *                    only error\n     */\n    $.JsonRpcClient.prototype.batch = function(callback, all_done_cb, error_cb) {\n        var batch = new $.JsonRpcClient._batchObject(this, all_done_cb, error_cb);\n        callback(batch);\n        batch._execute();\n    };\n\n    /**\n     * The default getSocket handler.\n     *\n     * @param onmessage_cb The callback to be bound to onmessage events on the socket.\n     *\n     * @fn _getSocket\n     * @memberof $.JsonRpcClient\n     */\n\n    $.JsonRpcClient.prototype.socketReady = function() {\n        if (this._ws_socket === null || this._ws_socket.readyState > 1) {\n            return false;\n        }\n\n        return true;\n    };\n\n    $.JsonRpcClient.prototype.closeSocket = function() {\n\tvar self = this;\n        if (self.socketReady()) {\n            self._ws_socket.onclose = function (w) {console.log(\"Closing Socket\");};\n            self._ws_socket.close();\n        }\n    };\n\n    $.JsonRpcClient.prototype.loginData = function(params) {\n\tvar self = this;\n        self.options.login = params.login;\n        self.options.passwd = params.passwd;\n\tself.options.loginParams = params.loginParams;\n\tself.options.userVariables = params.userVariables;\n    };\n\n    $.JsonRpcClient.prototype.connectSocket = function(onmessage_cb) {\n        var self = this;\n\n        if (self.to) {\n            clearTimeout(self.to);\n        }\n\n        if (!self.socketReady()) {\n            self.authing = false;\n\n            if (self._ws_socket) {\n                delete self._ws_socket;\n            }\n\n            // No socket, or dying socket, let's get a new one.\n            self._ws_socket = new WebSocket(self.options.socketUrl);\n\n            if (self._ws_socket) {\n                // Set up onmessage handler.\n                self._ws_socket.onmessage = onmessage_cb;\n                self._ws_socket.onclose = function (w) {\n                    if (!self.ws_sleep) {\n                        self.ws_sleep = 1000;\n                    }\n\n                    if (self.options.onWSClose) {\n                        self.options.onWSClose(self);\n                    }\n\n                    console.error(\"Websocket Lost \" + self.ws_cnt + \" sleep: \" + self.ws_sleep + \"msec\");\n\n                    self.to = setTimeout(function() {\n                        console.log(\"Attempting Reconnection....\");\n                        self.connectSocket(onmessage_cb);\n                    }, self.ws_sleep);\n\n                    self.ws_cnt++;\n\n                    if (self.ws_sleep < 3000 && (self.ws_cnt % 10) === 0) {\n                        self.ws_sleep += 1000;\n                    }\n                };\n\n                // Set up sending of message for when the socket is open.\n                self._ws_socket.onopen = function() {\n                    if (self.to) {\n                        clearTimeout(self.to);\n                    }\n                    self.ws_sleep = 1000;\n                    self.ws_cnt = 0;\n                    if (self.options.onWSConnect) {\n                        self.options.onWSConnect(self);\n                    }\n\n                    var req;\n                    // Send the requests.\n                    while ((req = $.JsonRpcClient.q.pop())) {\n                        self._ws_socket.send(req);\n                    }\n                };\n            }\n        }\n\n        return self._ws_socket ? true : false;\n    };\n\n    $.JsonRpcClient.prototype.stopRetrying = function() {\n      if (self.to)\n        clearTimeout(self.to);\n    }\n\n    $.JsonRpcClient.prototype._getSocket = function(onmessage_cb) {\n        // If there is no ws url set, we don't have a socket.\n        // Likewise, if there is no window.WebSocket.\n        if (this.options.socketUrl === null || !(\"WebSocket\" in window)) return null;\n\n        this.connectSocket(onmessage_cb);\n\n        return this._ws_socket;\n    };\n\n    /**\n     * Queue to save messages delivered when websocket is not ready\n     */\n    $.JsonRpcClient.q = [];\n\n    /**\n     * Internal handler to dispatch a JRON-RPC request through a websocket.\n     *\n     * @fn _wsCall\n     * @memberof $.JsonRpcClient\n     */\n    $.JsonRpcClient.prototype._wsCall = function(socket, request, success_cb, error_cb) {\n        var request_json = $.toJSON(request);\n\n        if (socket.readyState < 1) {\n            // The websocket is not open yet; we have to set sending of the message in onopen.\n            self = this; // In closure below, this is set to the WebSocket.  Use self instead.\n            $.JsonRpcClient.q.push(request_json);\n        } else {\n            // We have a socket and it should be ready to send on.\n            socket.send(request_json);\n        }\n\n        // Setup callbacks.  If there is an id, this is a call and not a notify.\n        if ('id' in request && typeof success_cb !== 'undefined') {\n            this._ws_callbacks[request.id] = { request: request_json, request_obj: request, success_cb: success_cb, error_cb: error_cb };\n        }\n    };\n\n    /**\n     * Internal handler for the websocket messages.  It determines if the message is a JSON-RPC\n     * response, and if so, tries to couple it with a given callback.  Otherwise, it falls back to\n     * given external onmessage-handler, if any.\n     *\n     * @param event The websocket onmessage-event.\n     */\n    $.JsonRpcClient.prototype._wsOnMessage = function(event) {\n        // Check if this could be a JSON RPC message.\n        var response;\n\n\t// Special sub proto\n\tif (event.data[0] == \"#\" && event.data[1] == \"S\" && event.data[2] == \"P\") {\n\t    if (event.data[3] == \"U\") {\n\t\tthis.up_dur = parseInt(event.data.substring(4));\n\t    } else if (this.speedCB && event.data[3] == \"D\") {\n\t\tthis.down_dur = parseInt(event.data.substring(4));\n\n\t\tvar up_kps = (((this.speedBytes * 8) / (this.up_dur / 1000)) / 1024).toFixed(0);\n\t\tvar down_kps = (((this.speedBytes * 8) / (this.down_dur / 1000)) / 1024).toFixed(0);\n\t\t\n\t\tconsole.info(\"Speed Test: Up: \" + up_kps + \" Down: \" + down_kps);\n\t\tthis.speedCB(event, { upDur: this.up_dur, downDur: this.down_dur, upKPS: up_kps, downKPS: down_kps });\n\t\tthis.speedCB = null;\n\t    }\n\t    \n\t    return;\n\t}\n\n\n        try {\n            response = $.parseJSON(event.data);\n\n            /// @todo Make using the jsonrcp 2.0 check optional, to use this on JSON-RPC 1 backends.\n\n            if (typeof response === 'object' &&\n                'jsonrpc' in response &&\n                response.jsonrpc === '2.0') {\n\n                /// @todo Handle bad response (without id).\n\n                // If this is an object with result, it is a response.\n                if ('result' in response && this._ws_callbacks[response.id]) {\n                    // Get the success callback.\n                    var success_cb = this._ws_callbacks[response.id].success_cb;\n\n    /*\n                    // set the sessid if present\n                    if ('sessid' in response.result && !this.options.sessid || (this.options.sessid != response.result.sessid)) {\n                        this.options.sessid = response.result.sessid;\n                        if (this.options.sessid) {\n                            console.log(\"setting session UUID to: \" + this.options.sessid);\n                        }\n                    }\n    */\n                    // Delete the callback from the storage.\n                    delete this._ws_callbacks[response.id];\n\n                    // Run callback with result as parameter.\n                    success_cb(response.result, this);\n                    return;\n                } else if ('error' in response && this._ws_callbacks[response.id]) {\n                // If this is an object with error, it is an error response.\n\n                // Get the error callback.\n                    var error_cb = this._ws_callbacks[response.id].error_cb;\n                    var orig_req = this._ws_callbacks[response.id].request;\n\n                    // if this is an auth request, send the credentials and resend the failed request\n                    if (!self.authing && response.error.code == -32000 && self.options.login && self.options.passwd) {\n                        self.authing = true;\n\n                        this.call(\"login\", { login: self.options.login, passwd: self.options.passwd, loginParams: self.options.loginParams,\n\t\t\t\t\t     userVariables: self.options.userVariables},\n                            this._ws_callbacks[response.id].request_obj.method == \"login\" ?\n                            function(e) {\n                                self.authing = false;\n                                console.log(\"logged in\");\n                                delete self._ws_callbacks[response.id];\n\n                                if (self.options.onWSLogin) {\n                                    self.options.onWSLogin(true, self);\n                                }\n                            }\n\n                            :\n\n                            function(e) {\n                                self.authing = false;\n                                console.log(\"logged in, resending request id: \" + response.id);\n                                var socket = self.options.getSocket(self.wsOnMessage);\n                                if (socket !== null) {\n                                    socket.send(orig_req);\n                                }\n                                if (self.options.onWSLogin) {\n                                    self.options.onWSLogin(true, self);\n                                }\n                            },\n\n                            function(e) {\n                                console.log(\"error logging in, request id:\", response.id);\n                                delete self._ws_callbacks[response.id];\n                                error_cb(response.error, this);\n                                if (self.options.onWSLogin) {\n                                self.options.onWSLogin(false, self);\n                                }\n                            });\n                            return;\n                        }\n\n                        // Delete the callback from the storage.\n                        delete this._ws_callbacks[response.id];\n\n                        // Run callback with the error object as parameter.\n                        error_cb(response.error, this);\n                        return;\n                    }\n                }\n            } catch (err) {\n            // Probably an error while parsing a non json-string as json.  All real JSON-RPC cases are\n            // handled above, and the fallback method is called below.\n            console.log(\"ERROR: \"+ err);\n            return;\n        }\n\n        // This is not a JSON-RPC response.  Call the fallback message handler, if given.\n        if (typeof this.options.onmessage === 'function') {\n            event.eventData = response;\n            if (!event.eventData) {\n                event.eventData = {};\n            }\n\n            var reply = this.options.onmessage(event);\n\n            if (reply && typeof reply === \"object\" && event.eventData.id) {\n                var msg = {\n                    jsonrpc: \"2.0\",\n                    id: event.eventData.id,\n                    result: reply\n                };\n\n                var socket = self.options.getSocket(self.wsOnMessage);\n                if (socket !== null) {\n                    socket.send($.toJSON(msg));\n                }\n            }\n        }\n    };\n\n\n    /************************************************************************************************\n     * Batch object with methods\n     ************************************************************************************************/\n\n    /**\n     * Handling object for batch calls.\n     */\n    $.JsonRpcClient._batchObject = function(jsonrpcclient, all_done_cb, error_cb) {\n        // Array of objects to hold the call and notify requests.  Each objects will have the request\n        // object, and unless it is a notify, success_cb and error_cb.\n        this._requests   = [];\n\n        this.jsonrpcclient = jsonrpcclient;\n        this.all_done_cb = all_done_cb;\n        this.error_cb    = typeof error_cb === 'function' ? error_cb : function() {};\n\n    };\n\n    /**\n     * @sa $.JsonRpcClient.prototype.call\n     */\n    $.JsonRpcClient._batchObject.prototype.call = function(method, params, success_cb, error_cb) {\n\n        if (!params) {\n            params = {};\n        }\n\n        if (this.options.sessid) {\n            params.sessid = this.options.sessid;\n        }\n\n        if (!success_cb) {\n            success_cb = function(e){console.log(\"Success: \", e);};\n        }\n\n        if (!error_cb) {\n        error_cb = function(e){console.log(\"Error: \", e);};\n        }\n\n        this._requests.push({\n            request    : {\n            jsonrpc : '2.0',\n            method  : method,\n            params  : params,\n            id      : this.jsonrpcclient._current_id++  // Use the client's id series.\n        },\n            success_cb : success_cb,\n            error_cb   : error_cb\n        });\n    };\n\n    /**\n     * @sa $.JsonRpcClient.prototype.notify\n     */\n    $.JsonRpcClient._batchObject.prototype.notify = function(method, params) {\n        if (this.options.sessid) {\n            params.sessid = this.options.sessid;\n        }\n\n        this._requests.push({\n            request    : {\n                jsonrpc : '2.0',\n                method  : method,\n                params  : params\n            }\n        });\n    };\n\n    /**\n     * Executes the batched up calls.\n     */\n    $.JsonRpcClient._batchObject.prototype._execute = function() {\n        var self = this;\n\n        if (this._requests.length === 0) return; // All done :P\n\n        // Collect all request data and sort handlers by request id.\n        var batch_request = [];\n        var handlers = {};\n        var i = 0;\n        var call;\n        var success_cb;\n        var error_cb;\n\n        // If we have a WebSocket, just send the requests individually like normal calls.\n        var socket = self.jsonrpcclient.options.getSocket(self.jsonrpcclient.wsOnMessage);\n        if (socket !== null) {\n            for (i = 0; i < this._requests.length; i++) {\n                call = this._requests[i];\n                success_cb = ('success_cb' in call) ? call.success_cb : undefined;\n                error_cb   = ('error_cb'   in call) ? call.error_cb   : undefined;\n                self.jsonrpcclient._wsCall(socket, call.request, success_cb, error_cb);\n            }\n\n            if (typeof all_done_cb === 'function') all_done_cb(result);\n            return;\n        }\n\n        for (i = 0; i < this._requests.length; i++) {\n            call = this._requests[i];\n            batch_request.push(call.request);\n\n            // If the request has an id, it should handle returns (otherwise it's a notify).\n            if ('id' in call.request) {\n                handlers[call.request.id] = {\n                    success_cb : call.success_cb,\n                    error_cb   : call.error_cb\n                };\n            }\n        }\n\n        success_cb = function(data) { self._batchCb(data, handlers, self.all_done_cb); };\n\n        // No WebSocket, and no HTTP backend?  This won't work.\n        if (self.jsonrpcclient.options.ajaxUrl === null) {\n            throw \"$.JsonRpcClient.batch used with no websocket and no http endpoint.\";\n        }\n\n        // Send request\n        $.ajax({\n            url      : self.jsonrpcclient.options.ajaxUrl,\n            data     : $.toJSON(batch_request),\n            dataType : 'json',\n            cache    : false,\n            type     : 'POST',\n\n            // Batch-requests should always return 200\n            error    : function(jqXHR, textStatus, errorThrown) {\n                self.error_cb(jqXHR, textStatus, errorThrown);\n            },\n            success  : success_cb\n        });\n    };\n\n    /**\n     * Internal helper to match the result array from a batch call to their respective callbacks.\n     *\n     * @fn _batchCb\n     * @memberof $.JsonRpcClient\n     */\n    $.JsonRpcClient._batchObject.prototype._batchCb = function(result, handlers, all_done_cb) {\n        for (var i = 0; i < result.length; i++) {\n            var response = result[i];\n\n            // Handle error\n            if ('error' in response) {\n                if (response.id === null || !(response.id in handlers)) {\n                    // An error on a notify?  Just log it to the console.\n                    if ('console' in window) console.log(response);\n                } else {\n                    handlers[response.id].error_cb(response.error, this);\n                }\n            } else {\n                // Here we should always have a correct id and no error.\n                if (!(response.id in handlers) && 'console' in window) {\n                    console.log(response);\n                } else {\n                    handlers[response.id].success_cb(response.result, this);\n                }\n            }\n        }\n\n        if (typeof all_done_cb === 'function') all_done_cb(result);\n    };\n\n})(jQuery);\n\n/*\n * Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n * Copyright (C) 2005-2014, Anthony Minessale II <anthm@freeswitch.org>\n *\n * Version: MPL 1.1\n *\n * The contents of this file are subject to the Mozilla Public License Version\n * 1.1 (the \"License\"); you may not use this file except in compliance with\n * the License. You may obtain a copy of the License at\n * http://www.mozilla.org/MPL/\n *\n * Software distributed under the License is distributed on an \"AS IS\" basis,\n * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n * for the specific language governing rights and limitations under the\n * License.\n *\n * The Original Code is Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n *\n * The Initial Developer of the Original Code is\n * Anthony Minessale II <anthm@freeswitch.org>\n * Portions created by the Initial Developer are Copyright (C)\n * the Initial Developer. All Rights Reserved.\n *\n * Contributor(s):\n *\n * Anthony Minessale II <anthm@freeswitch.org>\n *\n * jquery.FSRTC.js - WebRTC Glue code\n *\n */\n\n(function($) {\n\n    // Find the line in sdpLines that starts with |prefix|, and, if specified,\n    // contains |substr| (case-insensitive search).\n    function findLine(sdpLines, prefix, substr) {\n        return findLineInRange(sdpLines, 0, -1, prefix, substr);\n    }\n\n    // Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\n    // and, if specified, contains |substr| (case-insensitive search).\n    function findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\n        var realEndLine = (endLine != -1) ? endLine : sdpLines.length;\n        for (var i = startLine; i < realEndLine; ++i) {\n            if (sdpLines[i].indexOf(prefix) === 0) {\n                if (!substr || sdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1) {\n                    return i;\n                }\n            }\n        }\n        return null;\n    }\n\n    // Gets the codec payload type from an a=rtpmap:X line.\n    function getCodecPayloadType(sdpLine) {\n        var pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\n        var result = sdpLine.match(pattern);\n        return (result && result.length == 2) ? result[1] : null;\n    }\n    \n    // Returns a new m= line with the specified codec as the first one.\n    function setDefaultCodec(mLine, payload) {\n        var elements = mLine.split(' ');\n        var newLine = [];\n        var index = 0;\n        for (var i = 0; i < elements.length; i++) {\n            if (index === 3) { // Format of media starts from the fourth.\n                newLine[index++] = payload; // Put target payload to the first.\n            }\n            if (elements[i] !== payload) newLine[index++] = elements[i];\n        }\n        return newLine.join(' ');\n    }\n\n    $.FSRTC = function(options) {\n        this.options = $.extend({\n            useVideo: null,\n            useStereo: false,\n            userData: null,\n\t    localVideo: null,\n\t    screenShare: false,\n\t    useCamera: \"any\",\n            iceServers: false,\n            videoParams: {},\n            audioParams: {},\n            callbacks: {\n                onICEComplete: function() {},\n                onICE: function() {},\n                onOfferSDP: function() {}\n            },\n        }, options);\n\n\tthis.audioEnabled = true;\n\tthis.videoEnabled = true;\n\n\n        this.mediaData = {\n            SDP: null,\n            profile: {},\n            candidateList: []\n        };\n\n\tthis.constraints = {\n\t    offerToReceiveAudio: this.options.useSpeak === \"none\" ? false : true,\n\t    offerToReceiveVideo: this.options.useVideo ? true : false,\n\t};\n\n        if (self.options.useVideo) {\n            self.options.useVideo.style.display = 'none';\n        }\n\n        setCompat();\n        checkCompat();\n    };\n\n    $.FSRTC.validRes = [];\n\n    $.FSRTC.prototype.useVideo = function(obj, local) {\n        var self = this;\n\n        if (obj) {\n            self.options.useVideo = obj;\n\t    self.options.localVideo = local;\n\t    self.constraints.offerToReceiveVideo = true;\n        } else {\n            self.options.useVideo = null;\n\t    self.options.localVideo = null;\n\t    self.constraints.offerToReceiveVideo = false;\n        }\n\n        if (self.options.useVideo) {\n            self.options.useVideo.style.display = 'none';\n        }\n    };\n\n    $.FSRTC.prototype.useStereo = function(on) {\n        var self = this;\n        self.options.useStereo = on;\n    };\n\n    // Sets Opus in stereo if stereo is enabled, by adding the stereo=1 fmtp param.\n    $.FSRTC.prototype.stereoHack = function(sdp) {\n        var self = this;\n\n        if (!self.options.useStereo) {\n            return sdp;\n        }\n\n        var sdpLines = sdp.split('\\r\\n');\n\n        // Find opus payload.\n        var opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000'), opusPayload;\n\n        if (!opusIndex) {\n\t    return sdp;\n\t} else {\n            opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\n        }\n\n        // Find the payload in fmtp line.\n        var fmtpLineIndex = findLine(sdpLines, 'a=fmtp:' + opusPayload.toString());\n\n        if (fmtpLineIndex === null) {\n\t    // create an fmtp line\n\t    sdpLines[opusIndex] = sdpLines[opusIndex] + '\\r\\na=fmtp:' + opusPayload.toString() + \" stereo=1; sprop-stereo=1\"\n\t} else {\n            // Append stereo=1 to fmtp line.\n            sdpLines[fmtpLineIndex] = sdpLines[fmtpLineIndex].concat('; stereo=1; sprop-stereo=1');\n\t}\n\n        sdp = sdpLines.join('\\r\\n');\n        return sdp;\n    };\n\n    function setCompat() {\n    }\n\n    function checkCompat() {\n        return true;\n    }\n\n    function onStreamError(self, e) {\n        console.log('There has been a problem retrieving the streams - did you allow access? Check Device Resolution', e);\n        doCallback(self, \"onError\", e);\n    }\n\n    function onStreamSuccess(self, stream) {\n        console.log(\"Stream Success\");\n        doCallback(self, \"onStream\", stream);\n    }\n\n    function onICE(self, candidate) {\n        self.mediaData.candidate = candidate;\n        self.mediaData.candidateList.push(self.mediaData.candidate);\n\n        doCallback(self, \"onICE\");\n    }\n\n    function doCallback(self, func, arg) {\n        if (func in self.options.callbacks) {\n            self.options.callbacks[func](self, arg);\n        }\n    }\n\n    function onICEComplete(self, candidate) {\n        console.log(\"ICE Complete\");\n        doCallback(self, \"onICEComplete\");\n    }\n\n    function onChannelError(self, e) {\n        console.error(\"Channel Error\", e);\n        doCallback(self, \"onError\", e);\n    }\n\n    function onICESDP(self, sdp) {\n        self.mediaData.SDP = self.stereoHack(sdp.sdp);\n        console.log(\"ICE SDP\");\n        doCallback(self, \"onICESDP\");\n    }\n\n    function onAnswerSDP(self, sdp) {\n        self.answer.SDP = self.stereoHack(sdp.sdp);\n        console.log(\"ICE ANSWER SDP\");\n        doCallback(self, \"onAnswerSDP\", self.answer.SDP);\n    }\n\n    function onMessage(self, msg) {\n        console.log(\"Message\");\n        doCallback(self, \"onICESDP\", msg);\n    }\n\n    FSRTCattachMediaStream = function(element, stream) {\n\tif (element && element.id && attachMediaStream) {\n\t    attachMediaStream(element, stream);\n\t} else {\n            if (typeof element.srcObject !== 'undefined') {\n\t\telement.srcObject = stream;\n\t    } else if (typeof element.src !== 'undefined') {\n\t\telement.src = URL.createObjectURL(stream);\n\t    } else {\n\t\tconsole.error('Error attaching stream to element.');\n\t    }\n\t}\n    }\n\n    \n    function onRemoteStream(self, stream) {\n        if (self.options.useVideo) {\n            self.options.useVideo.style.display = 'block';\n        }\n\n        var element = self.options.useAudio;\n        console.log(\"REMOTE STREAM\", stream, element);\n\n\tFSRTCattachMediaStream(element, stream);\n\t\n        self.options.useAudio.play();\n        self.remoteStream = stream;\n    }\n\n    function onOfferSDP(self, sdp) {\n        self.mediaData.SDP = self.stereoHack(sdp.sdp);\n        console.log(\"Offer SDP\");\n        doCallback(self, \"onOfferSDP\");\n    }\n\n    $.FSRTC.prototype.answer = function(sdp, onSuccess, onError) {\n        this.peer.addAnswerSDP({\n            type: \"answer\",\n            sdp: sdp\n        },\n        onSuccess, onError);\n    };\n\n    $.FSRTC.prototype.stopPeer = function() {\n        if (self.peer) {\n            console.log(\"stopping peer\");\n            self.peer.stop();\n        }\n    }\n\n    $.FSRTC.prototype.stop = function() {\n        var self = this;\n\n        if (self.options.useVideo) {\n            self.options.useVideo.style.display = 'none';\n            self.options.useVideo['src'] = '';\n        }\n\n        if (self.localStream) {\n            if(typeof self.localStream.stop == 'function') {\n                self.localStream.stop();\n            } else {\n\t\tif (self.localStream.active){\n                    var tracks = self.localStream.getTracks();\n                    console.log(tracks);\n\t\t    tracks.forEach(function(track, index){\n\t\t\tconsole.log(track);\n\t\t\ttrack.stop();\n\t\t    })\n                }\n            }\n            self.localStream = null;\n        }\n\n        if (self.options.localVideo) {\n            self.options.localVideo.style.display = 'none';\n            self.options.localVideo['src'] = '';\n        }\n\n\tif (self.options.localVideoStream) {\n            if(typeof self.options.localVideoStream.stop == 'function') {\n\t        self.options.localVideoStream.stop();\n            } else {\n\t\tif (self.options.localVideoStream.active){\n                    var tracks = self.options.localVideoStream.getTracks();\n                    console.log(tracks);\n\t\t    tracks.forEach(function(track, index){\n\t\t\tconsole.log(track);\n\t\t\ttrack.stop();\n\t\t    })\n                }\n            }\n        }\n\n        if (self.peer) {\n            console.log(\"stopping peer\");\n            self.peer.stop();\n        }\n    };\n\n    $.FSRTC.prototype.getMute = function() {\n\tvar self = this;\n\treturn self.audioEnabled;\n    }\n\n    $.FSRTC.prototype.setMute = function(what) {\n\tvar self = this;\n\tvar audioTracks = self.localStream.getAudioTracks();\t\n\n\tfor (var i = 0, len = audioTracks.length; i < len; i++ ) {\n\t    switch(what) {\n\t    case \"on\":\n\t\taudioTracks[i].enabled = true;\n\t\tbreak;\n\t    case \"off\":\n\t\taudioTracks[i].enabled = false;\n\t\tbreak;\n\t    case \"toggle\":\n\t\taudioTracks[i].enabled = !audioTracks[i].enabled;\n\t    default:\n\t\tbreak;\n\t    }\n\n\t    self.audioEnabled = audioTracks[i].enabled;\n\t}\n\n\treturn !self.audioEnabled;\n    }\n\n    $.FSRTC.prototype.getVideoMute = function() {\n\tvar self = this;\n\treturn self.videoEnabled;\n    }\n\n    $.FSRTC.prototype.setVideoMute = function(what) {\n\tvar self = this;\n\tvar videoTracks = self.localStream.getVideoTracks();\t\n\n\tfor (var i = 0, len = videoTracks.length; i < len; i++ ) {\n\t    switch(what) {\n\t    case \"on\":\n\t\tvideoTracks[i].enabled = true;\n\t\tbreak;\n\t    case \"off\":\n\t\tvideoTracks[i].enabled = false;\n\t\tbreak;\n\t    case \"toggle\":\n\t\tvideoTracks[i].enabled = !videoTracks[i].enabled;\n\t    default:\n\t\tbreak;\n\t    }\n\n\t    self.videoEnabled = videoTracks[i].enabled;\n\t}\n\n\treturn !self.videoEnabled;\n    }\n\n    $.FSRTC.prototype.createAnswer = function(params) {\n        var self = this;\n        self.type = \"answer\";\n        self.remoteSDP = params.sdp;\n        console.debug(\"inbound sdp: \", params.sdp);\n\n        function onSuccess(stream) {\n            self.localStream = stream;\n\n            self.peer = FSRTCPeerConnection({\n                type: self.type,\n                attachStream: self.localStream,\n                onICE: function(candidate) {\n                    return onICE(self, candidate);\n                },\n                onICEComplete: function() {\n                    return onICEComplete(self);\n                },\n                onRemoteStream: function(stream) {\n                    return onRemoteStream(self, stream);\n                },\n                onICESDP: function(sdp) {\n                    return onICESDP(self, sdp);\n                },\n                onChannelError: function(e) {\n                    return onChannelError(self, e);\n                },\n                constraints: self.constraints,\n                iceServers: self.options.iceServers,\n                offerSDP: {\n                    type: \"offer\",\n                    sdp: self.remoteSDP\n                }\n            });\n\n            onStreamSuccess(self, stream);\n        }\n\n        function onError(e) {\n            onStreamError(self, e);\n        }\n\n\tvar mediaParams = getMediaParams(self);\n\n\tconsole.log(\"Audio constraints\", mediaParams.audio);\n\tconsole.log(\"Video constraints\", mediaParams.video);\n\n\tif (self.options.useVideo && self.options.localVideo) {\n            getUserMedia({\n\t\tconstraints: {\n                    audio: false,\n                    video: {\n\t\t\t//mandatory: self.options.videoParams,\n\t\t\t//optional: []\n                    },\n\t\t},\n\t\tlocalVideo: self.options.localVideo,\n\t\tonsuccess: function(e) {self.options.localVideoStream = e; console.log(\"local video ready\");},\n\t\tonerror: function(e) {console.error(\"local video error!\");}\n            });\n\t}\n\n        getUserMedia({\n            constraints: {\n\t\taudio: mediaParams.audio,\n\t\tvideo: mediaParams.video\n            },\n            video: mediaParams.useVideo,\n            onsuccess: onSuccess,\n            onerror: onError\n        });\n\n\n\n    };\n\n    function getMediaParams(obj) {\n\n\tvar audio;\n\n\tif (obj.options.useMic && obj.options.useMic === \"none\") {\n\t    console.log(\"Microphone Disabled\");\n\t    audio = false;\n\t} else if (obj.options.videoParams && obj.options.screenShare) {//obj.options.videoParams.chromeMediaSource == 'desktop') {\n\t    console.error(\"SCREEN SHARE\", obj.options.videoParams);\n\t    audio = false;\n\t} else {\n\t    audio = {\n\t\t//mandatory: {},\n\t\t//optional: []\n            advanced: []\n\t    };\n\n\t    if (obj.options.useMic !== \"any\") {\n\t\t//audio.optional = [{sourceId: obj.options.useMic}]\n\t\taudio.deviceId = {exact: obj.options.useMic};\n\t    }\n\n\t    //FIXME\n\t    if (obj.options.audioParams) {\n\t\tfor (var key in obj.options.audioParams) {\n\t\t    var con = {};\n\t\t    //con[key] = obj.options.audioParams[key];\n\t\t    if (obj.options.audioParams[key]) {\n\t\t\tcon.exact = key;\n\t\t\taudio.advanced.push(con);\n\t\t    }\n\t\t}\n\t    }\n\n\n\t}\n\n\tif (obj.options.useVideo && obj.options.localVideo) {\n            getUserMedia({\n\t\tconstraints: {\n                    audio: false,\n                    video: obj.options.videoParams\n                    \n\t\t},\n\t\tlocalVideo: obj.options.localVideo,\n\t\tonsuccess: function(e) {self.options.localVideoStream = e; console.log(\"local video ready\");},\n\t\tonerror: function(e) {console.error(\"local video error!\");}\n            });\n\t}\n\n\tvar video = {};\n\tvar bestFrameRate = obj.options.videoParams.vertoBestFrameRate;\n\tvar minFrameRate = obj.options.videoParams.minFrameRate || 15;\n\tdelete obj.options.videoParams.vertoBestFrameRate;\n\n\tif (obj.options.screenShare) {\n\t    // fix for chrome to work for now, will need to change once we figure out how to do this in a non-mandatory style constraint.\n\t    var opt = [];\n\t    opt.push({sourceId: obj.options.useCamera});\n\n\t    if (bestFrameRate) {\n\t\topt.push({minFrameRate: bestFrameRate});\n\t\topt.push({maxFrameRate: bestFrameRate});\n\t    }\n\n\t    video = {\n\t\tmandatory: obj.options.videoParams,\n\t\toptional: opt\t\t\n\t    };\n\t} else {\n\n\t    video = {\n\t\t//mandatory: obj.options.videoParams,\n\t\twidth: {min: obj.options.videoParams.minWidth, max: obj.options.videoParams.maxWidth},\n\t\theight: {min: obj.options.videoParams.minHeight, max: obj.options.videoParams.maxHeight}\n\t    };\n\t    \n            \n\t    \n\t    var useVideo = obj.options.useVideo;\n\n\t    if (useVideo && obj.options.useCamera && obj.options.useCamera !== \"none\") {\n\t\t//if (!video.optional) {\n\t\t//video.optional = [];\n\t\t//}\n\n\t\t\n\t\tif (obj.options.useCamera !== \"any\") {\n\t\t    //video.optional.push({sourceId: obj.options.useCamera});\n\t\t    video.deviceId = obj.options.useCamera;\n\t\t}\n\n\t\tif (bestFrameRate) {\n\t\t    //video.optional.push({minFrameRate: bestFrameRate});\n\t\t    //video.optional.push({maxFrameRate: bestFrameRate});\n\t\t    video.frameRate = {ideal: bestFrameRate, min: minFrameRate, max: 30};\n\t\t}\n\n\t    } else {\n\t\tconsole.log(\"Camera Disabled\");\n\t\tvideo = false;\n\t\tuseVideo = false;\n\t    }\n\t}\n\n\treturn {audio: audio, video: video, useVideo: useVideo};\n    }\n    \n    $.FSRTC.prototype.call = function(profile) {\n        checkCompat();\n\t\n        var self = this;\n\tvar screen = false;\n\n        self.type = \"offer\";\n\n\tif (self.options.videoParams && self.options.screenShare) { //self.options.videoParams.chromeMediaSource == 'desktop') {\n\t    screen = true;\n\t}\n\n        function onSuccess(stream) {\n\t    self.localStream = stream;\n\t    \n\t    if (screen) {\n\t\tself.constraints.offerToReceiveVideo = false;\n\t    }\n\t    \n            self.peer = FSRTCPeerConnection({\n                type: self.type,\n                attachStream: self.localStream,\n                onICE: function(candidate) {\n                    return onICE(self, candidate);\n                },\n                onICEComplete: function() {\n                    return onICEComplete(self);\n                },\n                onRemoteStream: screen ? function(stream) {} : function(stream) {\n                    return onRemoteStream(self, stream);\n                },\n                onOfferSDP: function(sdp) {\n                    return onOfferSDP(self, sdp);\n                },\n                onICESDP: function(sdp) {\n                    return onICESDP(self, sdp);\n                },\n                onChannelError: function(e) {\n                    return onChannelError(self, e);\n                },\n                constraints: self.constraints,\n                iceServers: self.options.iceServers,\n            });\n\n            onStreamSuccess(self, stream);\n        }\n\n        function onError(e) {\n            onStreamError(self, e);\n        }\n\n\tvar mediaParams = getMediaParams(self);\n\n\tconsole.log(\"Audio constraints\", mediaParams.audio);\n\tconsole.log(\"Video constraints\", mediaParams.video);\n\n\tif (mediaParams.audio || mediaParams.video) {\n\n            getUserMedia({\n\t\tconstraints: {\n                    audio: mediaParams.audio,\n                video: mediaParams.video\n\t\t},\n\t\tvideo: mediaParams.useVideo,\n\t\tonsuccess: onSuccess,\n\t\tonerror: onError\n            });\n\t} else {\n\t    onSuccess(null);\n\t}\n\n\n\n        /*\n        navigator.getUserMedia({\n            video: self.options.useVideo,\n            audio: true\n        }, onSuccess, onError);\n        */\n\n    };\n\n    // DERIVED from RTCPeerConnection-v1.5\n    // 2013, @muazkh - github.com/muaz-khan\n    // MIT License - https://www.webrtc-experiment.com/licence/\n    // Documentation - https://github.com/muaz-khan/WebRTC-Experiment/tree/master/RTCPeerConnection\n    \n    function FSRTCPeerConnection(options) {\n\tvar gathering = false, done = false;\n\tvar config = {};\n        var default_ice = {\n\t    urls: ['stun:stun.l.google.com:19302']\n\t};\n\n        if (options.iceServers) {\n            if (typeof(options.iceServers) === \"boolean\") {\n\t\tconfig.iceServers = [default_ice];\n            } else {\n\t\tconfig.iceServers = options.iceServers;\n\t    }\n        }\n\n        var peer = new window.RTCPeerConnection(config);\n\n        openOffererChannel();\n        var x = 0;\n\n\tfunction ice_handler() {\n\n\t    done = true;\n\t    gathering = null;\n\n            if (options.onICEComplete) {\n                options.onICEComplete();\n            }\n\t    \n            if (options.type == \"offer\") {\n                options.onICESDP(peer.localDescription);\n            } else {\n                if (!x && options.onICESDP) {\n                    options.onICESDP(peer.localDescription);\n                }\n            }\n        }\n\n        peer.onicecandidate = function(event) {\n\n\t    if (done) {\n\t\treturn;\n\t    }\n\n\t    if (!gathering) {\n\t\tgathering = setTimeout(ice_handler, 1000);\n\t    }\n\t    \n\t    if (event) {\n\t\tif (event.candidate) {\n\t\t    options.onICE(event.candidate);\n\t\t}\n\t    } else {\n\t\tdone = true;\n\n\t\tif (gathering) {\n\t\t    clearTimeout(gathering);\n\t\t    gathering = null;\n\t\t}\n\n\t\tice_handler();\n\t    }\n        };\n\n        // attachStream = MediaStream;\n        if (options.attachStream) peer.addStream(options.attachStream);\n\n        // attachStreams[0] = audio-stream;\n        // attachStreams[1] = video-stream;\n        // attachStreams[2] = screen-capturing-stream;\n        if (options.attachStreams && options.attachStream.length) {\n            var streams = options.attachStreams;\n            for (var i = 0; i < streams.length; i++) {\n                peer.addStream(streams[i]);\n            }\n        }\n\n        peer.onaddstream = function(event) {\n            var remoteMediaStream = event.stream;\n\n            // onRemoteStreamEnded(MediaStream)\n            remoteMediaStream.oninactive = function () {\n                if (options.onRemoteStreamEnded) options.onRemoteStreamEnded(remoteMediaStream);\n            };\n\n            // onRemoteStream(MediaStream)\n            if (options.onRemoteStream) options.onRemoteStream(remoteMediaStream);\n\n            //console.debug('on:add:stream', remoteMediaStream);\n        };\n\n        //var constraints = options.constraints || {\n\t  //  offerToReceiveAudio: true,\n\t    //offerToReceiveVideo: true   \n        //};\n\n        // onOfferSDP(RTCSessionDescription)\n        function createOffer() {\n            if (!options.onOfferSDP) return;\n\n            peer.createOffer(function(sessionDescription) {\n                sessionDescription.sdp = serializeSdp(sessionDescription.sdp);\n                peer.setLocalDescription(sessionDescription);\n                options.onOfferSDP(sessionDescription);\n            },\n\t\t\t\tonSdpError, options.constraints);\n        }\n\n        // onAnswerSDP(RTCSessionDescription)\n        function createAnswer() {\n            if (options.type != \"answer\") return;\n\n            //options.offerSDP.sdp = addStereo(options.offerSDP.sdp);\n            peer.setRemoteDescription(new window.RTCSessionDescription(options.offerSDP), onSdpSuccess, onSdpError);\n            peer.createAnswer(function(sessionDescription) {\n                sessionDescription.sdp = serializeSdp(sessionDescription.sdp);\n                peer.setLocalDescription(sessionDescription);\n                if (options.onAnswerSDP) {\n                    options.onAnswerSDP(sessionDescription);\n                }\n            },\n            onSdpError);\n        }\n\n\n        if ((options.onChannelMessage) || !options.onChannelMessage) {\n            createOffer();\n            createAnswer();\n        }\n\n        // DataChannel Bandwidth\n        function setBandwidth(sdp) {\n            // remove existing bandwidth lines\n            sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n            sdp = sdp.replace(/a=mid:data\\r\\n/g, 'a=mid:data\\r\\nb=AS:1638400\\r\\n');\n\n            return sdp;\n        }\n\n        // old: FF<>Chrome interoperability management\n        function getInteropSDP(sdp) {\n            var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split(''),\n            extractedChars = '';\n\n            function getChars() {\n                extractedChars += chars[parseInt(Math.random() * 40)] || '';\n                if (extractedChars.length < 40) getChars();\n\n                return extractedChars;\n            }\n\n            // usually audio-only streaming failure occurs out of audio-specific crypto line\n            // a=crypto:1 AES_CM_128_HMAC_SHA1_32 --------- kAttributeCryptoVoice\n            if (options.onAnswerSDP) sdp = sdp.replace(/(a=crypto:0 AES_CM_128_HMAC_SHA1_32)(.*?)(\\r\\n)/g, '');\n\n            // video-specific crypto line i.e. SHA1_80\n            // a=crypto:1 AES_CM_128_HMAC_SHA1_80 --------- kAttributeCryptoVideo\n            var inline = getChars() + '\\r\\n' + (extractedChars = '');\n            sdp = sdp.indexOf('a=crypto') == -1 ? sdp.replace(/c=IN/g, 'a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:' + inline + 'c=IN') : sdp;\n\n            return sdp;\n        }\n\n        function serializeSdp(sdp) {\n            return sdp;\n        }\n\n        // DataChannel management\n        var channel;\n\n        function openOffererChannel() {\n            if (!options.onChannelMessage) return;\n\n            _openOffererChannel();\n\n            return;\n        }\n\n        function _openOffererChannel() {\n            channel = peer.createDataChannel(options.channel || 'RTCDataChannel', {\n                reliable: false\n            });\n\n            setChannelEvents();\n        }\n\n        function setChannelEvents() {\n            channel.onmessage = function(event) {\n                if (options.onChannelMessage) options.onChannelMessage(event);\n            };\n\n            channel.onopen = function() {\n                if (options.onChannelOpened) options.onChannelOpened(channel);\n            };\n            channel.onclose = function(event) {\n                if (options.onChannelClosed) options.onChannelClosed(event);\n\n                console.warn('WebRTC DataChannel closed', event);\n            };\n            channel.onerror = function(event) {\n                if (options.onChannelError) options.onChannelError(event);\n\n                console.error('WebRTC DataChannel error', event);\n            };\n        }\n\n        function openAnswererChannel() {\n            peer.ondatachannel = function(event) {\n                channel = event.channel;\n                channel.binaryType = 'blob';\n                setChannelEvents();\n            };\n\n            return;\n        }\n\n        // fake:true is also available on chrome under a flag!\n        function useless() {\n            log('Error in fake:true');\n        }\n\n        function onSdpSuccess() {}\n\n        function onSdpError(e) {\n            if (options.onChannelError) {\n                options.onChannelError(e);\n            }\n            console.error('sdp error:', e);\n        }\n\n        return {\n            addAnswerSDP: function(sdp, cbSuccess, cbError) {\n\n                peer.setRemoteDescription(new window.RTCSessionDescription(sdp), cbSuccess ? cbSuccess : onSdpSuccess, cbError ? cbError : onSdpError);\n            },\n            addICE: function(candidate) {\n                peer.addIceCandidate(new window.RTCIceCandidate({\n                    sdpMLineIndex: candidate.sdpMLineIndex,\n                    candidate: candidate.candidate\n                }));\n            },\n\n            peer: peer,\n            channel: channel,\n            sendData: function(message) {\n                if (channel) {\n                    channel.send(message);\n                }\n            },\n\n            stop: function() {\n                peer.close();\n                if (options.attachStream) {\n                  if(typeof options.attachStream.stop == 'function') {\n                    options.attachStream.stop();\n                  } else {\n                    options.attachStream.active = false;\n                  }\n                }\n            }\n\n        };\n    }\n\n    // getUserMedia\n    var video_constraints = {\n        //mandatory: {},\n        //optional: []\n    };\n\n    function getUserMedia(options) {\n        var n = navigator,\n        media;\n        n.getMedia = n.getUserMedia;\n        n.getMedia(options.constraints || {\n            audio: true,\n            video: video_constraints\n        },\n        streaming, options.onerror ||\n        function(e) {\n            console.error(e);\n        });\n\n        function streaming(stream) {\n            if (options.localVideo) {\n                options.localVideo['src'] = window.URL.createObjectURL(stream);\n\t\toptions.localVideo.style.display = 'block';\n            }\n\n            if (options.onsuccess) {\n                options.onsuccess(stream);\n            }\n\n            media = stream;\n        }\n\n        return media;\n    }\n\n    $.FSRTC.resSupported = function(w, h) {\n\tfor (var i in $.FSRTC.validRes) {\n\t    if ($.FSRTC.validRes[i][0] == w && $.FSRTC.validRes[i][1] == h) {\n\t\treturn true;\n\t    }\n\t}\n\n\treturn false;\n    }\n\n    $.FSRTC.bestResSupported = function() {\n\tvar w = 0, h = 0;\n\n\tfor (var i in $.FSRTC.validRes) {\n\t    if ($.FSRTC.validRes[i][0] >= w && $.FSRTC.validRes[i][1] >= h) {\n\t\tw = $.FSRTC.validRes[i][0];\n\t\th = $.FSRTC.validRes[i][1];\n\t    }\n\t}\n\n\treturn [w, h];\n    }\n\n    var resList = [[160, 120], [320, 180], [320, 240], [640, 360], [640, 480], [1280, 720], [1920, 1080]];\n    var resI = 0;\n    var ttl = 0;\n\n    var checkRes = function (cam, func) {\n\n\tif (resI >= resList.length) {\n            var res = {\n               'validRes': $.FSRTC.validRes,\n               'bestResSupported': $.FSRTC.bestResSupported()\n            };\n\t    \n\t    localStorage.setItem(\"res_\" + cam, $.toJSON(res));\n\t    \n\t    if (func) return func(res);\n\t    return;\n\t}\n\n\tvar video = {\n            //mandatory: {},\n            //optional: []\n        }\t\n\t//FIXME\n\tif (cam) {\n\t    //video.optional = [{sourceId: cam}];\n\t    video.deviceId = {exact: cam};\n\t}\n\t\n\tw = resList[resI][0];\n\th = resList[resI][1];\n\tresI++;\n\n\tvideo = {\n\t    width: {exact: w},\n\t    height: {exact: h}\n\t    //\"minWidth\": w,\n\t    //\"minHeight\": h,\n\t    //\"maxWidth\": w,\n\t    //\"maxHeight\": h\n\t};\n\n\tgetUserMedia({\n\t    constraints: {\n                audio: ttl++ == 0,\n                video: video\t    \n\t    },\n\t    onsuccess: function(e) {\n\t\te.getTracks().forEach(function(track) {track.stop();});\n\t\tconsole.info(w + \"x\" + h + \" supported.\"); $.FSRTC.validRes.push([w, h]); checkRes(cam, func);},\n\t    onerror: function(e) {console.warn( w + \"x\" + h + \" not supported.\"); checkRes(cam, func);}\n        });\n    }\n    \n\n    $.FSRTC.getValidRes = function (cam, func) {\n\tvar used = [];\n\tvar cached = localStorage.getItem(\"res_\" + cam);\n\t\n\tif (cached) {\n\t    var cache = $.parseJSON(cached);\n\n\t    if (cache) {\n\t\t$.FSRTC.validRes = cache.validRes;\n\t\tconsole.log(\"CACHED RES FOR CAM \" + cam, cache);\n\t    } else {\n\t\tconsole.error(\"INVALID CACHE\");\n\t    }\n\t    return func ? func(cache) : null;\n\t}\n\n\n\t$.FSRTC.validRes = [];\n\tresI = 0;\n\n\tcheckRes(cam, func);\n    }\n\n    $.FSRTC.checkPerms = function (runtime, check_audio, check_video) {\n\tgetUserMedia({\n\t    constraints: {\n\t\taudio: check_audio,\n\t\tvideo: check_video,\n\t    },\n\t    onsuccess: function(e) {\n\t\te.getTracks().forEach(function(track) {track.stop();});\n\t\t\n\t\tconsole.info(\"media perm init complete\"); \n\t\tif (runtime) {\n                    setTimeout(runtime, 100, true);\n\t\t}\n            },\n\t    onerror: function(e) {\n\t\tif (check_video && check_audio) {\n\t\t    console.error(\"error, retesting with audio params only\");\n\t\t    return $.FSRTC.checkPerms(runtime, check_audio, false);\n\t\t}\n\n\t\tconsole.error(\"media perm init error\");\n\n\t\tif (runtime) {\n\t\t    runtime(false)\n\t\t}\n\t    }\n\t});\n    }\n\n})(jQuery);\n\n\n/*\n * Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n * Copyright (C) 2005-2014, Anthony Minessale II <anthm@freeswitch.org>\n *\n * Version: MPL 1.1\n *\n * The contents of this file are subject to the Mozilla Public License Version\n * 1.1 (the \"License\"); you may not use this file except in compliance with\n * the License. You may obtain a copy of the License at\n * http://www.mozilla.org/MPL/\n *\n * Software distributed under the License is distributed on an \"AS IS\" basis,\n * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n * for the specific language governing rights and limitations under the\n * License.\n *\n * The Original Code is Verto HTML5/Javascript Telephony Signaling and Control Protocol Stack for FreeSWITCH\n *\n * The Initial Developer of the Original Code is\n * Anthony Minessale II <anthm@freeswitch.org>\n * Portions created by the Initial Developer are Copyright (C)\n * the Initial Developer. All Rights Reserved.\n *\n * Contributor(s):\n *\n * Anthony Minessale II <anthm@freeswitch.org>\n *\n * jquery.verto.js - Main interface\n *\n */\n\n(function($) {\n    var sources = [];\n\n    var generateGUID = (typeof(window.crypto) !== 'undefined' && typeof(window.crypto.getRandomValues) !== 'undefined') ?\n    function() {\n        // If we have a cryptographically secure PRNG, use that\n        // http://stackoverflow.com/questions/6906916/collisions-when-generating-uuids-in-javascript\n        var buf = new Uint16Array(8);\n        window.crypto.getRandomValues(buf);\n        var S4 = function(num) {\n            var ret = num.toString(16);\n            while (ret.length < 4) {\n                ret = \"0\" + ret;\n            }\n            return ret;\n        };\n        return (S4(buf[0]) + S4(buf[1]) + \"-\" + S4(buf[2]) + \"-\" + S4(buf[3]) + \"-\" + S4(buf[4]) + \"-\" + S4(buf[5]) + S4(buf[6]) + S4(buf[7]));\n    }\n\n    :\n\n    function() {\n        // Otherwise, just use Math.random\n        // http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#2117523\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            var r = Math.random() * 16 | 0,\n            v = c == 'x' ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    };\n\n    /// MASTER OBJ\n    $.verto = function(options, callbacks) {\n        var verto = this;\n\n        $.verto.saved.push(verto);\n\n        verto.options = $.extend({\n            login: null,\n            passwd: null,\n            socketUrl: null,\n            tag: null,\n\t    localTag: null,\n            videoParams: {},\n            audioParams: {},\n\t    loginParams: {},\n\t    deviceParams: {onResCheck: null},\n\t    userVariables: {},\n            iceServers: false,\n            ringSleep: 6000,\n\t    sessid: null\n        }, options);\n\n\tif (verto.options.deviceParams.useCamera) {\n\t    $.FSRTC.getValidRes(verto.options.deviceParams.useCamera, verto.options.deviceParams.onResCheck);\n\t}\n\n\tif (!verto.options.deviceParams.useMic) {\n\t    verto.options.deviceParams.useMic = \"any\";\n\t}\n\n\tif (!verto.options.deviceParams.useSpeak) {\n\t    verto.options.deviceParams.useSpeak = \"any\";\n\t}\n\n\tif (verto.options.sessid) {\n\t    verto.sessid = verto.options.sessid;\n\t} else {\n            verto.sessid = localStorage.getItem(\"verto_session_uuid\") || generateGUID();\n\t    localStorage.setItem(\"verto_session_uuid\", verto.sessid);\n\t}\n\n        verto.dialogs = {};\n        verto.callbacks = callbacks || {};\n        verto.eventSUBS = {};\n\n        verto.rpcClient = new $.JsonRpcClient({\n            login: verto.options.login,\n            passwd: verto.options.passwd,\n            socketUrl: verto.options.socketUrl,\n\t    loginParams: verto.options.loginParams,\n\t    userVariables: verto.options.userVariables,\n            sessid: verto.sessid,\n            onmessage: function(e) {\n                return verto.handleMessage(e.eventData);\n            },\n            onWSConnect: function(o) {\n                o.call('login', {});\n            },\n            onWSLogin: function(success) {\n                if (verto.callbacks.onWSLogin) {\n                    verto.callbacks.onWSLogin(verto, success);\n                }\n            },\n            onWSClose: function(success) {\n                if (verto.callbacks.onWSClose) {\n                    verto.callbacks.onWSClose(verto, success);\n                }\n                verto.purge();\n            }\n        });\n\n        var tag = verto.options.tag;\n        if (typeof(tag) === \"function\") {\n          tag = tag();\n        }\n\n        if (verto.options.ringFile && verto.options.tag) {\n            verto.ringer = $(\"#\" + tag);\n        }\n\n        verto.rpcClient.call('login', {});\n\n    };\n\n\n    $.verto.prototype.deviceParams = function(obj) {\n        var verto = this;\n\n\tfor (var i in obj) {\n            verto.options.deviceParams[i] = obj[i];\n\t}\n\n\tif (obj.useCamera) {\n\t    $.FSRTC.getValidRes(verto.options.deviceParams.useCamera, obj ? obj.onResCheck : undefined);\n\t}\n    };\n\n    $.verto.prototype.videoParams = function(obj) {\n        var verto = this;\n\n\tfor (var i in obj) {\n            verto.options.videoParams[i] = obj[i];\n\t}\n    };\n\n    $.verto.prototype.iceServers = function(obj) {\n        var verto = this;\n        verto.options.iceServers = obj;\n    };\n\n    $.verto.prototype.loginData = function(params) {\n\tvar verto = this;\n        verto.options.login = params.login;\n        verto.options.passwd = params.passwd;\n        verto.rpcClient.loginData(params);\n    };\n\n    $.verto.prototype.logout = function(msg) {\n        var verto = this;\n        verto.rpcClient.closeSocket();\n        if (verto.callbacks.onWSClose) {\n            verto.callbacks.onWSClose(verto, false);\n        }\n        verto.purge();\n    };\n\n    $.verto.prototype.login = function(msg) {\n        var verto = this;\n        verto.logout();\n        verto.rpcClient.call('login', {});\n    };\n\n    $.verto.prototype.message = function(msg) {\n        var verto = this;\n        var err = 0;\n\n        if (!msg.to) {\n            console.error(\"Missing To\");\n            err++;\n        }\n\n        if (!msg.body) {\n            console.error(\"Missing Body\");\n            err++;\n        }\n\n        if (err) {\n            return false;\n        }\n\n        verto.sendMethod(\"verto.info\", {\n            msg: msg\n        });\n\n        return true;\n    };\n\n    $.verto.prototype.processReply = function(method, success, e) {\n        var verto = this;\n        var i;\n\n        //console.log(\"Response: \" + method, success, e);\n\n        switch (method) {\n        case \"verto.subscribe\":\n            for (i in e.unauthorizedChannels) {\n                drop_bad(verto, e.unauthorizedChannels[i]);\n            }\n            for (i in e.subscribedChannels) {\n                mark_ready(verto, e.subscribedChannels[i]);\n            }\n\n            break;\n        case \"verto.unsubscribe\":\n            //console.error(e);\n            break;\n        }\n    };\n\n    $.verto.prototype.sendMethod = function(method, params) {\n        var verto = this;\n\n        verto.rpcClient.call(method, params,\n\n        function(e) {\n            /* Success */\n            verto.processReply(method, true, e);\n        },\n\n        function(e) {\n            /* Error */\n            verto.processReply(method, false, e);\n        });\n    };\n\n    function do_sub(verto, channel, obj) {\n\n    }\n\n    function drop_bad(verto, channel) {\n        console.error(\"drop unauthorized channel: \" + channel);\n        delete verto.eventSUBS[channel];\n    }\n\n    function mark_ready(verto, channel) {\n        for (var j in verto.eventSUBS[channel]) {\n            verto.eventSUBS[channel][j].ready = true;\n            console.log(\"subscribed to channel: \" + channel);\n            if (verto.eventSUBS[channel][j].readyHandler) {\n                verto.eventSUBS[channel][j].readyHandler(verto, channel);\n            }\n        }\n    }\n\n    var SERNO = 1;\n\n    function do_subscribe(verto, channel, subChannels, sparams) {\n        var params = sparams || {};\n\n        var local = params.local;\n\n        var obj = {\n            eventChannel: channel,\n            userData: params.userData,\n            handler: params.handler,\n            ready: false,\n            readyHandler: params.readyHandler,\n            serno: SERNO++\n        };\n\n        var isnew = false;\n\n        if (!verto.eventSUBS[channel]) {\n            verto.eventSUBS[channel] = [];\n            subChannels.push(channel);\n            isnew = true;\n        }\n\n        verto.eventSUBS[channel].push(obj);\n\n        if (local) {\n            obj.ready = true;\n            obj.local = true;\n        }\n\n        if (!isnew && verto.eventSUBS[channel][0].ready) {\n            obj.ready = true;\n            if (obj.readyHandler) {\n                obj.readyHandler(verto, channel);\n            }\n        }\n\n        return {\n            serno: obj.serno,\n            eventChannel: channel\n        };\n\n    }\n\n    $.verto.prototype.subscribe = function(channel, sparams) {\n        var verto = this;\n        var r = [];\n        var subChannels = [];\n        var params = sparams || {};\n\n        if (typeof(channel) === \"string\") {\n            r.push(do_subscribe(verto, channel, subChannels, params));\n        } else {\n            for (var i in channel) {\n                r.push(do_subscribe(verto, channel, subChannels, params));\n            }\n        }\n\n        if (subChannels.length) {\n            verto.sendMethod(\"verto.subscribe\", {\n                eventChannel: subChannels.length == 1 ? subChannels[0] : subChannels,\n                subParams: params.subParams\n            });\n        }\n\n        return r;\n    };\n\n    $.verto.prototype.unsubscribe = function(handle) {\n        var verto = this;\n        var i;\n\n        if (!handle) {\n            for (i in verto.eventSUBS) {\n                if (verto.eventSUBS[i]) {\n                    verto.unsubscribe(verto.eventSUBS[i]);\n                }\n            }\n        } else {\n            var unsubChannels = {};\n            var sendChannels = [];\n            var channel;\n\n            if (typeof(handle) == \"string\") {\n                delete verto.eventSUBS[handle];\n                unsubChannels[handle]++;\n            } else {\n                for (i in handle) {\n                    if (typeof(handle[i]) == \"string\") {\n                        channel = handle[i];\n                        delete verto.eventSUBS[channel];\n                        unsubChannels[channel]++;\n                    } else {\n                        var repl = [];\n                        channel = handle[i].eventChannel;\n\n                        for (var j in verto.eventSUBS[channel]) {\n                            if (verto.eventSUBS[channel][j].serno == handle[i].serno) {} else {\n                                repl.push(verto.eventSUBS[channel][j]);\n                            }\n                        }\n\n                        verto.eventSUBS[channel] = repl;\n\n                        if (verto.eventSUBS[channel].length === 0) {\n                            delete verto.eventSUBS[channel];\n                            unsubChannels[channel]++;\n                        }\n                    }\n                }\n            }\n\n            for (var u in unsubChannels) {\n                console.log(\"Sending Unsubscribe for: \", u);\n                sendChannels.push(u);\n            }\n\n            if (sendChannels.length) {\n                verto.sendMethod(\"verto.unsubscribe\", {\n                    eventChannel: sendChannels.length == 1 ? sendChannels[0] : sendChannels\n                });\n            }\n        }\n    };\n\n    $.verto.prototype.broadcast = function(channel, params) {\n        var verto = this;\n        var msg = {\n            eventChannel: channel,\n            data: {}\n        };\n        for (var i in params) {\n            msg.data[i] = params[i];\n        }\n        verto.sendMethod(\"verto.broadcast\", msg);\n    };\n\n    $.verto.prototype.purge = function(callID) {\n        var verto = this;\n        var x = 0;\n        var i;\n\n        for (i in verto.dialogs) {\n            if (!x) {\n                console.log(\"purging dialogs\");\n            }\n            x++;\n            verto.dialogs[i].setState($.verto.enum.state.purge);\n        }\n\n        for (i in verto.eventSUBS) {\n            if (verto.eventSUBS[i]) {\n                console.log(\"purging subscription: \" + i);\n                delete verto.eventSUBS[i];\n            }\n        }\n    };\n\n    $.verto.prototype.hangup = function(callID) {\n        var verto = this;\n        if (callID) {\n            var dialog = verto.dialogs[callID];\n\n            if (dialog) {\n                dialog.hangup();\n            }\n        } else {\n            for (var i in verto.dialogs) {\n                verto.dialogs[i].hangup();\n            }\n        }\n    };\n\n    $.verto.prototype.newCall = function(args, callbacks) {\n        var verto = this;\n\n        if (!verto.rpcClient.socketReady()) {\n            console.error(\"Not Connected...\");\n            return;\n        }\n\n        var dialog = new $.verto.dialog($.verto.enum.direction.outbound, this, args);\n\n        dialog.invite();\n\n        if (callbacks) {\n            dialog.callbacks = callbacks;\n        }\n\n        return dialog;\n    };\n\n    $.verto.prototype.handleMessage = function(data) {\n        var verto = this;\n\n        if (!(data && data.method)) {\n            console.error(\"Invalid Data\", data);\n            return;\n        }\n\n        if (data.params.callID) {\n            var dialog = verto.dialogs[data.params.callID];\n\t    \n\t    if (data.method === \"verto.attach\" && dialog) {\n\t\tdelete dialog.verto.dialogs[dialog.callID];\n\t\tdialog.rtc.stop();\n\t\tdialog = null;\n\t    }\n\n            if (dialog) {\n\n                switch (data.method) {\n                case 'verto.bye':\n                    dialog.hangup(data.params);\n                    break;\n                case 'verto.answer':\n                    dialog.handleAnswer(data.params);\n                    break;\n                case 'verto.media':\n                    dialog.handleMedia(data.params);\n                    break;\n                case 'verto.display':\n                    dialog.handleDisplay(data.params);\n                    break;\n                case 'verto.info':\n                    dialog.handleInfo(data.params);\n                    break;\n                default:\n                    console.debug(\"INVALID METHOD OR NON-EXISTANT CALL REFERENCE IGNORED\", dialog, data.method);\n                    break;\n                }\n            } else {\n\n                switch (data.method) {\n                case 'verto.attach':\n                    data.params.attach = true;\n\n                    if (data.params.sdp && data.params.sdp.indexOf(\"m=video\") > 0) {\n                        data.params.useVideo = true;\n                    }\n\n                    if (data.params.sdp && data.params.sdp.indexOf(\"stereo=1\") > 0) {\n                        data.params.useStereo = true;\n                    }\n\n                    dialog = new $.verto.dialog($.verto.enum.direction.inbound, verto, data.params);\n                    dialog.setState($.verto.enum.state.recovering);\n\n                    break;\n                case 'verto.invite':\n\n                    if (data.params.sdp && data.params.sdp.indexOf(\"m=video\") > 0) {\n                        data.params.wantVideo = true;\n                    }\n\n                    if (data.params.sdp && data.params.sdp.indexOf(\"stereo=1\") > 0) {\n                        data.params.useStereo = true;\n                    }\n\n                    dialog = new $.verto.dialog($.verto.enum.direction.inbound, verto, data.params);\n                    break;\n                default:\n                    console.debug(\"INVALID METHOD OR NON-EXISTANT CALL REFERENCE IGNORED\");\n                    break;\n                }\n            }\n\n            return {\n                method: data.method\n            };\n        } else {\n            switch (data.method) {\n            case 'verto.punt':\n                verto.purge();\n\t\tverto.logout();\n\t\tbreak;\n            case 'verto.event':\n                var list = null;\n                var key = null;\n\n                if (data.params) {\n                    key = data.params.eventChannel;\n                }\n\n                if (key) {\n                    list = verto.eventSUBS[key];\n\n                    if (!list) {\n                        list = verto.eventSUBS[key.split(\".\")[0]];\n                    }\n                }\n\n                if (!list && key && key === verto.sessid) {\n                    if (verto.callbacks.onMessage) {\n                        verto.callbacks.onMessage(verto, null, $.verto.enum.message.pvtEvent, data.params);\n                    }\n                } else if (!list && key && verto.dialogs[key]) {\n                    verto.dialogs[key].sendMessage($.verto.enum.message.pvtEvent, data.params);\n                } else if (!list) {\n                    if (!key) {\n                        key = \"UNDEFINED\";\n                    }\n                    console.error(\"UNSUBBED or invalid EVENT \" + key + \" IGNORED\");\n                } else {\n                    for (var i in list) {\n                        var sub = list[i];\n\n                        if (!sub || !sub.ready) {\n                            console.error(\"invalid EVENT for \" + key + \" IGNORED\");\n                        } else if (sub.handler) {\n                            sub.handler(verto, data.params, sub.userData);\n                        } else if (verto.callbacks.onEvent) {\n                            verto.callbacks.onEvent(verto, data.params, sub.userData);\n                        } else {\n                            console.log(\"EVENT:\", data.params);\n                        }\n                    }\n                }\n\n                break;\n\n            case \"verto.info\":\n                if (verto.callbacks.onMessage) {\n                    verto.callbacks.onMessage(verto, null, $.verto.enum.message.info, data.params.msg);\n                }\n                //console.error(data);\n                console.debug(\"MESSAGE from: \" + data.params.msg.from, data.params.msg.body);\n\n                break;\n\n            default:\n                console.error(\"INVALID METHOD OR NON-EXISTANT CALL REFERENCE IGNORED\", data.method);\n                break;\n            }\n        }\n    };\n\n    var del_array = function(array, name) {\n        var r = [];\n        var len = array.length;\n\n        for (var i = 0; i < len; i++) {\n            if (array[i] != name) {\n                r.push(array[i]);\n            }\n        }\n\n        return r;\n    };\n\n    var hashArray = function() {\n        var vha = this;\n\n        var hash = {};\n        var array = [];\n\n        vha.reorder = function(a) {\n            array = a;\n            var h = hash;\n            hash = {};\n\n            var len = array.length;\n\n            for (var i = 0; i < len; i++) {\n                var key = array[i];\n                if (h[key]) {\n                    hash[key] = h[key];\n                    delete h[key];\n                }\n            }\n            h = undefined;\n        };\n\n        vha.clear = function() {\n            hash = undefined;\n            array = undefined;\n            hash = {};\n            array = [];\n        };\n\n        vha.add = function(name, val, insertAt) {\n            var redraw = false;\n\n            if (!hash[name]) {\n                if (insertAt === undefined || insertAt < 0 || insertAt >= array.length) {\n                    array.push(name);\n                } else {\n                    var x = 0;\n                    var n = [];\n                    var len = array.length;\n\n                    for (var i = 0; i < len; i++) {\n                        if (x++==insertAt) {\n                            n.push(name);\n                        }\n                        n.push(array[i]);\n                    }\n\n                    array = undefined;\n                    array = n;\n                    n = undefined;\n                    redraw = true;\n                }\n            }\n\n            hash[name] = val;\n\n            return redraw;\n        };\n\n        vha.del = function(name) {\n            var r = false;\n\n            if (hash[name]) {\n                array = del_array(array, name);\n                delete hash[name];\n                r = true;\n            } else {\n                console.error(\"can't del nonexistant key \" + name);\n            }\n\n            return r;\n        };\n\n        vha.get = function(name) {\n            return hash[name];\n        };\n\n        vha.order = function() {\n            return array;\n        };\n\n        vha.hash = function() {\n            return hash;\n        };\n\n        vha.indexOf = function(name) {\n            var len = array.length;\n\n            for (var i = 0; i < len; i++) {\n                if (array[i] == name) {\n                    return i;\n                }\n            }\n        };\n\n        vha.arrayLen = function() {\n            return array.length;\n        };\n\n        vha.asArray = function() {\n            var r = [];\n\n            var len = array.length;\n\n            for (var i = 0; i < len; i++) {\n                var key = array[i];\n                r.push(hash[key]);\n            }\n\n            return r;\n        };\n\n        vha.each = function(cb) {\n            var len = array.length;\n\n            for (var i = 0; i < len; i++) {\n                cb(array[i], hash[array[i]]);\n            }\n        };\n\n        vha.dump = function(html) {\n            var str = \"\";\n\n            vha.each(function(name, val) {\n                str += \"name: \" + name + \" val: \" + JSON.stringify(val) + (html ? \"<br>\" : \"\\n\");\n            });\n\n            return str;\n        };\n\n    };\n\n    $.verto.liveArray = function(verto, context, name, config) {\n        var la = this;\n        var lastSerno = 0;\n        var binding = null;\n        var user_obj = config.userObj;\n        var local = false;\n\n        // Inherit methods of hashArray\n        hashArray.call(la);\n\n        // Save the hashArray add, del, reorder, clear methods so we can make our own.\n        la._add = la.add;\n        la._del = la.del;\n        la._reorder = la.reorder;\n        la._clear = la.clear;\n\n        la.context = context;\n        la.name = name;\n        la.user_obj = user_obj;\n\n        la.verto = verto;\n        la.broadcast = function(channel, obj) {\n            verto.broadcast(channel, obj);\n        };\n        la.errs = 0;\n\n        la.clear = function() {\n            la._clear();\n            lastSerno = 0;\n\n            if (la.onChange) {\n                la.onChange(la, {\n                    action: \"clear\"\n                });\n            }\n        };\n\n        la.checkSerno = function(serno) {\n            if (serno < 0) {\n                return true;\n            }\n\n            if (lastSerno > 0 && serno != (lastSerno + 1)) {\n                if (la.onErr) {\n                    la.onErr(la, {\n                        lastSerno: lastSerno,\n                        serno: serno\n                    });\n                }\n                la.errs++;\n                console.debug(la.errs);\n                if (la.errs < 3) {\n                    la.bootstrap(la.user_obj);\n                }\n                return false;\n            } else {\n                lastSerno = serno;\n                return true;\n            }\n        };\n\n        la.reorder = function(serno, a) {\n            if (la.checkSerno(serno)) {\n                la._reorder(a);\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"reorder\"\n                    });\n                }\n            }\n        };\n\n        la.init = function(serno, val, key, index) {\n            if (key === null || key === undefined) {\n                key = serno;\n            }\n            if (la.checkSerno(serno)) {\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"init\",\n                        index: index,\n                        key: key,\n                        data: val\n                    });\n                }\n            }\n        };\n\n        la.bootObj = function(serno, val) {\n            if (la.checkSerno(serno)) {\n\n                //la.clear();\n                for (var i in val) {\n                    la._add(val[i][0], val[i][1]);\n                }\n\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"bootObj\",\n                        data: val,\n                        redraw: true\n                    });\n                }\n            }\n        };\n\n        // @param serno  La is the serial number for la particular request.\n        // @param key    If looking at it as a hash table, la represents the key in the hashArray object where you want to store the val object.\n        // @param index  If looking at it as an array, la represents the position in the array where you want to store the val object.\n        // @param val    La is the object you want to store at the key or index location in the hash table / array.\n        la.add = function(serno, val, key, index) {\n            if (key === null || key === undefined) {\n                key = serno;\n            }\n            if (la.checkSerno(serno)) {\n                var redraw = la._add(key, val, index);\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"add\",\n                        index: index,\n                        key: key,\n                        data: val,\n                        redraw: redraw\n                    });\n                }\n            }\n        };\n\n        la.modify = function(serno, val, key, index) {\n            if (key === null || key === undefined) {\n                key = serno;\n            }\n            if (la.checkSerno(serno)) {\n                la._add(key, val, index);\n                if (la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"modify\",\n                        key: key,\n                        data: val,\n                        index: index\n                    });\n                }\n            }\n        };\n\n        la.del = function(serno, key, index) {\n            if (key === null || key === undefined) {\n                key = serno;\n            }\n            if (la.checkSerno(serno)) {\n                if (index === null || index < 0 || index === undefined) {\n                    index = la.indexOf(key);\n                }\n                var ok = la._del(key);\n\n                if (ok && la.onChange) {\n                    la.onChange(la, {\n                        serno: serno,\n                        action: \"del\",\n                        key: key,\n                        index: index\n                    });\n                }\n            }\n        };\n\n        var eventHandler = function(v, e, la) {\n            var packet = e.data;\n\n            //console.error(\"READ:\", packet);\n\n            if (packet.name != la.name) {\n                return;\n            }\n\n            switch (packet.action) {\n\n            case \"init\":\n                la.init(packet.wireSerno, packet.data, packet.hashKey, packet.arrIndex);\n                break;\n\n            case \"bootObj\":\n                la.bootObj(packet.wireSerno, packet.data);\n                break;\n            case \"add\":\n                la.add(packet.wireSerno, packet.data, packet.hashKey, packet.arrIndex);\n                break;\n\n            case \"modify\":\n                if (! (packet.arrIndex || packet.hashKey)) {\n                    console.error(\"Invalid Packet\", packet);\n                } else {\n                    la.modify(packet.wireSerno, packet.data, packet.hashKey, packet.arrIndex);\n                }\n                break;\n            case \"del\":\n                if (! (packet.arrIndex || packet.hashKey)) {\n                    console.error(\"Invalid Packet\", packet);\n                } else {\n                    la.del(packet.wireSerno, packet.hashKey, packet.arrIndex);\n                }\n                break;\n\n            case \"clear\":\n                la.clear();\n                break;\n\n            case \"reorder\":\n                la.reorder(packet.wireSerno, packet.order);\n                break;\n\n            default:\n                if (la.checkSerno(packet.wireSerno)) {\n                    if (la.onChange) {\n                        la.onChange(la, {\n                            serno: packet.wireSerno,\n                            action: packet.action,\n                            data: packet.data\n                        });\n                    }\n                }\n                break;\n            }\n        };\n\n        if (la.context) {\n            binding = la.verto.subscribe(la.context, {\n                handler: eventHandler,\n                userData: la,\n                subParams: config.subParams\n            });\n        }\n\n        la.destroy = function() {\n            la._clear();\n            la.verto.unsubscribe(binding);\n        };\n\n        la.sendCommand = function(cmd, obj) {\n            var self = la;\n            self.broadcast(self.context, {\n                liveArray: {\n                    command: cmd,\n                    context: self.context,\n                    name: self.name,\n                    obj: obj\n                }\n            });\n        };\n\n        la.bootstrap = function(obj) {\n            var self = la;\n            la.sendCommand(\"bootstrap\", obj);\n            //self.heartbeat();\n        };\n\n        la.changepage = function(obj) {\n            var self = la;\n            self.clear();\n            self.broadcast(self.context, {\n                liveArray: {\n                    command: \"changepage\",\n                    context: la.context,\n                    name: la.name,\n                    obj: obj\n                }\n            });\n        };\n\n        la.heartbeat = function(obj) {\n            var self = la;\n\n            var callback = function() {\n                self.heartbeat.call(self, obj);\n            };\n            self.broadcast(self.context, {\n                liveArray: {\n                    command: \"heartbeat\",\n                    context: self.context,\n                    name: self.name,\n                    obj: obj\n                }\n            });\n            self.hb_pid = setTimeout(callback, 30000);\n        };\n\n        la.bootstrap(la.user_obj);\n    };\n\n    $.verto.liveTable = function(verto, context, name, jq, config) {\n        var dt;\n        var la = new $.verto.liveArray(verto, context, name, {\n            subParams: config.subParams\n        });\n        var lt = this;\n\n        lt.liveArray = la;\n        lt.dataTable = dt;\n        lt.verto = verto;\n\n        lt.destroy = function() {\n            if (dt) {\n                dt.fnDestroy();\n            }\n            if (la) {\n                la.destroy();\n            }\n\n            dt = null;\n            la = null;\n        };\n\n        la.onErr = function(obj, args) {\n            console.error(\"Error: \", obj, args);\n        };\n\n\t/* back compat so jsonstatus can always be enabled */\n\tfunction genRow(data) {\n\t    if (typeof(data[4]) === \"string\" && data[4].indexOf(\"{\") > -1) {\n\t\tvar tmp = $.parseJSON(data[4]);\n\t\tdata[4] = tmp.oldStatus;\n\t\tdata[5] = null;\n\t    }\n\t    return data;\n\t}\n\n\tfunction genArray(obj) {\n\t    var data = obj.asArray();\n\n            for (var i in data) {\n\t\tdata[i] = genRow(data[i]);\n\t    }\n\n\t    return data;\n\t}\n\n\n        la.onChange = function(obj, args) {\n            var index = 0;\n            var iserr = 0;\n\n            if (!dt) {\n                if (!config.aoColumns) {\n                    if (args.action != \"init\") {\n                        return;\n                    }\n\n                    config.aoColumns = [];\n\n                    for (var i in args.data) {\n                        config.aoColumns.push({\n                            \"sTitle\": args.data[i]\n                        });\n                    }\n                }\n\n                dt = jq.dataTable(config);\n            }\n\n            if (dt && (args.action == \"del\" || args.action == \"modify\")) {\n                index = args.index;\n\n                if (index === undefined && args.key) {\n                    index = la.indexOf(args.key);\n                }\n\n                if (index === undefined) {\n                    console.error(\"INVALID PACKET Missing INDEX\\n\", args);\n                    return;\n                }\n            }\n\n            if (config.onChange) {\n                config.onChange(obj, args);\n            }\n\n            try {\n                switch (args.action) {\n                case \"bootObj\":\n                    if (!args.data) {\n                        console.error(\"missing data\");\n                        return;\n                    }\n                    dt.fnClearTable();\n                    dt.fnAddData(genArray(obj));\n                    dt.fnAdjustColumnSizing();\n                    break;\n                case \"add\":\n                    if (!args.data) {\n                        console.error(\"missing data\");\n                        return;\n                    }\n                    if (args.redraw > -1) {\n                        // specific position, more costly\n                        dt.fnClearTable();\n                        dt.fnAddData(genArray(obj));\n                    } else {\n                        dt.fnAddData(genRow(args.data));\n                    }\n                    dt.fnAdjustColumnSizing();\n                    break;\n                case \"modify\":\n                    if (!args.data) {\n                        return;\n                    }\n                    //console.debug(args, index);\n                    dt.fnUpdate(genRow(args.data), index);\n                    dt.fnAdjustColumnSizing();\n                    break;\n                case \"del\":\n                    dt.fnDeleteRow(index);\n                    dt.fnAdjustColumnSizing();\n                    break;\n                case \"clear\":\n                    dt.fnClearTable();\n                    break;\n                case \"reorder\":\n                    // specific position, more costly\n                    dt.fnClearTable();\n                    dt.fnAddData(genArray(obj));\n                    break;\n                case \"hide\":\n                    jq.hide();\n                    break;\n\n                case \"show\":\n                    jq.show();\n                    break;\n\n                }\n            } catch(err) {\n                console.error(\"ERROR: \" + err);\n                iserr++;\n            }\n\n            if (iserr) {\n                obj.errs++;\n                if (obj.errs < 3) {\n                    obj.bootstrap(obj.user_obj);\n                }\n            } else {\n                obj.errs = 0;\n            }\n\n        };\n\n        la.onChange(la, {\n            action: \"init\"\n        });\n\n    };\n\n    var CONFMAN_SERNO = 1;\n\n    /*\n        Conference Manager without jQuery table.\n     */\n\n    $.verto.conf = function(verto, params) {\n        var conf = this;\n\n        conf.params = $.extend({\n            dialog: null,\n            hasVid: false,\n            laData: null,\n            onBroadcast: null,\n            onLaChange: null,\n            onLaRow: null\n        }, params);\n\n        conf.verto = verto;\n        conf.serno = CONFMAN_SERNO++;\n\n        createMainModeratorMethods();\n\n        verto.subscribe(conf.params.laData.modChannel, {\n            handler: function(v, e) {\n                if (conf.params.onBroadcast) {\n                    conf.params.onBroadcast(verto, conf, e.data);\n                }\n            }\n        });\n\n        verto.subscribe(conf.params.laData.chatChannel, {\n            handler: function(v, e) {\n                if (typeof(conf.params.chatCallback) === \"function\") {\n                    conf.params.chatCallback(v,e);\n                }\n            }\n        });\n    };\n\n    $.verto.conf.prototype.modCommand = function(cmd, id, value) {\n        var conf = this;\n\n        conf.verto.rpcClient.call(\"verto.broadcast\", {\n            \"eventChannel\": conf.params.laData.modChannel,\n            \"data\": {\n                \"application\": \"conf-control\",\n                \"command\": cmd,\n                \"id\": id,\n                \"value\": value\n            }\n        });\n    };\n\n    $.verto.conf.prototype.destroy = function() {\n        var conf = this;\n\n        conf.destroyed = true;\n        conf.params.onBroadcast(conf.verto, conf, 'destroy');\n\n        if (conf.params.laData.modChannel) {\n            conf.verto.unsubscribe(conf.params.laData.modChannel);\n        }\n\n        if (conf.params.laData.chatChannel) {\n            conf.verto.unsubscribe(conf.params.laData.chatChannel);\n        }\n    };\n\n    function createMainModeratorMethods() {\n        $.verto.conf.prototype.listVideoLayouts = function() {\n            this.modCommand(\"list-videoLayouts\", null, null);\n        };\n\n        $.verto.conf.prototype.play = function(file) {\n            this.modCommand(\"play\", null, file);\n        };\n\n        $.verto.conf.prototype.stop = function() {\n            this.modCommand(\"stop\", null, \"all\");\n        };\n\n        $.verto.conf.prototype.deaf = function(memberID) {\n            this.modCommand(\"deaf\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.undeaf = function(memberID) {\n            this.modCommand(\"undeaf\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.record = function(file) {\n            this.modCommand(\"recording\", null, [\"start\", file]);\n        };\n\n        $.verto.conf.prototype.stopRecord = function() {\n            this.modCommand(\"recording\", null, [\"stop\", \"all\"]);\n        };\n\n        $.verto.conf.prototype.snapshot = function(file) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"vid-write-png\", null, file);\n        };\n\n        $.verto.conf.prototype.setVideoLayout = function(layout, canvasID) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n\t    if (canvasID) {\n\t\tthis.modCommand(\"vid-layout\", null, [layout, canvasID]);\n\t    } else {\n\t\tthis.modCommand(\"vid-layout\", null, layout);\n\t    }\n        };\n\n        $.verto.conf.prototype.kick = function(memberID) {\n            this.modCommand(\"kick\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.muteMic = function(memberID) {\n            this.modCommand(\"tmute\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.muteVideo = function(memberID) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"tvmute\", parseInt(memberID));\n        };\n\n        $.verto.conf.prototype.presenter = function(memberID) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"vid-res-id\", parseInt(memberID), \"presenter\");\n        };\n\n        $.verto.conf.prototype.videoFloor = function(memberID) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"vid-floor\", parseInt(memberID), \"force\");\n        };\n\n        $.verto.conf.prototype.banner = function(memberID, text) {\n            if (!this.params.hasVid) {\n                throw 'Conference has no video';\n            }\n            this.modCommand(\"vid-banner\", parseInt(memberID), escape(text));\n        };\n\n        $.verto.conf.prototype.volumeDown = function(memberID) {\n            this.modCommand(\"volume_out\", parseInt(memberID), \"down\");\n        };\n\n        $.verto.conf.prototype.volumeUp = function(memberID) {\n            this.modCommand(\"volume_out\", parseInt(memberID), \"up\");\n        };\n\n        $.verto.conf.prototype.gainDown = function(memberID) {\n            this.modCommand(\"volume_in\", parseInt(memberID), \"down\");\n        };\n\n        $.verto.conf.prototype.gainUp = function(memberID) {\n            this.modCommand(\"volume_in\", parseInt(memberID), \"up\");\n        };\n\n        $.verto.conf.prototype.transfer = function(memberID, exten) {\n            this.modCommand(\"transfer\", parseInt(memberID), exten);\n        };\n\n        $.verto.conf.prototype.sendChat = function(message, type) {\n            var conf = this;\n            conf.verto.rpcClient.call(\"verto.broadcast\", {\n                \"eventChannel\": conf.params.laData.chatChannel,\n                \"data\": {\n                    \"action\": \"send\",\n                    \"message\": message,\n                    \"type\": type\n                }\n            });\n        };\n            \n    }\n\n    $.verto.modfuncs = {};\n\n    $.verto.confMan = function(verto, params) {\n        var confMan = this;\n\n        confMan.params = $.extend({\n            tableID: null,\n            statusID: null,\n            mainModID: null,\n            dialog: null,\n            hasVid: false,\n            laData: null,\n            onBroadcast: null,\n            onLaChange: null,\n            onLaRow: null\n        }, params);\n\n        confMan.verto = verto;\n        confMan.serno = CONFMAN_SERNO++;\n\tconfMan.canvasCount = confMan.params.laData.canvasCount;\n\t\n        function genMainMod(jq) {\n            var play_id = \"play_\" + confMan.serno;\n            var stop_id = \"stop_\" + confMan.serno;\n            var recording_id = \"recording_\" + confMan.serno;\n            var snapshot_id = \"snapshot_\" + confMan.serno;\n            var rec_stop_id = \"recording_stop\" + confMan.serno;\n            var div_id = \"confman_\" + confMan.serno;\n\n            var html =  \"<div id='\" + div_id + \"'><br>\" +\n\t\t\"<button class='ctlbtn' id='\" + play_id + \"'>Play</button>\" +\n\t\t\"<button class='ctlbtn' id='\" + stop_id + \"'>Stop</button>\" +\n\t\t\"<button class='ctlbtn' id='\" + recording_id + \"'>Record</button>\" +\n\t\t\"<button class='ctlbtn' id='\" + rec_stop_id + \"'>Record Stop</button>\" +\n\t\t(confMan.params.hasVid ? \"<button class='ctlbtn' id='\" + snapshot_id + \"'>PNG Snapshot</button>\" : \"\") +\n\t\t\"<br><br></div>\";\n\n            jq.html(html);\n\n\t    $.verto.modfuncs.change_video_layout = function(id, canvas_id) {\t    \n\t\tvar val = $(\"#\" + id + \" option:selected\").text();\n\t\tif (val !== \"none\") {\n                    confMan.modCommand(\"vid-layout\", null, [val, canvas_id]);\n\t\t}\n\t    };\n\n\t    if (confMan.params.hasVid) {\n\t\tfor (var j = 0; j < confMan.canvasCount; j++) {\n\t\t    var vlayout_id = \"confman_vid_layout_\" + j + \"_\" + confMan.serno;\n\t\t    var vlselect_id = \"confman_vl_select_\" + j + \"_\" + confMan.serno;\n\t\t\n\n\t\t    var vlhtml =  \"<div id='\" + vlayout_id + \"'><br>\" +\n\t\t\t\"<b>Video Layout Canvas \" + (j+1) + \n\t\t\t\"</b> <select onChange='$.verto.modfuncs.change_video_layout(\\\"\" + vlayout_id + \"\\\", \\\"\" + (j+1) + \"\\\")' id='\" + vlselect_id + \"'></select> \" +\n\t\t\t\"<br><br></div>\";\n\t\t    jq.append(vlhtml);\n\t\t}\n\n\t\t$(\"#\" + snapshot_id).click(function() {\n                    var file = prompt(\"Please enter file name\", \"\");\n\t\t    if (file) {\n\t\t\tconfMan.modCommand(\"vid-write-png\", null, file);\n\t\t    }\n\t\t});\n\t    }\n\n            $(\"#\" + play_id).click(function() {\n                var file = prompt(\"Please enter file name\", \"\");\n\t\tif (file) {\n                    confMan.modCommand(\"play\", null, file);\n\t\t}\n            });\n\n            $(\"#\" + stop_id).click(function() {\n                confMan.modCommand(\"stop\", null, \"all\");\n            });\n\n            $(\"#\" + recording_id).click(function() {\n                var file = prompt(\"Please enter file name\", \"\");\n\t\tif (file) {\n                    confMan.modCommand(\"recording\", null, [\"start\", file]);\n\t\t}\n            });\n\n            $(\"#\" + rec_stop_id).click(function() {\n                confMan.modCommand(\"recording\", null, [\"stop\", \"all\"]);\n            });\n\n        }\n\n        function genControls(jq, rowid) {\n            var x = parseInt(rowid);\n            var kick_id = \"kick_\" + x;\n            var canvas_in_next_id = \"canvas_in_next_\" + x;\n            var canvas_in_prev_id = \"canvas_in_prev_\" + x;\n            var canvas_out_next_id = \"canvas_out_next_\" + x;\n            var canvas_out_prev_id = \"canvas_out_prev_\" + x;\n\n            var canvas_in_set_id = \"canvas_in_set_\" + x;\n            var canvas_out_set_id = \"canvas_out_set_\" + x;\n\n            var layer_set_id = \"layer_set_\" + x;\n            var layer_next_id = \"layer_next_\" + x;\n            var layer_prev_id = \"layer_prev_\" + x;\n\t    \n            var tmute_id = \"tmute_\" + x;\n            var tvmute_id = \"tvmute_\" + x;\n            var vbanner_id = \"vbanner_\" + x;\n            var tvpresenter_id = \"tvpresenter_\" + x;\n            var tvfloor_id = \"tvfloor_\" + x;\n            var box_id = \"box_\" + x;\n            var gainup_id = \"gain_in_up\" + x;\n            var gaindn_id = \"gain_in_dn\" + x;\n            var volup_id = \"vol_in_up\" + x;\n            var voldn_id = \"vol_in_dn\" + x;\n            var transfer_id = \"transfer\" + x;\n\t    \n\n            var html = \"<div id='\" + box_id + \"'>\";\n\n\t    html += \"<b>General Controls</b><hr noshade>\";\n\n            html += \"<button class='ctlbtn' id='\" + kick_id + \"'>Kick</button>\" +\n                \"<button class='ctlbtn' id='\" + tmute_id + \"'>Mute</button>\" +\n                \"<button class='ctlbtn' id='\" + gainup_id + \"'>Gain -</button>\" +\n                \"<button class='ctlbtn' id='\" + gaindn_id + \"'>Gain +</button>\" +\n                \"<button class='ctlbtn' id='\" + voldn_id + \"'>Vol -</button>\" +\n                \"<button class='ctlbtn' id='\" + volup_id + \"'>Vol +</button>\" +\n                \"<button class='ctlbtn' id='\" + transfer_id + \"'>Transfer</button>\";\n\t\t\n\t    if (confMan.params.hasVid) {\n\t\thtml += \"<br><br><b>Video Controls</b><hr noshade>\";\n\n\n                html += \"<button class='ctlbtn' id='\" + tvmute_id + \"'>VMute</button>\" +\n                    \"<button class='ctlbtn' id='\" + tvpresenter_id + \"'>Presenter</button>\" +\n                    \"<button class='ctlbtn' id='\" + tvfloor_id + \"'>Vid Floor</button>\" +\n                    \"<button class='ctlbtn' id='\" + vbanner_id + \"'>Banner</button>\";\n\n\t\tif (confMan.canvasCount > 1) {\n                    html += \"<br><br><b>Canvas Controls</b><hr noshade>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_in_set_id + \"'>Set Input Canvas</button>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_in_prev_id + \"'>Prev Input Canvas</button>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_in_next_id + \"'>Next Input Canvas</button>\" +\n\t\t\t\n\t\t    \"<br>\" +\n\t\t\t\n\t\t    \"<button class='ctlbtn' id='\" + canvas_out_set_id + \"'>Set Watching Canvas</button>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_out_prev_id + \"'>Prev Watching Canvas</button>\" +\n\t\t\t\"<button class='ctlbtn' id='\" + canvas_out_next_id + \"'>Next Watching Canvas</button>\";\n\t\t}\n\t\t\n\t\thtml += \"<br>\" +\n\n                \"<button class='ctlbtn' id='\" + layer_set_id + \"'>Set Layer</button>\" +\n                    \"<button class='ctlbtn' id='\" + layer_prev_id + \"'>Prev Layer</button>\" +\n                    \"<button class='ctlbtn' id='\" + layer_next_id + \"'>Next Layer</button>\" +\n\n\n\n                    \"</div>\";\n            }\n\n            jq.html(html);\n\n\n            if (!jq.data(\"mouse\")) {\n                $(\"#\" + box_id).hide();\n            }\n\n            jq.mouseover(function(e) {\n                jq.data({\"mouse\": true});\n                $(\"#\" + box_id).show();\n            });\n\n            jq.mouseout(function(e) {\n                jq.data({\"mouse\": false});\n                $(\"#\" + box_id).hide();\n            });\n\n            $(\"#\" + transfer_id).click(function() {\n                var xten = prompt(\"Enter Extension\");\n\t\tif (xten) {\n                    confMan.modCommand(\"transfer\", x, xten);\n\t\t}\n            });\n\n            $(\"#\" + kick_id).click(function() {\n                confMan.modCommand(\"kick\", x);\n            });\n\n\n            $(\"#\" + layer_set_id).click(function() {\n                var cid = prompt(\"Please enter layer ID\", \"\");\n\t\tif (cid) {\n                    confMan.modCommand(\"vid-layer\", x, cid);\n\t\t}\n            });\n\n            $(\"#\" + layer_next_id).click(function() {\n                confMan.modCommand(\"vid-layer\", x, \"next\");\n            });\n            $(\"#\" + layer_prev_id).click(function() {\n                confMan.modCommand(\"vid-layer\", x, \"prev\");\n            });\n\n            $(\"#\" + canvas_in_set_id).click(function() {\n                var cid = prompt(\"Please enter canvas ID\", \"\");\n\t\tif (cid) {\n                    confMan.modCommand(\"vid-canvas\", x, cid);\n\t\t}\n            });\n\n            $(\"#\" + canvas_out_set_id).click(function() {\n                var cid = prompt(\"Please enter canvas ID\", \"\");\n\t\tif (cid) {\n                    confMan.modCommand(\"vid-watching-canvas\", x, cid);\n\t\t}\n            });\n\n            $(\"#\" + canvas_in_next_id).click(function() {\n                confMan.modCommand(\"vid-canvas\", x, \"next\");\n            });\n            $(\"#\" + canvas_in_prev_id).click(function() {\n                confMan.modCommand(\"vid-canvas\", x, \"prev\");\n            });\n\n\n            $(\"#\" + canvas_out_next_id).click(function() {\n                confMan.modCommand(\"vid-watching-canvas\", x, \"next\");\n            });\n            $(\"#\" + canvas_out_prev_id).click(function() {\n                confMan.modCommand(\"vid-watching-canvas\", x, \"prev\");\n            });\n\t    \n            $(\"#\" + tmute_id).click(function() {\n                confMan.modCommand(\"tmute\", x);\n            });\n\n\t    if (confMan.params.hasVid) {\n\t\t$(\"#\" + tvmute_id).click(function() {\n                    confMan.modCommand(\"tvmute\", x);\n\t\t});\n\t\t$(\"#\" + tvpresenter_id).click(function() {\n                    confMan.modCommand(\"vid-res-id\", x, \"presenter\");\n\t\t});\n\t\t$(\"#\" + tvfloor_id).click(function() {\n                    confMan.modCommand(\"vid-floor\", x, \"force\");\n\t\t});\n\t\t$(\"#\" + vbanner_id).click(function() {\n                    var text = prompt(\"Please enter text\", \"\");\n\t\t    if (text) {\n\t\t\tconfMan.modCommand(\"vid-banner\", x, escape(text));\n\t\t    }\n\t\t});\n\t    }\n\n            $(\"#\" + gainup_id).click(function() {\n                confMan.modCommand(\"volume_in\", x, \"up\");\n            });\n\n            $(\"#\" + gaindn_id).click(function() {\n                confMan.modCommand(\"volume_in\", x, \"down\");\n            });\n\n            $(\"#\" + volup_id).click(function() {\n                confMan.modCommand(\"volume_out\", x, \"up\");\n            });\n\n            $(\"#\" + voldn_id).click(function() {\n                confMan.modCommand(\"volume_out\", x, \"down\");\n            });\n\n            return html;\n        }\n\n        var atitle = \"\";\n        var awidth = 0;\n\n        //$(\".jsDataTable\").width(confMan.params.hasVid ? \"900px\" : \"800px\");\n\n\tverto.subscribe(confMan.params.laData.chatChannel, {\n\t    handler: function(v, e) {\n\t\tif (typeof(confMan.params.chatCallback) === \"function\") {\n\t\t    confMan.params.chatCallback(v,e);\n\t\t}\n\t    }\n\t});\n\n        if (confMan.params.laData.role === \"moderator\") {\n            atitle = \"Action\";\n            awidth = 600;\n\n            if (confMan.params.mainModID) {\n                genMainMod($(confMan.params.mainModID));\n                $(confMan.params.displayID).html(\"Moderator Controls Ready<br><br>\");\n            } else {\n                $(confMan.params.mainModID).html(\"\");\n            }\n\n            verto.subscribe(confMan.params.laData.modChannel, {\n                handler: function(v, e) {\n                    //console.error(\"MODDATA:\", e.data);\n                    if (confMan.params.onBroadcast) {\n                        confMan.params.onBroadcast(verto, confMan, e.data);\n                    }\n\n\t\t    if (e.data[\"conf-command\"] === \"list-videoLayouts\") {\n\t\t\tfor (var j = 0; j < confMan.canvasCount; j++) {\n\t\t\t    var vlselect_id = \"#confman_vl_select_\" + j + \"_\" + confMan.serno;\n\t\t\t    var vlayout_id = \"#confman_vid_layout_\" + j + \"_\" + confMan.serno;\n\t\t\t    \n\t\t\t    var x = 0;\n\t\t\t    var options;\n\t\t\t    \n\t\t\t    $(vlselect_id).selectmenu({});\n\t\t\t    $(vlselect_id).selectmenu(\"enable\");\n\t\t\t    $(vlselect_id).empty();\n\t\t\t    \n\t\t\t    $(vlselect_id).append(new Option(\"Choose a Layout\", \"none\"));\n\n\t\t\t    if (e.data.responseData) {\n\t\t\t\tvar rdata = [];\n\n\t\t\t\tfor (var i in e.data.responseData) {\n\t\t\t\t    rdata.push(e.data.responseData[i].name);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\toptions = rdata.sort(function(a, b) {\n\t\t\t\t    var ga = a.substring(0, 6) == \"group:\" ? true : false;\n\t\t\t\t    var gb = b.substring(0, 6) == \"group:\" ? true : false;\n\t\t\t\t    \n\t\t\t\t    if ((ga || gb) && ga != gb) {\n\t\t\t\t\treturn ga ? -1 : 1;\n\t\t\t\t    }\n\t\t\t\t    \n\t\t\t\t    return ( ( a == b ) ? 0 : ( ( a > b ) ? 1 : -1 ) );\n\t\t\t\t});\n\n\t\t\t\tfor (var i in options) {\n\t\t\t\t    $(vlselect_id).append(new Option(options[i], options[i]));\n\t\t\t\t    x++;\n\t\t\t\t}\n\t\t\t    }\n\n\t\t\t    if (x) {\n\t\t\t\t$(vlselect_id).selectmenu('refresh', true);\n\t\t\t    } else {\n\t\t\t\t$(vlayout_id).hide();\n\t\t\t    }\n\t\t\t}\n\t\t    } else {\n\n\t\t\tif (!confMan.destroyed && confMan.params.displayID) {\n                            $(confMan.params.displayID).html(e.data.response + \"<br><br>\");\n                            if (confMan.lastTimeout) {\n\t\t\t\tclearTimeout(confMan.lastTimeout);\n\t\t\t\tconfMan.lastTimeout = 0;\n                            }\n                            confMan.lastTimeout = setTimeout(function() { $(confMan.params.displayID).html(confMan.destroyed ? \"\" : \"Moderator Controls Ready<br><br>\");}, 4000);\n\t\t\t}\n\t\t    }\n                }\n            });\n\n\n\t    if (confMan.params.hasVid) {\n\t\tconfMan.modCommand(\"list-videoLayouts\", null, null);\n\t    }\n        }\n\n        var row_callback = null;\n\n        if (confMan.params.laData.role === \"moderator\") {\n            row_callback = function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {\n                if (!aData[5]) {\n                    var $row = $('td:eq(5)', nRow);\n                    genControls($row, aData);\n\n                    if (confMan.params.onLaRow) {\n                        confMan.params.onLaRow(verto, confMan, $row, aData);\n                    }\n                }\n            };\n        }\n\n        confMan.lt = new $.verto.liveTable(verto, confMan.params.laData.laChannel, confMan.params.laData.laName, $(confMan.params.tableID), {\n            subParams: {\n                callID: confMan.params.dialog ? confMan.params.dialog.callID : null\n            },\n\n            \"onChange\": function(obj, args) {\n                $(confMan.params.statusID).text(\"Conference Members: \" + \" (\" + obj.arrayLen() + \" Total)\");\n                if (confMan.params.onLaChange) {\n                    confMan.params.onLaChange(verto, confMan, $.verto.enum.confEvent.laChange, obj, args);\n                }\n            },\n\n            \"aaData\": [],\n            \"aoColumns\": [\n                {\n                    \"sTitle\": \"ID\",\n                    \"sWidth\": \"50\"\n                },\n                {\n                    \"sTitle\": \"Number\",\n\t\t    \"sWidth\": \"250\"\n                },\n                {\n                    \"sTitle\": \"Name\",\n\t\t    \"sWidth\": \"250\"\n                },\n                {\n                    \"sTitle\": \"Codec\",\n                    \"sWidth\": \"100\"\n                },\n                {\n                    \"sTitle\": \"Status\",\n                    \"sWidth\": confMan.params.hasVid ? \"200px\" : \"150px\"\n                },\n                {\n                    \"sTitle\": atitle,\n                    \"sWidth\": awidth,\n                }\n            ],\n            \"bAutoWidth\": true,\n            \"bDestroy\": true,\n            \"bSort\": false,\n            \"bInfo\": false,\n            \"bFilter\": false,\n            \"bLengthChange\": false,\n            \"bPaginate\": false,\n            \"iDisplayLength\": 1400,\n\n            \"oLanguage\": {\n                \"sEmptyTable\": \"The Conference is Empty.....\"\n            },\n\n            \"fnRowCallback\": row_callback\n\n        });\n    };\n\n    $.verto.confMan.prototype.modCommand = function(cmd, id, value) {\n        var confMan = this;\n\n        confMan.verto.rpcClient.call(\"verto.broadcast\", {\n            \"eventChannel\": confMan.params.laData.modChannel,\n            \"data\": {\n\t\t\"application\": \"conf-control\",\n\t\t\"command\": cmd,\n\t\t\"id\": id,\n\t\t\"value\": value\n            }\n\t});\n    };\n\n    $.verto.confMan.prototype.sendChat = function(message, type) {\n        var confMan = this;\n        confMan.verto.rpcClient.call(\"verto.broadcast\", {\n            \"eventChannel\": confMan.params.laData.chatChannel,\n            \"data\": {\n\t\t\"action\": \"send\",\n\t\t\"message\": message,\n\t\t\"type\": type\n            }\n\t});\n    };\n\n\n    $.verto.confMan.prototype.destroy = function() {\n        var confMan = this;\n\n        confMan.destroyed = true;\n\n        if (confMan.lt) {\n            confMan.lt.destroy();\n        }\n\n        if (confMan.params.laData.chatChannel) {\n            confMan.verto.unsubscribe(confMan.params.laData.chatChannel);\n        }\n\n        if (confMan.params.laData.modChannel) {\n            confMan.verto.unsubscribe(confMan.params.laData.modChannel);\n        }\n\n        if (confMan.params.mainModID) {\n            $(confMan.params.mainModID).html(\"\");\n        }\n    };\n\n    $.verto.dialog = function(direction, verto, params) {\n        var dialog = this;\n\n        dialog.params = $.extend({\n            useVideo: verto.options.useVideo,\n            useStereo: verto.options.useStereo,\n\t    screenShare: false,\n\t    useCamera: verto.options.deviceParams.useCamera,\n\t    useMic: verto.options.deviceParams.useMic,\n\t    useSpeak: verto.options.deviceParams.useSpeak,\n            tag: verto.options.tag,\n            localTag: verto.options.localTag,\n            login: verto.options.login,\n\t    videoParams: verto.options.videoParams\n        }, params);\n\t\n        dialog.verto = verto;\n        dialog.direction = direction;\n        dialog.lastState = null;\n        dialog.state = dialog.lastState = $.verto.enum.state.new;\n        dialog.callbacks = verto.callbacks;\n        dialog.answered = false;\n        dialog.attach = params.attach || false;\n\tdialog.screenShare = params.screenShare || false;\n\tdialog.useCamera = dialog.params.useCamera;\n\tdialog.useMic = dialog.params.useMic;\n\tdialog.useSpeak = dialog.params.useSpeak;\n\t\n        if (dialog.params.callID) {\n            dialog.callID = dialog.params.callID;\n        } else {\n            dialog.callID = dialog.params.callID = generateGUID();\n        }\n\n\tif (typeof(dialog.params.tag) === \"function\") {\n\t\tdialog.params.tag = dialog.params.tag();\n\t}\n\t\n        if (dialog.params.tag) {\n            dialog.audioStream = document.getElementById(dialog.params.tag);\n\n            if (dialog.params.useVideo) {\n                dialog.videoStream = dialog.audioStream;\n            }\n        } //else conjure one TBD\n\n        if (dialog.params.localTag) {\n\t    dialog.localVideo = document.getElementById(dialog.params.localTag);\n\t}\n\n        dialog.verto.dialogs[dialog.callID] = dialog;\n\n        var RTCcallbacks = {};\n\n        if (dialog.direction == $.verto.enum.direction.inbound) {\n            if (dialog.params.display_direction === \"outbound\") {\n                dialog.params.remote_caller_id_name = dialog.params.caller_id_name;\n                dialog.params.remote_caller_id_number = dialog.params.caller_id_number;\n            } else {\n                dialog.params.remote_caller_id_name = dialog.params.callee_id_name;\n                dialog.params.remote_caller_id_number = dialog.params.callee_id_number;\n            }\n\n            if (!dialog.params.remote_caller_id_name) {\n                dialog.params.remote_caller_id_name = \"Nobody\";\n            }\n\n            if (!dialog.params.remote_caller_id_number) {\n                dialog.params.remote_caller_id_number = \"UNKNOWN\";\n            }\n\n            RTCcallbacks.onMessage = function(rtc, msg) {\n                console.debug(msg);\n            };\n\n            RTCcallbacks.onAnswerSDP = function(rtc, sdp) {\n                console.error(\"answer sdp\", sdp);\n            };\n        } else {\n            dialog.params.remote_caller_id_name = \"Outbound Call\";\n            dialog.params.remote_caller_id_number = dialog.params.destination_number;\n        }\n\n        RTCcallbacks.onICESDP = function(rtc) {\n            console.log(\"RECV \" + rtc.type + \" SDP\", rtc.mediaData.SDP);\n\n\t    if (dialog.state == $.verto.enum.state.requesting || dialog.state == $.verto.enum.state.answering || dialog.state == $.verto.enum.state.active) {\n\t\tlocation.reload();\n\t\treturn;\n\t    }\n\n            if (rtc.type == \"offer\") {\n\t\tif (dialog.state == $.verto.enum.state.active) {\n                    dialog.setState($.verto.enum.state.requesting);\n\t\t    dialog.sendMethod(\"verto.attach\", {\n\t\t\tsdp: rtc.mediaData.SDP\n                    });\n\t\t} else {\n                    dialog.setState($.verto.enum.state.requesting);\n\t\t    \n                    dialog.sendMethod(\"verto.invite\", {\n\t\t\tsdp: rtc.mediaData.SDP\n                    });\n\t\t}\n            } else { //answer\n                dialog.setState($.verto.enum.state.answering);\n\n                dialog.sendMethod(dialog.attach ? \"verto.attach\" : \"verto.answer\", {\n                    sdp: dialog.rtc.mediaData.SDP\n                });\n            }\n        };\n\n        RTCcallbacks.onICE = function(rtc) {\n            //console.log(\"cand\", rtc.mediaData.candidate);\n            if (rtc.type == \"offer\") {\n                console.log(\"offer\", rtc.mediaData.candidate);\n                return;\n            }\n        };\n\n        RTCcallbacks.onStream = function(rtc, stream) {\n            if (dialog.verto.options.permissionCallback &&\n                typeof dialog.verto.options.permissionCallback.onGranted === 'function'){\n                dialog.verto.options.permissionCallback.onGranted(stream);\n            }\n            console.log(\"stream started\");\n        };\n\n        RTCcallbacks.onError = function(e) {\n            if (dialog.verto.options.permissionCallback &&\n                typeof dialog.verto.options.permissionCallback.onDenied === 'function'){\n                dialog.verto.options.permissionCallback.onDenied();\n            }\n            console.error(\"ERROR:\", e);\n            dialog.hangup({cause: \"Device or Permission Error\"});\n        };\n\n        dialog.rtc = new $.FSRTC({\n            callbacks: RTCcallbacks,\n\t    localVideo: dialog.screenShare ? null : dialog.localVideo,\n            useVideo: dialog.params.useVideo ? dialog.videoStream : null,\n            useAudio: dialog.audioStream,\n            useStereo: dialog.params.useStereo,\n            videoParams: dialog.params.videoParams,\n            audioParams: verto.options.audioParams,\n            iceServers: verto.options.iceServers,\n\t    screenShare: dialog.screenShare,\n\t    useCamera: dialog.useCamera,\n\t    useMic: dialog.useMic,\n\t    useSpeak: dialog.useSpeak\n        });\n\n        dialog.rtc.verto = dialog.verto;\n\n        if (dialog.direction == $.verto.enum.direction.inbound) {\n            if (dialog.attach) {\n                dialog.answer();\n            } else {\n                dialog.ring();\n            }\n        }\n    };\n\n    $.verto.dialog.prototype.invite = function() {\n        var dialog = this;\n        dialog.rtc.call();\n    };\n\n    $.verto.dialog.prototype.sendMethod = function(method, obj) {\n        var dialog = this;\n        obj.dialogParams = {};\n\n        for (var i in dialog.params) {\n            if (i == \"sdp\" && method != \"verto.invite\" && method != \"verto.attach\") {\n                continue;\n            }\n\n            obj.dialogParams[i] = dialog.params[i];\n        }\n\n        dialog.verto.rpcClient.call(method, obj,\n\n        function(e) {\n            /* Success */\n            dialog.processReply(method, true, e);\n        },\n\n        function(e) {\n            /* Error */\n            dialog.processReply(method, false, e);\n        });\n    };\n\n    function checkStateChange(oldS, newS) {\n\n        if (newS == $.verto.enum.state.purge || $.verto.enum.states[oldS.name][newS.name]) {\n            return true;\n        }\n\n        return false;\n    }\n\n\n    // Attach audio output device to video element using device/sink ID.                                                                                           \n    function find_name(id) {\n\tfor (var i in $.verto.audioOutDevices) {\n\t    var source = $.verto.audioOutDevices[i];\n\t    if (source.id === id) {\n\t\treturn(source.label);\n\t    }\n\t}\n\n\treturn id;\n    }\n\n    $.verto.dialog.prototype.setAudioPlaybackDevice = function(sinkId, callback, arg) {\n\tvar dialog = this;\n\tvar element = dialog.audioStream;\n\n\tif (typeof element.sinkId !== 'undefined') {\n\t    var devname = find_name(sinkId);\n\t    console.info(\"Dialog: \" + dialog.callID + \" Setting speaker:\", element, devname);\n\n\t    element.setSinkId(sinkId)\n\t\t.then(function() {\n\t\t    console.log(\"Dialog: \" + dialog.callID + ' Success, audio output device attached: ' + sinkId);\n\t\t    if (callback) {\n\t\t\tcallback(true, devname, arg);\n\t\t    }\n\t\t})\n\t\t.catch(function(error) {\n\t\t    var errorMessage = error;\n\t\t    if (error.name === 'SecurityError') {\n\t\t\terrorMessage = \"Dialog: \" + dialog.callID + ' You need to use HTTPS for selecting audio output ' +\n\t\t\t    'device: ' + error;\n\t\t    }\n\t\t    if (callback) {\n\t\t\tcallback(false, null, arg);\n\t\t    }\n\t\t    console.error(errorMessage);\n\t\t});\n\t} else {\n\t    console.warn(\"Dialog: \" + dialog.callID + ' Browser does not support output device selection.');\n\t    if (callback) {\n\t\tcallback(false, null, arg);\n\t    }\n\t}\n    }\n\n    $.verto.dialog.prototype.setState = function(state) {\n        var dialog = this;\n\n        if (dialog.state == $.verto.enum.state.ringing) {\n            dialog.stopRinging();\n        }\n\n        if (dialog.state == state || !checkStateChange(dialog.state, state)) {\n            console.error(\"Dialog \" + dialog.callID + \": INVALID state change from \" + dialog.state.name + \" to \" + state.name);\n            dialog.hangup();\n            return false;\n        }\n\n        console.log(\"Dialog \" + dialog.callID + \": state change from \" + dialog.state.name + \" to \" + state.name);\n\n        dialog.lastState = dialog.state;\n        dialog.state = state;\n\n        if (!dialog.causeCode) {\n            dialog.causeCode = 16;\n        }\n\n        if (!dialog.cause) {\n            dialog.cause = \"NORMAL CLEARING\";\n        }\n\n        if (dialog.callbacks.onDialogState) {\n            dialog.callbacks.onDialogState(this);\n        }\n\n        switch (dialog.state) {\n\n        case $.verto.enum.state.early:\n        case $.verto.enum.state.active:\n\n\t    var speaker = dialog.useSpeak;\n\t    console.info(\"Using Speaker: \", speaker);\n\n\t    if (speaker && speaker !== \"any\" && speaker !== \"none\") {\n\t\tsetTimeout(function() {\n\t\t    dialog.setAudioPlaybackDevice(speaker);\n\t\t}, 500);\n\t    }\n\n\t    break;\n\n        case $.verto.enum.state.trying:\n            setTimeout(function() {\n                if (dialog.state == $.verto.enum.state.trying) {\n                    dialog.setState($.verto.enum.state.hangup);\n                }\n            }, 30000);\n            break;\n        case $.verto.enum.state.purge:\n            dialog.setState($.verto.enum.state.destroy);\n            break;\n        case $.verto.enum.state.hangup:\n\n            if (dialog.lastState.val > $.verto.enum.state.requesting.val && dialog.lastState.val < $.verto.enum.state.hangup.val) {\n                dialog.sendMethod(\"verto.bye\", {});\n            }\n\n            dialog.setState($.verto.enum.state.destroy);\n            break;\n        case $.verto.enum.state.destroy:\n\n            if (typeof(dialog.verto.options.tag) === \"function\") {\n              $('#' + dialog.params.tag).remove();\n            }\n\n            delete dialog.verto.dialogs[dialog.callID];\n\t    if (dialog.params.screenShare) {\n\t\tdialog.rtc.stopPeer();\n\t    } else {\n\t\tdialog.rtc.stop();\n\t    }\n            break;\n        }\n\n        return true;\n    };\n\n    $.verto.dialog.prototype.processReply = function(method, success, e) {\n        var dialog = this;\n\n        //console.log(\"Response: \" + method + \" State:\" + dialog.state.name, success, e);\n\n        switch (method) {\n\n        case \"verto.answer\":\n        case \"verto.attach\":\n            if (success) {\n                dialog.setState($.verto.enum.state.active);\n            } else {\n                dialog.hangup();\n            }\n            break;\n        case \"verto.invite\":\n            if (success) {\n                dialog.setState($.verto.enum.state.trying);\n            } else {\n                dialog.setState($.verto.enum.state.destroy);\n            }\n            break;\n\n        case \"verto.bye\":\n            dialog.hangup();\n            break;\n\n        case \"verto.modify\":\n            if (e.holdState) {\n                if (e.holdState == \"held\") {\n                    if (dialog.state != $.verto.enum.state.held) {\n                        dialog.setState($.verto.enum.state.held);\n                    }\n                } else if (e.holdState == \"active\") {\n                    if (dialog.state != $.verto.enum.state.active) {\n                        dialog.setState($.verto.enum.state.active);\n                    }\n                }\n            }\n\n            if (success) {}\n\n            break;\n\n        default:\n            break;\n        }\n\n    };\n\n    $.verto.dialog.prototype.hangup = function(params) {\n        var dialog = this;\n\n        if (params) {\n            if (params.causeCode) {\n\t\tdialog.causeCode = params.causeCode;\n            }\n\n            if (params.cause) {\n\t\tdialog.cause = params.cause;\n            }\n        }\n\n        if (dialog.state.val >= $.verto.enum.state.new.val && dialog.state.val < $.verto.enum.state.hangup.val) {\n            dialog.setState($.verto.enum.state.hangup);\n        } else if (dialog.state.val < $.verto.enum.state.destroy) {\n            dialog.setState($.verto.enum.state.destroy);\n        }\n    };\n\n    $.verto.dialog.prototype.stopRinging = function() {\n        var dialog = this;\n        if (dialog.verto.ringer) {\n            dialog.verto.ringer.stop();\n        }\n    };\n\n    $.verto.dialog.prototype.indicateRing = function() {\n        var dialog = this;\n\n        if (dialog.verto.ringer) {\n            dialog.verto.ringer.attr(\"src\", dialog.verto.options.ringFile)[0].play();\n\n            setTimeout(function() {\n                dialog.stopRinging();\n                if (dialog.state == $.verto.enum.state.ringing) {\n                    dialog.indicateRing();\n                }\n            },\n            dialog.verto.options.ringSleep);\n        }\n    };\n\n    $.verto.dialog.prototype.ring = function() {\n        var dialog = this;\n\n        dialog.setState($.verto.enum.state.ringing);\n        dialog.indicateRing();\n    };\n\n    $.verto.dialog.prototype.useVideo = function(on) {\n        var dialog = this;\n\n        dialog.params.useVideo = on;\n\n        if (on) {\n            dialog.videoStream = dialog.audioStream;\n        } else {\n            dialog.videoStream = null;\n        }\n\n        dialog.rtc.useVideo(dialog.videoStream, dialog.localVideo);\n\n    };\n\n    $.verto.dialog.prototype.setMute = function(what) {\n\tvar dialog = this;\n\treturn dialog.rtc.setMute(what);\n    };\n\n    $.verto.dialog.prototype.getMute = function() {\n\tvar dialog = this; \n\treturn dialog.rtc.getMute();\n    };\n\n    $.verto.dialog.prototype.setVideoMute = function(what) {\n\tvar dialog = this;\n\treturn dialog.rtc.setVideoMute(what);\n    };\n\n    $.verto.dialog.prototype.getVideoMute = function() {\n\tvar dialog = this; \n\treturn dialog.rtc.getVideoMute();\n    };\n\n    $.verto.dialog.prototype.useStereo = function(on) {\n        var dialog = this;\n\n        dialog.params.useStereo = on;\n        dialog.rtc.useStereo(on);\n    };\n\n    $.verto.dialog.prototype.dtmf = function(digits) {\n        var dialog = this;\n        if (digits) {\n            dialog.sendMethod(\"verto.info\", {\n                dtmf: digits\n            });\n        }\n    };\n\n    $.verto.dialog.prototype.transfer = function(dest, params) {\n        var dialog = this;\n        if (dest) {\n            dialog.sendMethod(\"verto.modify\", {\n                action: \"transfer\",\n                destination: dest,\n                params: params\n            });\n        }\n    };\n\n    $.verto.dialog.prototype.hold = function(params) {\n        var dialog = this;\n\n        dialog.sendMethod(\"verto.modify\", {\n            action: \"hold\",\n            params: params\n        });\n    };\n\n    $.verto.dialog.prototype.unhold = function(params) {\n        var dialog = this;\n\n        dialog.sendMethod(\"verto.modify\", {\n            action: \"unhold\",\n            params: params\n        });\n    };\n\n    $.verto.dialog.prototype.toggleHold = function(params) {\n        var dialog = this;\n\n        dialog.sendMethod(\"verto.modify\", {\n            action: \"toggleHold\",\n            params: params\n        });\n    };\n\n    $.verto.dialog.prototype.message = function(msg) {\n        var dialog = this;\n        var err = 0;\n\n        msg.from = dialog.params.login;\n\n        if (!msg.to) {\n            console.error(\"Missing To\");\n            err++;\n        }\n\n        if (!msg.body) {\n            console.error(\"Missing Body\");\n            err++;\n        }\n\n        if (err) {\n            return false;\n        }\n\n        dialog.sendMethod(\"verto.info\", {\n            msg: msg\n        });\n\n        return true;\n    };\n\n    $.verto.dialog.prototype.answer = function(params) {\n        var dialog = this;\n\t\n        if (!dialog.answered) {\n\t    if (!params) {\n\t\tparams = {};\n\t    }\n\n\t    params.sdp = dialog.params.sdp;\n\n            if (params) {\n                if (params.useVideo) {\n                    dialog.useVideo(true);\n                }\n\t\tdialog.params.callee_id_name = params.callee_id_name;\n\t\tdialog.params.callee_id_number = params.callee_id_number;\n\n\t\tif (params.useCamera) {\n\t\t    dialog.useCamera = params.useCamera;\n\t\t}\n\n\t\tif (params.useMic) {\n\t\t    dialog.useMic = params.useMic;\n\t\t}\n\n\t\tif (params.useSpeak) {\n\t\t    dialog.useSpeak = params.useSpeak;\n\t\t}\n            }\n\t    \n            dialog.rtc.createAnswer(params);\n            dialog.answered = true;\n        }\n    };\n\n    $.verto.dialog.prototype.handleAnswer = function(params) {\n        var dialog = this;\n\n        dialog.gotAnswer = true;\n\n        if (dialog.state.val >= $.verto.enum.state.active.val) {\n            return;\n        }\n\n        if (dialog.state.val >= $.verto.enum.state.early.val) {\n            dialog.setState($.verto.enum.state.active);\n        } else {\n            if (dialog.gotEarly) {\n                console.log(\"Dialog \" + dialog.callID + \" Got answer while still establishing early media, delaying...\");\n            } else {\n                console.log(\"Dialog \" + dialog.callID + \" Answering Channel\");\n                dialog.rtc.answer(params.sdp, function() {\n                    dialog.setState($.verto.enum.state.active);\n                }, function(e) {\n                    console.error(e);\n                    dialog.hangup();\n                });\n                console.log(\"Dialog \" + dialog.callID + \"ANSWER SDP\", params.sdp);\n            }\n        }\n\n\n    };\n\n    $.verto.dialog.prototype.cidString = function(enc) {\n        var dialog = this;\n        var party = dialog.params.remote_caller_id_name + (enc ? \" &lt;\" : \" <\") + dialog.params.remote_caller_id_number + (enc ? \"&gt;\" : \">\");\n        return party;\n    };\n\n    $.verto.dialog.prototype.sendMessage = function(msg, params) {\n        var dialog = this;\n\n        if (dialog.callbacks.onMessage) {\n            dialog.callbacks.onMessage(dialog.verto, dialog, msg, params);\n        }\n    };\n\n    $.verto.dialog.prototype.handleInfo = function(params) {\n        var dialog = this;\n\n        dialog.sendMessage($.verto.enum.message.info, params.msg);\n    };\n\n    $.verto.dialog.prototype.handleDisplay = function(params) {\n        var dialog = this;\n\n        if (params.display_name) {\n            dialog.params.remote_caller_id_name = params.display_name;\n        }\n        if (params.display_number) {\n            dialog.params.remote_caller_id_number = params.display_number;\n        }\n\n        dialog.sendMessage($.verto.enum.message.display, {});\n    };\n\n    $.verto.dialog.prototype.handleMedia = function(params) {\n        var dialog = this;\n\n        if (dialog.state.val >= $.verto.enum.state.early.val) {\n            return;\n        }\n\n        dialog.gotEarly = true;\n\n        dialog.rtc.answer(params.sdp, function() {\n            console.log(\"Dialog \" + dialog.callID + \"Establishing early media\");\n            dialog.setState($.verto.enum.state.early);\n\n            if (dialog.gotAnswer) {\n                console.log(\"Dialog \" + dialog.callID + \"Answering Channel\");\n                dialog.setState($.verto.enum.state.active);\n            }\n        }, function(e) {\n            console.error(e);\n            dialog.hangup();\n        });\n        console.log(\"Dialog \" + dialog.callID + \"EARLY SDP\", params.sdp);\n    };\n\n    $.verto.ENUM = function(s) {\n        var i = 0,\n        o = {};\n        s.split(\" \").map(function(x) {\n            o[x] = {\n                name: x,\n                val: i++\n            };\n        });\n        return Object.freeze(o);\n    };\n\n    $.verto.enum = {};\n\n    $.verto.enum.states = Object.freeze({\n        new: {\n            requesting: 1,\n            recovering: 1,\n            ringing: 1,\n            destroy: 1,\n            answering: 1,\n\t    hangup: 1\n        },\n        requesting: {\n            trying: 1,\n            hangup: 1,\n\t    active: 1\n        },\n        recovering: {\n            answering: 1,\n            hangup: 1\n        },\n        trying: {\n            active: 1,\n            early: 1,\n            hangup: 1\n        },\n        ringing: {\n            answering: 1,\n            hangup: 1\n        },\n        answering: {\n            active: 1,\n            hangup: 1\n        },\n        active: {\n            answering: 1,\n            requesting: 1,\n            hangup: 1,\n            held: 1\n        },\n        held: {\n            hangup: 1,\n            active: 1\n        },\n        early: {\n            hangup: 1,\n            active: 1\n        },\n        hangup: {\n            destroy: 1\n        },\n        destroy: {},\n        purge: {\n            destroy: 1\n        }\n    });\n\n    $.verto.enum.state = $.verto.ENUM(\"new requesting trying recovering ringing answering early active held hangup destroy purge\");\n    $.verto.enum.direction = $.verto.ENUM(\"inbound outbound\");\n    $.verto.enum.message = $.verto.ENUM(\"display info pvtEvent\");\n\n    $.verto.enum = Object.freeze($.verto.enum);\n\n    $.verto.saved = [];\n    \n    $.verto.unloadJobs = [];\n\n    $(window).bind('beforeunload', function() {\n\tfor (var f in $.verto.unloadJobs) {\n\t    $.verto.unloadJobs[f]();\n\t}\n\n        for (var i in $.verto.saved) {\n            var verto = $.verto.saved[i];\n            if (verto) {\n                verto.purge();\n                verto.logout();\n            }\n        }\n\n        return $.verto.warnOnUnload;\n    });\n\n    $.verto.videoDevices = [];\n    $.verto.audioInDevices = [];\n    $.verto.audioOutDevices = [];\n\n    var checkDevices = function(runtime) {\n\tconsole.info(\"enumerating devices\");\n\tvar aud_in = [], aud_out = [], vid = [];\t\n\n\tif ((!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) && MediaStreamTrack.getSources) {\n\t    MediaStreamTrack.getSources(function (media_sources) {\n\t\tfor (var i = 0; i < media_sources.length; i++) {\n\n\t\t    if (media_sources[i].kind == 'video') {\n\t\t\tvid.push(media_sources[i]);\n\t\t    } else {\n\t\t\taud_in.push(media_sources[i]);\n\t\t    }\n\t\t}\n\t\t\n\t\t$.verto.videoDevices = vid;\n\t\t$.verto.audioInDevices = aud_in;\n\t\t\n\t\tconsole.info(\"Audio Devices\", $.verto.audioInDevices);\n\t\tconsole.info(\"Video Devices\", $.verto.videoDevices);\n\t\truntime(true);\n\t    });\n\t} else {\n\t    /* of course it's a totally different API CALL with different element names for the same exact thing */\n\t    \n\t    if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n\t\tconsole.log(\"enumerateDevices() not supported.\");\n\t\treturn;\n\t    }\n\n\t    // List cameras and microphones.\n\n\t    navigator.mediaDevices.enumerateDevices()\n\t\t.then(function(devices) {\n\t\t    devices.forEach(function(device) {\n\t\t\tconsole.log(device);\n\n\t\t\tconsole.log(device.kind + \": \" + device.label +\n\t\t\t\t    \" id = \" + device.deviceId);\n\t\t\t\n\t\t\tif (device.kind === \"videoinput\") {\n\t\t\t    vid.push({id: device.deviceId, kind: \"video\", label: device.label});\n\t\t\t} else if (device.kind === \"audioinput\") {\n\t\t\t    aud_in.push({id: device.deviceId, kind: \"audio_in\", label: device.label});\n\t\t\t} else if (device.kind === \"audiooutput\") {\n\t\t\t    aud_out.push({id: device.deviceId, kind: \"audio_out\", label: device.label});\n\t\t\t}\n\t\t    });\n\t\t    \n\n\t\t    $.verto.videoDevices = vid;\n\t\t    $.verto.audioInDevices = aud_in;\n\t\t    $.verto.audioOutDevices = aud_out;\n\t\t    \n\t\t    console.info(\"Audio IN Devices\", $.verto.audioInDevices);\n\t\t    console.info(\"Audio Out Devices\", $.verto.audioOutDevices);\n\t\t    console.info(\"Video Devices\", $.verto.videoDevices);\n\t\t    runtime(true);\n\t\t    \n\t\t})\n\t\t.catch(function(err) {\n\t\t    console.log(\" Device Enumeration ERROR: \" + err.name + \": \" + err.message);\n\t\t    runtime(false);\n\t\t});\n\t}\n\n    };\n\n    $.verto.refreshDevices = function(runtime) {\n\tcheckDevices(runtime);\n    }\n\n    $.verto.init = function(obj, runtime) {\n\tif (!obj) {\n\t    obj = {};\n\t}\n\n\tif (!obj.skipPermCheck && !obj.skipDeviceCheck) {\n\t    $.FSRTC.checkPerms(function(status) {\n\t\tcheckDevices(runtime);\n\t    }, true, true);\n\t} else if (obj.skipPermCheck && !obj.skipDeviceCheck) {\n\t    checkDevices(runtime);\n\t} else if (!obj.skipPermCheck && obj.skipDeviceCheck) {\n\t    $.FSRTC.checkPerms(function(status) {\n\t\truntime(status);\n\t    }, true, true);\n\t} else {\n\t    runtime(null);\n\t}\n\n    }\n\n    $.verto.genUUID = function () {\n\treturn generateGUID();\n    }\n\n\n})(jQuery);\n\n/*! adapterjs - v0.13.3 - 2016-08-03 */\n\n// Adapter's interface.\nvar AdapterJS = AdapterJS || {};\n\n// Browserify compatibility\nif(typeof exports !== 'undefined') {\n  module.exports = AdapterJS;\n}\n\nAdapterJS.options = AdapterJS.options || {};\n\n// uncomment to get virtual webcams\n// AdapterJS.options.getAllCams = true;\n\n// uncomment to prevent the install prompt when the plugin in not yet installed\n// AdapterJS.options.hidePluginInstallPrompt = true;\n\n// AdapterJS version\nAdapterJS.VERSION = '0.13.3';\n\n// This function will be called when the WebRTC API is ready to be used\n// Whether it is the native implementation (Chrome, Firefox, Opera) or\n// the plugin\n// You may Override this function to synchronise the start of your application\n// with the WebRTC API being ready.\n// If you decide not to override use this synchronisation, it may result in\n// an extensive CPU usage on the plugin start (once per tab loaded)\n// Params:\n//    - isUsingPlugin: true is the WebRTC plugin is being used, false otherwise\n//\nAdapterJS.onwebrtcready = AdapterJS.onwebrtcready || function(isUsingPlugin) {\n  // The WebRTC API is ready.\n  // Override me and do whatever you want here\n};\n\n// New interface to store multiple callbacks, private\nAdapterJS._onwebrtcreadies = [];\n\n// Sets a callback function to be called when the WebRTC interface is ready.\n// The first argument is the function to callback.\\\n// Throws an error if the first argument is not a function\nAdapterJS.webRTCReady = function (callback) {\n  if (typeof callback !== 'function') {\n    throw new Error('Callback provided is not a function');\n  }\n\n  if (true === AdapterJS.onwebrtcreadyDone) {\n    // All WebRTC interfaces are ready, just call the callback\n    callback(null !== AdapterJS.WebRTCPlugin.plugin);\n  } else {\n    // will be triggered automatically when your browser/plugin is ready.\n    AdapterJS._onwebrtcreadies.push(callback);\n  }\n};\n\n// Plugin namespace\nAdapterJS.WebRTCPlugin = AdapterJS.WebRTCPlugin || {};\n\n// The object to store plugin information\n/* jshint ignore:start */\nAdapterJS.WebRTCPlugin.pluginInfo = {\n  prefix : 'Tem',\n  plugName : 'TemWebRTCPlugin',\n  pluginId : 'plugin0',\n  type : 'application/x-temwebrtcplugin',\n  onload : '__TemWebRTCReady0',\n  portalLink : 'http://skylink.io/plugin/',\n  downloadLink : null, //set below\n  companyName: 'Temasys'\n};\nif(!!navigator.platform.match(/^Mac/i)) {\n  AdapterJS.WebRTCPlugin.pluginInfo.downloadLink = 'http://bit.ly/1n77hco';\n}\nelse if(!!navigator.platform.match(/^Win/i)) {\n  AdapterJS.WebRTCPlugin.pluginInfo.downloadLink = 'http://bit.ly/1kkS4FN';\n}\n/* jshint ignore:end */\n\nAdapterJS.WebRTCPlugin.TAGS = {\n  NONE  : 'none',\n  AUDIO : 'audio',\n  VIDEO : 'video'\n};\n\n// Unique identifier of each opened page\nAdapterJS.WebRTCPlugin.pageId = Math.random().toString(36).slice(2);\n\n// Use this whenever you want to call the plugin.\nAdapterJS.WebRTCPlugin.plugin = null;\n\n// Set log level for the plugin once it is ready.\n// The different values are\n// This is an asynchronous function that will run when the plugin is ready\nAdapterJS.WebRTCPlugin.setLogLevel = null;\n\n// Defines webrtc's JS interface according to the plugin's implementation.\n// Define plugin Browsers as WebRTC Interface.\nAdapterJS.WebRTCPlugin.defineWebRTCInterface = null;\n\n// This function detects whether or not a plugin is installed.\n// Checks if Not IE (firefox, for example), else if it's IE,\n// we're running IE and do something. If not it is not supported.\nAdapterJS.WebRTCPlugin.isPluginInstalled = null;\n\n // Lets adapter.js wait until the the document is ready before injecting the plugin\nAdapterJS.WebRTCPlugin.pluginInjectionInterval = null;\n\n// Inject the HTML DOM object element into the page.\nAdapterJS.WebRTCPlugin.injectPlugin = null;\n\n// States of readiness that the plugin goes through when\n// being injected and stated\nAdapterJS.WebRTCPlugin.PLUGIN_STATES = {\n  NONE : 0,           // no plugin use\n  INITIALIZING : 1,   // Detected need for plugin\n  INJECTING : 2,      // Injecting plugin\n  INJECTED: 3,        // Plugin element injected but not usable yet\n  READY: 4            // Plugin ready to be used\n};\n\n// Current state of the plugin. You cannot use the plugin before this is\n// equal to AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY\nAdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.NONE;\n\n// True is AdapterJS.onwebrtcready was already called, false otherwise\n// Used to make sure AdapterJS.onwebrtcready is only called once\nAdapterJS.onwebrtcreadyDone = false;\n\n// Log levels for the plugin.\n// To be set by calling AdapterJS.WebRTCPlugin.setLogLevel\n/*\nLog outputs are prefixed in some cases.\n  INFO: Information reported by the plugin.\n  ERROR: Errors originating from within the plugin.\n  WEBRTC: Error originating from within the libWebRTC library\n*/\n// From the least verbose to the most verbose\nAdapterJS.WebRTCPlugin.PLUGIN_LOG_LEVELS = {\n  NONE : 'NONE',\n  ERROR : 'ERROR',\n  WARNING : 'WARNING',\n  INFO: 'INFO',\n  VERBOSE: 'VERBOSE',\n  SENSITIVE: 'SENSITIVE'\n};\n\n// Does a waiting check before proceeding to load the plugin.\nAdapterJS.WebRTCPlugin.WaitForPluginReady = null;\n\n// This methid will use an interval to wait for the plugin to be ready.\nAdapterJS.WebRTCPlugin.callWhenPluginReady = null;\n\n// !!!! WARNING: DO NOT OVERRIDE THIS FUNCTION. !!!\n// This function will be called when plugin is ready. It sends necessary\n// details to the plugin.\n// The function will wait for the document to be ready and the set the\n// plugin state to AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY,\n// indicating that it can start being requested.\n// This function is not in the IE/Safari condition brackets so that\n// TemPluginLoaded function might be called on Chrome/Firefox.\n// This function is the only private function that is not encapsulated to\n// allow the plugin method to be called.\n__TemWebRTCReady0 = function () {\n  if (document.readyState === 'complete') {\n    AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY;\n    AdapterJS.maybeThroughWebRTCReady();\n  } else {\n    var timer = setInterval(function () {\n      if (document.readyState === 'complete') {\n        // TODO: update comments, we wait for the document to be ready\n        clearInterval(timer);\n        AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY;\n        AdapterJS.maybeThroughWebRTCReady();\n      }\n    }, 100);\n  }\n};\n\nAdapterJS.maybeThroughWebRTCReady = function() {\n  if (!AdapterJS.onwebrtcreadyDone) {\n    AdapterJS.onwebrtcreadyDone = true;\n\n    // If new interface for multiple callbacks used\n    if (AdapterJS._onwebrtcreadies.length) {\n      AdapterJS._onwebrtcreadies.forEach(function (callback) {\n        if (typeof(callback) === 'function') {\n          callback(AdapterJS.WebRTCPlugin.plugin !== null);\n        }\n      });\n    // Else if no callbacks on new interface assuming user used old(deprecated) way to set callback through AdapterJS.onwebrtcready = ...\n    } else if (typeof(AdapterJS.onwebrtcready) === 'function') {\n      AdapterJS.onwebrtcready(AdapterJS.WebRTCPlugin.plugin !== null);\n    }\n  }\n};\n\n// Text namespace\nAdapterJS.TEXT = {\n  PLUGIN: {\n    REQUIRE_INSTALLATION: 'This website requires you to install a WebRTC-enabling plugin ' +\n      'to work on this browser.',\n    NOT_SUPPORTED: 'Your browser does not support WebRTC.',\n    BUTTON: 'Install Now'\n  },\n  REFRESH: {\n    REQUIRE_REFRESH: 'Please refresh page',\n    BUTTON: 'Refresh Page'\n  }\n};\n\n// The result of ice connection states.\n// - starting: Ice connection is starting.\n// - checking: Ice connection is checking.\n// - connected Ice connection is connected.\n// - completed Ice connection is connected.\n// - done Ice connection has been completed.\n// - disconnected Ice connection has been disconnected.\n// - failed Ice connection has failed.\n// - closed Ice connection is closed.\nAdapterJS._iceConnectionStates = {\n  starting : 'starting',\n  checking : 'checking',\n  connected : 'connected',\n  completed : 'connected',\n  done : 'completed',\n  disconnected : 'disconnected',\n  failed : 'failed',\n  closed : 'closed'\n};\n\n//The IceConnection states that has been fired for each peer.\nAdapterJS._iceConnectionFiredStates = [];\n\n\n// Check if WebRTC Interface is defined.\nAdapterJS.isDefined = null;\n\n// This function helps to retrieve the webrtc detected browser information.\n// This sets:\n// - webrtcDetectedBrowser: The browser agent name.\n// - webrtcDetectedVersion: The browser version.\n// - webrtcMinimumVersion: The minimum browser version still supported by AJS.\n// - webrtcDetectedType: The types of webRTC support.\n//   - 'moz': Mozilla implementation of webRTC.\n//   - 'webkit': WebKit implementation of webRTC.\n//   - 'plugin': Using the plugin implementation.\nAdapterJS.parseWebrtcDetectedBrowser = function () {\n  var hasMatch = null;\n  if ((!!window.opr && !!opr.addons) || \n    !!window.opera || \n    navigator.userAgent.indexOf(' OPR/') >= 0) {\n    // Opera 8.0+\n    webrtcDetectedBrowser = 'opera';\n    webrtcDetectedType    = 'webkit';\n    webrtcMinimumVersion  = 26;\n    hasMatch = /OPR\\/(\\d+)/i.exec(navigator.userAgent) || [];\n    webrtcDetectedVersion = parseInt(hasMatch[1], 10);\n  } else if (typeof InstallTrigger !== 'undefined') {\n    // Firefox 1.0+\n    // Bowser and Version set in Google's adapter\n    webrtcDetectedType    = 'moz';\n  } else if (Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0) {\n    // Safari\n    webrtcDetectedBrowser = 'safari';\n    webrtcDetectedType    = 'plugin';\n    webrtcMinimumVersion  = 7;\n    hasMatch = /version\\/(\\d+)/i.exec(navigator.userAgent) || [];\n    webrtcDetectedVersion = parseInt(hasMatch[1], 10);\n  } else if (/*@cc_on!@*/false || !!document.documentMode) {\n    // Internet Explorer 6-11\n    webrtcDetectedBrowser = 'IE';\n    webrtcDetectedType    = 'plugin';\n    webrtcMinimumVersion  = 9;\n    hasMatch = /\\brv[ :]+(\\d+)/g.exec(navigator.userAgent) || [];\n    webrtcDetectedVersion = parseInt(hasMatch[1] || '0', 10);\n    if (!webrtcDetectedVersion) {\n      hasMatch = /\\bMSIE[ :]+(\\d+)/g.exec(navigator.userAgent) || [];\n      webrtcDetectedVersion = parseInt(hasMatch[1] || '0', 10);      \n    }\n  } else if (!!window.StyleMedia) {\n    // Edge 20+\n    // Bowser and Version set in Google's adapter\n    webrtcDetectedType    = '';\n  } else if (!!window.chrome && !!window.chrome.webstore) {\n    // Chrome 1+\n    // Bowser and Version set in Google's adapter\n    webrtcDetectedType    = 'webkit';\n  } else if ((webrtcDetectedBrowser === 'chrome'|| webrtcDetectedBrowser === 'opera') && \n    !!window.CSS) {\n    // Blink engine detection\n    webrtcDetectedBrowser = 'blink';\n    // TODO: detected WebRTC version\n  }\n\n  window.webrtcDetectedBrowser = webrtcDetectedBrowser;\n  window.webrtcDetectedVersion = webrtcDetectedVersion;\n  window.webrtcMinimumVersion  = webrtcMinimumVersion;\n};\n\nAdapterJS.addEvent = function(elem, evnt, func) {\n  if (elem.addEventListener) { // W3C DOM\n    elem.addEventListener(evnt, func, false);\n  } else if (elem.attachEvent) {// OLD IE DOM\n    elem.attachEvent('on'+evnt, func);\n  } else { // No much to do\n    elem[evnt] = func;\n  }\n};\n\nAdapterJS.renderNotificationBar = function (text, buttonText, buttonLink, openNewTab, displayRefreshBar) {\n  // only inject once the page is ready\n  if (document.readyState !== 'complete') {\n    return;\n  }\n\n  var w = window;\n  var i = document.createElement('iframe');\n  i.name = 'adapterjs-alert';\n  i.style.position = 'fixed';\n  i.style.top = '-41px';\n  i.style.left = 0;\n  i.style.right = 0;\n  i.style.width = '100%';\n  i.style.height = '40px';\n  i.style.backgroundColor = '#ffffe1';\n  i.style.border = 'none';\n  i.style.borderBottom = '1px solid #888888';\n  i.style.zIndex = '9999999';\n  if(typeof i.style.webkitTransition === 'string') {\n    i.style.webkitTransition = 'all .5s ease-out';\n  } else if(typeof i.style.transition === 'string') {\n    i.style.transition = 'all .5s ease-out';\n  }\n  document.body.appendChild(i);\n  var c = (i.contentWindow) ? i.contentWindow :\n    (i.contentDocument.document) ? i.contentDocument.document : i.contentDocument;\n  c.document.open();\n  c.document.write('<span style=\"display: inline-block; font-family: Helvetica, Arial,' +\n    'sans-serif; font-size: .9rem; padding: 4px; vertical-align: ' +\n    'middle; cursor: default;\">' + text + '</span>');\n  if(buttonText && buttonLink) {\n    c.document.write('<button id=\"okay\">' + buttonText + '</button><button id=\"cancel\">Cancel</button>');\n    c.document.close();\n\n    // On click on okay\n    AdapterJS.addEvent(c.document.getElementById('okay'), 'click', function(e) {\n      if (!!displayRefreshBar) {\n        AdapterJS.renderNotificationBar(AdapterJS.TEXT.EXTENSION ?\n          AdapterJS.TEXT.EXTENSION.REQUIRE_REFRESH : AdapterJS.TEXT.REFRESH.REQUIRE_REFRESH,\n          AdapterJS.TEXT.REFRESH.BUTTON, 'javascript:location.reload()'); // jshint ignore:line\n      }\n      window.open(buttonLink, !!openNewTab ? '_blank' : '_top');\n\n      e.preventDefault();\n      try {\n        e.cancelBubble = true;\n      } catch(error) { }\n\n      var pluginInstallInterval = setInterval(function(){\n        if(! isIE) {\n          navigator.plugins.refresh(false);\n        }\n        AdapterJS.WebRTCPlugin.isPluginInstalled(\n          AdapterJS.WebRTCPlugin.pluginInfo.prefix,\n          AdapterJS.WebRTCPlugin.pluginInfo.plugName,\n          function() { // plugin now installed\n            clearInterval(pluginInstallInterval);\n            AdapterJS.WebRTCPlugin.defineWebRTCInterface();\n          },\n          function() {\n            // still no plugin detected, nothing to do\n          });\n      } , 500);\n    });\n\n    // On click on Cancel\n    AdapterJS.addEvent(c.document.getElementById('cancel'), 'click', function(e) {\n      w.document.body.removeChild(i);\n    });\n  } else {\n    c.document.close();\n  }\n  setTimeout(function() {\n    if(typeof i.style.webkitTransform === 'string') {\n      i.style.webkitTransform = 'translateY(40px)';\n    } else if(typeof i.style.transform === 'string') {\n      i.style.transform = 'translateY(40px)';\n    } else {\n      i.style.top = '0px';\n    }\n  }, 300);\n};\n\n// -----------------------------------------------------------\n// Detected webrtc implementation. Types are:\n// - 'moz': Mozilla implementation of webRTC.\n// - 'webkit': WebKit implementation of webRTC.\n// - 'plugin': Using the plugin implementation.\nwebrtcDetectedType = null;\n\n// Set the settings for creating DataChannels, MediaStream for\n// Cross-browser compability.\n// - This is only for SCTP based support browsers.\n// the 'urls' attribute.\ncheckMediaDataChannelSettings =\n  function (peerBrowserAgent, peerBrowserVersion, callback, constraints) {\n  if (typeof callback !== 'function') {\n    return;\n  }\n  var beOfferer = true;\n  var isLocalFirefox = webrtcDetectedBrowser === 'firefox';\n  // Nightly version does not require MozDontOfferDataChannel for interop\n  var isLocalFirefoxInterop = webrtcDetectedType === 'moz' && webrtcDetectedVersion > 30;\n  var isPeerFirefox = peerBrowserAgent === 'firefox';\n  var isPeerFirefoxInterop = peerBrowserAgent === 'firefox' &&\n    ((peerBrowserVersion) ? (peerBrowserVersion > 30) : false);\n\n  // Resends an updated version of constraints for MozDataChannel to work\n  // If other userAgent is firefox and user is firefox, remove MozDataChannel\n  if ((isLocalFirefox && isPeerFirefox) || (isLocalFirefoxInterop)) {\n    try {\n      delete constraints.mandatory.MozDontOfferDataChannel;\n    } catch (error) {\n      console.error('Failed deleting MozDontOfferDataChannel');\n      console.error(error);\n    }\n  } else if ((isLocalFirefox && !isPeerFirefox)) {\n    constraints.mandatory.MozDontOfferDataChannel = true;\n  }\n  if (!isLocalFirefox) {\n    // temporary measure to remove Moz* constraints in non Firefox browsers\n    for (var prop in constraints.mandatory) {\n      if (constraints.mandatory.hasOwnProperty(prop)) {\n        if (prop.indexOf('Moz') !== -1) {\n          delete constraints.mandatory[prop];\n        }\n      }\n    }\n  }\n  // Firefox (not interopable) cannot offer DataChannel as it will cause problems to the\n  // interopability of the media stream\n  if (isLocalFirefox && !isPeerFirefox && !isLocalFirefoxInterop) {\n    beOfferer = false;\n  }\n  callback(beOfferer, constraints);\n};\n\n// Handles the differences for all browsers ice connection state output.\n// - Tested outcomes are:\n//   - Chrome (offerer)  : 'checking' > 'completed' > 'completed'\n//   - Chrome (answerer) : 'checking' > 'connected'\n//   - Firefox (offerer) : 'checking' > 'connected'\n//   - Firefox (answerer): 'checking' > 'connected'\ncheckIceConnectionState = function (peerId, iceConnectionState, callback) {\n  if (typeof callback !== 'function') {\n    console.warn('No callback specified in checkIceConnectionState. Aborted.');\n    return;\n  }\n  peerId = (peerId) ? peerId : 'peer';\n\n  if (!AdapterJS._iceConnectionFiredStates[peerId] ||\n    iceConnectionState === AdapterJS._iceConnectionStates.disconnected ||\n    iceConnectionState === AdapterJS._iceConnectionStates.failed ||\n    iceConnectionState === AdapterJS._iceConnectionStates.closed) {\n    AdapterJS._iceConnectionFiredStates[peerId] = [];\n  }\n  iceConnectionState = AdapterJS._iceConnectionStates[iceConnectionState];\n  if (AdapterJS._iceConnectionFiredStates[peerId].indexOf(iceConnectionState) < 0) {\n    AdapterJS._iceConnectionFiredStates[peerId].push(iceConnectionState);\n    if (iceConnectionState === AdapterJS._iceConnectionStates.connected) {\n      setTimeout(function () {\n        AdapterJS._iceConnectionFiredStates[peerId]\n          .push(AdapterJS._iceConnectionStates.done);\n        callback(AdapterJS._iceConnectionStates.done);\n      }, 1000);\n    }\n    callback(iceConnectionState);\n  }\n  return;\n};\n\n// Firefox:\n// - Creates iceServer from the url for Firefox.\n// - Create iceServer with stun url.\n// - Create iceServer with turn url.\n//   - Ignore the transport parameter from TURN url for FF version <=27.\n//   - Return null for createIceServer if transport=tcp.\n// - FF 27 and above supports transport parameters in TURN url,\n// - So passing in the full url to create iceServer.\n// Chrome:\n// - Creates iceServer from the url for Chrome M33 and earlier.\n//   - Create iceServer with stun url.\n//   - Chrome M28 & above uses below TURN format.\n// Plugin:\n// - Creates Ice Server for Plugin Browsers\n//   - If Stun - Create iceServer with stun url.\n//   - Else - Create iceServer with turn url\n//   - This is a WebRTC Function\ncreateIceServer = null;\n\n// Firefox:\n// - Creates IceServers for Firefox\n//   - Use .url for FireFox.\n//   - Multiple Urls support\n// Chrome:\n// - Creates iceServers from the urls for Chrome M34 and above.\n//   - .urls is supported since Chrome M34.\n//   - Multiple Urls support\n// Plugin:\n// - Creates Ice Servers for Plugin Browsers\n//   - Multiple Urls support\n//   - This is a WebRTC Function\ncreateIceServers = null;\n//------------------------------------------------------------\n\n//The RTCPeerConnection object.\nRTCPeerConnection = null;\n\n// Creates RTCSessionDescription object for Plugin Browsers\nRTCSessionDescription = (typeof RTCSessionDescription === 'function') ?\n  RTCSessionDescription : null;\n\n// Creates RTCIceCandidate object for Plugin Browsers\nRTCIceCandidate = (typeof RTCIceCandidate === 'function') ?\n  RTCIceCandidate : null;\n\n// Get UserMedia (only difference is the prefix).\n// Code from Adam Barth.\ngetUserMedia = null;\n\n// Attach a media stream to an element.\nattachMediaStream = null;\n\n// Re-attach a media stream to an element.\nreattachMediaStream = null;\n\n\n// Detected browser agent name. Types are:\n// - 'firefox': Firefox browser.\n// - 'chrome': Chrome browser.\n// - 'opera': Opera browser.\n// - 'safari': Safari browser.\n// - 'IE' - Internet Explorer browser.\nwebrtcDetectedBrowser = null;\n\n// Detected browser version.\nwebrtcDetectedVersion = null;\n\n// The minimum browser version still supported by AJS.\nwebrtcMinimumVersion  = null;\n\n// Check for browser types and react accordingly\nif ( navigator.mozGetUserMedia || \n  navigator.webkitGetUserMedia || \n  (navigator.mediaDevices && \n    navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) ) { \n\n  ///////////////////////////////////////////////////////////////////\n  // INJECTION OF GOOGLE'S ADAPTER.JS CONTENT\n\n/* jshint ignore:start */\n  (function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n   /* eslint-env node */\n  'use strict';\n  \n  // SDP helpers.\n  var SDPUtils = {};\n  \n  // Generate an alphanumeric identifier for cname or mids.\n  // TODO: use UUIDs instead? https://gist.github.com/jed/982883\n  SDPUtils.generateIdentifier = function() {\n    return Math.random().toString(36).substr(2, 10);\n  };\n  \n  // The RTCP CNAME used by all peerconnections from the same JS.\n  SDPUtils.localCName = SDPUtils.generateIdentifier();\n  \n  // Splits SDP into lines, dealing with both CRLF and LF.\n  SDPUtils.splitLines = function(blob) {\n    return blob.trim().split('\\n').map(function(line) {\n      return line.trim();\n    });\n  };\n  // Splits SDP into sessionpart and mediasections. Ensures CRLF.\n  SDPUtils.splitSections = function(blob) {\n    var parts = blob.split('\\nm=');\n    return parts.map(function(part, index) {\n      return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n    });\n  };\n  \n  // Returns lines that start with a certain prefix.\n  SDPUtils.matchPrefix = function(blob, prefix) {\n    return SDPUtils.splitLines(blob).filter(function(line) {\n      return line.indexOf(prefix) === 0;\n    });\n  };\n  \n  // Parses an ICE candidate line. Sample input:\n  // candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n  // rport 55996\"\n  SDPUtils.parseCandidate = function(line) {\n    var parts;\n    // Parse both variants.\n    if (line.indexOf('a=candidate:') === 0) {\n      parts = line.substring(12).split(' ');\n    } else {\n      parts = line.substring(10).split(' ');\n    }\n  \n    var candidate = {\n      foundation: parts[0],\n      component: parts[1],\n      protocol: parts[2].toLowerCase(),\n      priority: parseInt(parts[3], 10),\n      ip: parts[4],\n      port: parseInt(parts[5], 10),\n      // skip parts[6] == 'typ'\n      type: parts[7]\n    };\n  \n    for (var i = 8; i < parts.length; i += 2) {\n      switch (parts[i]) {\n        case 'raddr':\n          candidate.relatedAddress = parts[i + 1];\n          break;\n        case 'rport':\n          candidate.relatedPort = parseInt(parts[i + 1], 10);\n          break;\n        case 'tcptype':\n          candidate.tcpType = parts[i + 1];\n          break;\n        default: // Unknown extensions are silently ignored.\n          break;\n      }\n    }\n    return candidate;\n  };\n  \n  // Translates a candidate object into SDP candidate attribute.\n  SDPUtils.writeCandidate = function(candidate) {\n    var sdp = [];\n    sdp.push(candidate.foundation);\n    sdp.push(candidate.component);\n    sdp.push(candidate.protocol.toUpperCase());\n    sdp.push(candidate.priority);\n    sdp.push(candidate.ip);\n    sdp.push(candidate.port);\n  \n    var type = candidate.type;\n    sdp.push('typ');\n    sdp.push(type);\n    if (type !== 'host' && candidate.relatedAddress &&\n        candidate.relatedPort) {\n      sdp.push('raddr');\n      sdp.push(candidate.relatedAddress); // was: relAddr\n      sdp.push('rport');\n      sdp.push(candidate.relatedPort); // was: relPort\n    }\n    if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n      sdp.push('tcptype');\n      sdp.push(candidate.tcpType);\n    }\n    return 'candidate:' + sdp.join(' ');\n  };\n  \n  // Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n  // a=rtpmap:111 opus/48000/2\n  SDPUtils.parseRtpMap = function(line) {\n    var parts = line.substr(9).split(' ');\n    var parsed = {\n      payloadType: parseInt(parts.shift(), 10) // was: id\n    };\n  \n    parts = parts[0].split('/');\n  \n    parsed.name = parts[0];\n    parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n    // was: channels\n    parsed.numChannels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n    return parsed;\n  };\n  \n  // Generate an a=rtpmap line from RTCRtpCodecCapability or\n  // RTCRtpCodecParameters.\n  SDPUtils.writeRtpMap = function(codec) {\n    var pt = codec.payloadType;\n    if (codec.preferredPayloadType !== undefined) {\n      pt = codec.preferredPayloadType;\n    }\n    return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n        (codec.numChannels !== 1 ? '/' + codec.numChannels : '') + '\\r\\n';\n  };\n  \n  // Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n  // a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n  SDPUtils.parseExtmap = function(line) {\n    var parts = line.substr(9).split(' ');\n    return {\n      id: parseInt(parts[0], 10),\n      uri: parts[1]\n    };\n  };\n  \n  // Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n  // RTCRtpHeaderExtension.\n  SDPUtils.writeExtmap = function(headerExtension) {\n    return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n         ' ' + headerExtension.uri + '\\r\\n';\n  };\n  \n  // Parses an ftmp line, returns dictionary. Sample input:\n  // a=fmtp:96 vbr=on;cng=on\n  // Also deals with vbr=on; cng=on\n  SDPUtils.parseFmtp = function(line) {\n    var parsed = {};\n    var kv;\n    var parts = line.substr(line.indexOf(' ') + 1).split(';');\n    for (var j = 0; j < parts.length; j++) {\n      kv = parts[j].trim().split('=');\n      parsed[kv[0].trim()] = kv[1];\n    }\n    return parsed;\n  };\n  \n  // Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\n  SDPUtils.writeFmtp = function(codec) {\n    var line = '';\n    var pt = codec.payloadType;\n    if (codec.preferredPayloadType !== undefined) {\n      pt = codec.preferredPayloadType;\n    }\n    if (codec.parameters && Object.keys(codec.parameters).length) {\n      var params = [];\n      Object.keys(codec.parameters).forEach(function(param) {\n        params.push(param + '=' + codec.parameters[param]);\n      });\n      line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n    }\n    return line;\n  };\n  \n  // Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n  // a=rtcp-fb:98 nack rpsi\n  SDPUtils.parseRtcpFb = function(line) {\n    var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n    return {\n      type: parts.shift(),\n      parameter: parts.join(' ')\n    };\n  };\n  // Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\n  SDPUtils.writeRtcpFb = function(codec) {\n    var lines = '';\n    var pt = codec.payloadType;\n    if (codec.preferredPayloadType !== undefined) {\n      pt = codec.preferredPayloadType;\n    }\n    if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n      // FIXME: special handling for trr-int?\n      codec.rtcpFeedback.forEach(function(fb) {\n        lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n        (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n            '\\r\\n';\n      });\n    }\n    return lines;\n  };\n  \n  // Parses an RFC 5576 ssrc media attribute. Sample input:\n  // a=ssrc:3735928559 cname:something\n  SDPUtils.parseSsrcMedia = function(line) {\n    var sp = line.indexOf(' ');\n    var parts = {\n      ssrc: parseInt(line.substr(7, sp - 7), 10)\n    };\n    var colon = line.indexOf(':', sp);\n    if (colon > -1) {\n      parts.attribute = line.substr(sp + 1, colon - sp - 1);\n      parts.value = line.substr(colon + 1);\n    } else {\n      parts.attribute = line.substr(sp + 1);\n    }\n    return parts;\n  };\n  \n  // Extracts DTLS parameters from SDP media section or sessionpart.\n  // FIXME: for consistency with other functions this should only\n  //   get the fingerprint line as input. See also getIceParameters.\n  SDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n    var lines = SDPUtils.splitLines(mediaSection);\n    // Search in session part, too.\n    lines = lines.concat(SDPUtils.splitLines(sessionpart));\n    var fpLine = lines.filter(function(line) {\n      return line.indexOf('a=fingerprint:') === 0;\n    })[0].substr(14);\n    // Note: a=setup line is ignored since we use the 'auto' role.\n    var dtlsParameters = {\n      role: 'auto',\n      fingerprints: [{\n        algorithm: fpLine.split(' ')[0],\n        value: fpLine.split(' ')[1]\n      }]\n    };\n    return dtlsParameters;\n  };\n  \n  // Serializes DTLS parameters to SDP.\n  SDPUtils.writeDtlsParameters = function(params, setupType) {\n    var sdp = 'a=setup:' + setupType + '\\r\\n';\n    params.fingerprints.forEach(function(fp) {\n      sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n    });\n    return sdp;\n  };\n  // Parses ICE information from SDP media section or sessionpart.\n  // FIXME: for consistency with other functions this should only\n  //   get the ice-ufrag and ice-pwd lines as input.\n  SDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n    var lines = SDPUtils.splitLines(mediaSection);\n    // Search in session part, too.\n    lines = lines.concat(SDPUtils.splitLines(sessionpart));\n    var iceParameters = {\n      usernameFragment: lines.filter(function(line) {\n        return line.indexOf('a=ice-ufrag:') === 0;\n      })[0].substr(12),\n      password: lines.filter(function(line) {\n        return line.indexOf('a=ice-pwd:') === 0;\n      })[0].substr(10)\n    };\n    return iceParameters;\n  };\n  \n  // Serializes ICE parameters to SDP.\n  SDPUtils.writeIceParameters = function(params) {\n    return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n        'a=ice-pwd:' + params.password + '\\r\\n';\n  };\n  \n  // Parses the SDP media section and returns RTCRtpParameters.\n  SDPUtils.parseRtpParameters = function(mediaSection) {\n    var description = {\n      codecs: [],\n      headerExtensions: [],\n      fecMechanisms: [],\n      rtcp: []\n    };\n    var lines = SDPUtils.splitLines(mediaSection);\n    var mline = lines[0].split(' ');\n    for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n      var pt = mline[i];\n      var rtpmapline = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n      if (rtpmapline) {\n        var codec = SDPUtils.parseRtpMap(rtpmapline);\n        var fmtps = SDPUtils.matchPrefix(\n            mediaSection, 'a=fmtp:' + pt + ' ');\n        // Only the first a=fmtp:<pt> is considered.\n        codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n        codec.rtcpFeedback = SDPUtils.matchPrefix(\n            mediaSection, 'a=rtcp-fb:' + pt + ' ')\n          .map(SDPUtils.parseRtcpFb);\n        description.codecs.push(codec);\n        // parse FEC mechanisms from rtpmap lines.\n        switch (codec.name.toUpperCase()) {\n          case 'RED':\n          case 'ULPFEC':\n            description.fecMechanisms.push(codec.name.toUpperCase());\n            break;\n          default: // only RED and ULPFEC are recognized as FEC mechanisms.\n            break;\n        }\n      }\n    }\n    SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n      description.headerExtensions.push(SDPUtils.parseExtmap(line));\n    });\n    // FIXME: parse rtcp.\n    return description;\n  };\n  \n  // Generates parts of the SDP media section describing the capabilities /\n  // parameters.\n  SDPUtils.writeRtpDescription = function(kind, caps) {\n    var sdp = '';\n  \n    // Build the mline.\n    sdp += 'm=' + kind + ' ';\n    sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n    sdp += ' UDP/TLS/RTP/SAVPF ';\n    sdp += caps.codecs.map(function(codec) {\n      if (codec.preferredPayloadType !== undefined) {\n        return codec.preferredPayloadType;\n      }\n      return codec.payloadType;\n    }).join(' ') + '\\r\\n';\n  \n    sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n    sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n  \n    // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n    caps.codecs.forEach(function(codec) {\n      sdp += SDPUtils.writeRtpMap(codec);\n      sdp += SDPUtils.writeFmtp(codec);\n      sdp += SDPUtils.writeRtcpFb(codec);\n    });\n    // FIXME: add headerExtensions, fecMechanism and rtcp.\n    sdp += 'a=rtcp-mux\\r\\n';\n    return sdp;\n  };\n  \n  // Parses the SDP media section and returns an array of\n  // RTCRtpEncodingParameters.\n  SDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n    var encodingParameters = [];\n    var description = SDPUtils.parseRtpParameters(mediaSection);\n    var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n    var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n  \n    // filter a=ssrc:... cname:, ignore PlanB-msid\n    var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(parts) {\n      return parts.attribute === 'cname';\n    });\n    var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n    var secondarySsrc;\n  \n    var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(function(line) {\n      var parts = line.split(' ');\n      parts.shift();\n      return parts.map(function(part) {\n        return parseInt(part, 10);\n      });\n    });\n    if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n      secondarySsrc = flows[0][1];\n    }\n  \n    description.codecs.forEach(function(codec) {\n      if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n        var encParam = {\n          ssrc: primarySsrc,\n          codecPayloadType: parseInt(codec.parameters.apt, 10),\n          rtx: {\n            payloadType: codec.payloadType,\n            ssrc: secondarySsrc\n          }\n        };\n        encodingParameters.push(encParam);\n        if (hasRed) {\n          encParam = JSON.parse(JSON.stringify(encParam));\n          encParam.fec = {\n            ssrc: secondarySsrc,\n            mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n          };\n          encodingParameters.push(encParam);\n        }\n      }\n    });\n    if (encodingParameters.length === 0 && primarySsrc) {\n      encodingParameters.push({\n        ssrc: primarySsrc\n      });\n    }\n  \n    // we support both b=AS and b=TIAS but interpret AS as TIAS.\n    var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n    if (bandwidth.length) {\n      if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n        bandwidth = parseInt(bandwidth[0].substr(7), 10);\n      } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n        bandwidth = parseInt(bandwidth[0].substr(5), 10);\n      }\n      encodingParameters.forEach(function(params) {\n        params.maxBitrate = bandwidth;\n      });\n    }\n    return encodingParameters;\n  };\n  \n  SDPUtils.writeSessionBoilerplate = function() {\n    // FIXME: sess-id should be an NTP timestamp.\n    return 'v=0\\r\\n' +\n        'o=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\\r\\n' +\n        's=-\\r\\n' +\n        't=0 0\\r\\n';\n  };\n  \n  SDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n    var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n  \n    // Map ICE parameters (ufrag, pwd) to SDP.\n    sdp += SDPUtils.writeIceParameters(\n        transceiver.iceGatherer.getLocalParameters());\n  \n    // Map DTLS parameters to SDP.\n    sdp += SDPUtils.writeDtlsParameters(\n        transceiver.dtlsTransport.getLocalParameters(),\n        type === 'offer' ? 'actpass' : 'active');\n  \n    sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n  \n    if (transceiver.rtpSender && transceiver.rtpReceiver) {\n      sdp += 'a=sendrecv\\r\\n';\n    } else if (transceiver.rtpSender) {\n      sdp += 'a=sendonly\\r\\n';\n    } else if (transceiver.rtpReceiver) {\n      sdp += 'a=recvonly\\r\\n';\n    } else {\n      sdp += 'a=inactive\\r\\n';\n    }\n  \n    // FIXME: for RTX there might be multiple SSRCs. Not implemented in Edge yet.\n    if (transceiver.rtpSender) {\n      var msid = 'msid:' + stream.id + ' ' +\n          transceiver.rtpSender.track.id + '\\r\\n';\n      sdp += 'a=' + msid;\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n          ' ' + msid;\n    }\n    // FIXME: this should be written by writeRtpDescription.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n    return sdp;\n  };\n  \n  // Gets the direction from the mediaSection or the sessionpart.\n  SDPUtils.getDirection = function(mediaSection, sessionpart) {\n    // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n    var lines = SDPUtils.splitLines(mediaSection);\n    for (var i = 0; i < lines.length; i++) {\n      switch (lines[i]) {\n        case 'a=sendrecv':\n        case 'a=sendonly':\n        case 'a=recvonly':\n        case 'a=inactive':\n          return lines[i].substr(2);\n        default:\n          // FIXME: What should happen here?\n      }\n    }\n    if (sessionpart) {\n      return SDPUtils.getDirection(sessionpart);\n    }\n    return 'sendrecv';\n  };\n  \n  // Expose public methods.\n  module.exports = SDPUtils;\n  \n  },{}],2:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n   /* eslint-env node */\n  \n  'use strict';\n  \n  // Shimming starts here.\n  (function() {\n    // Utils.\n    var logging = require('./utils').log;\n    var browserDetails = require('./utils').browserDetails;\n    // Export to the adapter global object visible in the browser.\n    module.exports.browserDetails = browserDetails;\n    module.exports.extractVersion = require('./utils').extractVersion;\n    module.exports.disableLog = require('./utils').disableLog;\n  \n    // Uncomment the line below if you want logging to occur, including logging\n    // for the switch statement below. Can also be turned on in the browser via\n    // adapter.disableLog(false), but then logging from the switch statement below\n    // will not appear.\n    // require('./utils').disableLog(false);\n  \n    // Browser shims.\n    var chromeShim = require('./chrome/chrome_shim') || null;\n    var edgeShim = require('./edge/edge_shim') || null;\n    var firefoxShim = require('./firefox/firefox_shim') || null;\n    var safariShim = require('./safari/safari_shim') || null;\n  \n    // Shim browser if found.\n    switch (browserDetails.browser) {\n      case 'opera': // fallthrough as it uses chrome shims\n      case 'chrome':\n        if (!chromeShim || !chromeShim.shimPeerConnection) {\n          logging('Chrome shim is not included in this adapter release.');\n          return;\n        }\n        logging('adapter.js shimming chrome.');\n        // Export to the adapter global object visible in the browser.\n        module.exports.browserShim = chromeShim;\n  \n        chromeShim.shimGetUserMedia();\n        chromeShim.shimMediaStream();\n        chromeShim.shimSourceObject();\n        chromeShim.shimPeerConnection();\n        chromeShim.shimOnTrack();\n        break;\n      case 'firefox':\n        if (!firefoxShim || !firefoxShim.shimPeerConnection) {\n          logging('Firefox shim is not included in this adapter release.');\n          return;\n        }\n        logging('adapter.js shimming firefox.');\n        // Export to the adapter global object visible in the browser.\n        module.exports.browserShim = firefoxShim;\n  \n        firefoxShim.shimGetUserMedia();\n        firefoxShim.shimSourceObject();\n        firefoxShim.shimPeerConnection();\n        firefoxShim.shimOnTrack();\n        break;\n      case 'edge':\n        if (!edgeShim || !edgeShim.shimPeerConnection) {\n          logging('MS edge shim is not included in this adapter release.');\n          return;\n        }\n        logging('adapter.js shimming edge.');\n        // Export to the adapter global object visible in the browser.\n        module.exports.browserShim = edgeShim;\n  \n        edgeShim.shimGetUserMedia();\n        edgeShim.shimPeerConnection();\n        break;\n      case 'safari':\n        if (!safariShim) {\n          logging('Safari shim is not included in this adapter release.');\n          return;\n        }\n        logging('adapter.js shimming safari.');\n        // Export to the adapter global object visible in the browser.\n        module.exports.browserShim = safariShim;\n  \n        safariShim.shimGetUserMedia();\n        break;\n      default:\n        logging('Unsupported browser!');\n    }\n  })();\n  \n  },{\"./chrome/chrome_shim\":3,\"./edge/edge_shim\":5,\"./firefox/firefox_shim\":7,\"./safari/safari_shim\":9,\"./utils\":10}],3:[function(require,module,exports){\n  \n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n   /* eslint-env node */\n  'use strict';\n  var logging = require('../utils.js').log;\n  var browserDetails = require('../utils.js').browserDetails;\n  \n  var chromeShim = {\n    shimMediaStream: function() {\n      window.MediaStream = window.MediaStream || window.webkitMediaStream;\n    },\n  \n    shimOnTrack: function() {\n      if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n          window.RTCPeerConnection.prototype)) {\n        Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n          get: function() {\n            return this._ontrack;\n          },\n          set: function(f) {\n            var self = this;\n            if (this._ontrack) {\n              this.removeEventListener('track', this._ontrack);\n              this.removeEventListener('addstream', this._ontrackpoly);\n            }\n            this.addEventListener('track', this._ontrack = f);\n            this.addEventListener('addstream', this._ontrackpoly = function(e) {\n              // onaddstream does not fire when a track is added to an existing\n              // stream. But stream.onaddtrack is implemented so we use that.\n              e.stream.addEventListener('addtrack', function(te) {\n                var event = new Event('track');\n                event.track = te.track;\n                event.receiver = {track: te.track};\n                event.streams = [e.stream];\n                self.dispatchEvent(event);\n              });\n              e.stream.getTracks().forEach(function(track) {\n                var event = new Event('track');\n                event.track = track;\n                event.receiver = {track: track};\n                event.streams = [e.stream];\n                this.dispatchEvent(event);\n              }.bind(this));\n            }.bind(this));\n          }\n        });\n      }\n    },\n  \n    shimSourceObject: function() {\n      if (typeof window === 'object') {\n        if (window.HTMLMediaElement &&\n          !('srcObject' in window.HTMLMediaElement.prototype)) {\n          // Shim the srcObject property, once, when HTMLMediaElement is found.\n          Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n            get: function() {\n              return this._srcObject;\n            },\n            set: function(stream) {\n              var self = this;\n              // Use _srcObject as a private property for this shim\n              this._srcObject = stream;\n              if (this.src) {\n                URL.revokeObjectURL(this.src);\n              }\n  \n              if (!stream) {\n                this.src = '';\n                return;\n              }\n              this.src = URL.createObjectURL(stream);\n              // We need to recreate the blob url when a track is added or\n              // removed. Doing it manually since we want to avoid a recursion.\n              stream.addEventListener('addtrack', function() {\n                if (self.src) {\n                  URL.revokeObjectURL(self.src);\n                }\n                self.src = URL.createObjectURL(stream);\n              });\n              stream.addEventListener('removetrack', function() {\n                if (self.src) {\n                  URL.revokeObjectURL(self.src);\n                }\n                self.src = URL.createObjectURL(stream);\n              });\n            }\n          });\n        }\n      }\n    },\n  \n    shimPeerConnection: function() {\n      // The RTCPeerConnection object.\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        // Translate iceTransportPolicy to iceTransports,\n        // see https://code.google.com/p/webrtc/issues/detail?id=4869\n        logging('PeerConnection');\n        if (pcConfig && pcConfig.iceTransportPolicy) {\n          pcConfig.iceTransports = pcConfig.iceTransportPolicy;\n        }\n  \n        var pc = new webkitRTCPeerConnection(pcConfig, pcConstraints);\n        var origGetStats = pc.getStats.bind(pc);\n        pc.getStats = function(selector, successCallback, errorCallback) {\n          var self = this;\n          var args = arguments;\n  \n          // If selector is a function then we are in the old style stats so just\n          // pass back the original getStats format to avoid breaking old users.\n          if (arguments.length > 0 && typeof selector === 'function') {\n            return origGetStats(selector, successCallback);\n          }\n  \n          var fixChromeStats_ = function(response) {\n            var standardReport = {};\n            var reports = response.result();\n            reports.forEach(function(report) {\n              var standardStats = {\n                id: report.id,\n                timestamp: report.timestamp,\n                type: report.type\n              };\n              report.names().forEach(function(name) {\n                standardStats[name] = report.stat(name);\n              });\n              standardReport[standardStats.id] = standardStats;\n            });\n  \n            return standardReport;\n          };\n  \n          // shim getStats with maplike support\n          var makeMapStats = function(stats, legacyStats) {\n            var map = new Map(Object.keys(stats).map(function(key) {\n              return[key, stats[key]];\n            }));\n            legacyStats = legacyStats || stats;\n            Object.keys(legacyStats).forEach(function(key) {\n              map[key] = legacyStats[key];\n            });\n            return map;\n          };\n  \n          if (arguments.length >= 2) {\n            var successCallbackWrapper_ = function(response) {\n              args[1](makeMapStats(fixChromeStats_(response)));\n            };\n  \n            return origGetStats.apply(this, [successCallbackWrapper_,\n                arguments[0]]);\n          }\n  \n          // promise-support\n          return new Promise(function(resolve, reject) {\n            if (args.length === 1 && typeof selector === 'object') {\n              origGetStats.apply(self, [\n                function(response) {\n                  resolve(makeMapStats(fixChromeStats_(response)));\n                }, reject]);\n            } else {\n              // Preserve legacy chrome stats only on legacy access of stats obj\n              origGetStats.apply(self, [\n                function(response) {\n                  resolve(makeMapStats(fixChromeStats_(response),\n                      response.result()));\n                }, reject]);\n            }\n          }).then(successCallback, errorCallback);\n        };\n  \n        return pc;\n      };\n      window.RTCPeerConnection.prototype = webkitRTCPeerConnection.prototype;\n  \n      // wrap static methods. Currently just generateCertificate.\n      if (webkitRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return webkitRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n  \n      ['createOffer', 'createAnswer'].forEach(function(method) {\n        var nativeMethod = webkitRTCPeerConnection.prototype[method];\n        webkitRTCPeerConnection.prototype[method] = function() {\n          var self = this;\n          if (arguments.length < 1 || (arguments.length === 1 &&\n              typeof arguments[0] === 'object')) {\n            var opts = arguments.length === 1 ? arguments[0] : undefined;\n            return new Promise(function(resolve, reject) {\n              nativeMethod.apply(self, [resolve, reject, opts]);\n            });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n  \n      // add promise support -- natively available in Chrome 51\n      if (browserDetails.version < 51) {\n        ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n            .forEach(function(method) {\n              var nativeMethod = webkitRTCPeerConnection.prototype[method];\n              webkitRTCPeerConnection.prototype[method] = function() {\n                var args = arguments;\n                var self = this;\n                var promise = new Promise(function(resolve, reject) {\n                  nativeMethod.apply(self, [args[0], resolve, reject]);\n                });\n                if (args.length < 2) {\n                  return promise;\n                }\n                return promise.then(function() {\n                  args[1].apply(null, []);\n                },\n                function(err) {\n                  if (args.length >= 3) {\n                    args[2].apply(null, [err]);\n                  }\n                });\n              };\n            });\n      }\n  \n      // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n          .forEach(function(method) {\n            var nativeMethod = webkitRTCPeerConnection.prototype[method];\n            webkitRTCPeerConnection.prototype[method] = function() {\n              arguments[0] = new ((method === 'addIceCandidate') ?\n                  RTCIceCandidate : RTCSessionDescription)(arguments[0]);\n              return nativeMethod.apply(this, arguments);\n            };\n          });\n  \n      // support for addIceCandidate(null)\n      var nativeAddIceCandidate =\n          RTCPeerConnection.prototype.addIceCandidate;\n      RTCPeerConnection.prototype.addIceCandidate = function() {\n        return arguments[0] === null ? Promise.resolve()\n            : nativeAddIceCandidate.apply(this, arguments);\n      };\n    }\n  };\n  \n  \n  // Expose public methods.\n  module.exports = {\n    shimMediaStream: chromeShim.shimMediaStream,\n    shimOnTrack: chromeShim.shimOnTrack,\n    shimSourceObject: chromeShim.shimSourceObject,\n    shimPeerConnection: chromeShim.shimPeerConnection,\n    shimGetUserMedia: require('./getusermedia')\n  };\n  \n  },{\"../utils.js\":10,\"./getusermedia\":4}],4:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n   /* eslint-env node */\n  'use strict';\n  var logging = require('../utils.js').log;\n  \n  // Expose public methods.\n  module.exports = function() {\n    var constraintsToChrome_ = function(c) {\n      if (typeof c !== 'object' || c.mandatory || c.optional) {\n        return c;\n      }\n      var cc = {};\n      Object.keys(c).forEach(function(key) {\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n          return;\n        }\n        var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n        if (r.exact !== undefined && typeof r.exact === 'number') {\n          r.min = r.max = r.exact;\n        }\n        var oldname_ = function(prefix, name) {\n          if (prefix) {\n            return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n          }\n          return (name === 'deviceId') ? 'sourceId' : name;\n        };\n        if (r.ideal !== undefined) {\n          cc.optional = cc.optional || [];\n          var oc = {};\n          if (typeof r.ideal === 'number') {\n            oc[oldname_('min', key)] = r.ideal;\n            cc.optional.push(oc);\n            oc = {};\n            oc[oldname_('max', key)] = r.ideal;\n            cc.optional.push(oc);\n          } else {\n            oc[oldname_('', key)] = r.ideal;\n            cc.optional.push(oc);\n          }\n        }\n        if (r.exact !== undefined && typeof r.exact !== 'number') {\n          cc.mandatory = cc.mandatory || {};\n          cc.mandatory[oldname_('', key)] = r.exact;\n        } else {\n          ['min', 'max'].forEach(function(mix) {\n            if (r[mix] !== undefined) {\n              cc.mandatory = cc.mandatory || {};\n              cc.mandatory[oldname_(mix, key)] = r[mix];\n            }\n          });\n        }\n      });\n      if (c.advanced) {\n        cc.optional = (cc.optional || []).concat(c.advanced);\n      }\n      return cc;\n    };\n  \n    var shimConstraints_ = function(constraints, func) {\n      constraints = JSON.parse(JSON.stringify(constraints));\n      if (constraints && constraints.audio) {\n        constraints.audio = constraintsToChrome_(constraints.audio);\n      }\n      if (constraints && typeof constraints.video === 'object') {\n        // Shim facingMode for mobile, where it defaults to \"user\".\n        var face = constraints.video.facingMode;\n        face = face && ((typeof face === 'object') ? face : {ideal: face});\n  \n        if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                      face.ideal === 'user' || face.ideal === 'environment')) &&\n            !(navigator.mediaDevices.getSupportedConstraints &&\n              navigator.mediaDevices.getSupportedConstraints().facingMode)) {\n          delete constraints.video.facingMode;\n          if (face.exact === 'environment' || face.ideal === 'environment') {\n            // Look for \"back\" in label, or use last cam (typically back cam).\n            return navigator.mediaDevices.enumerateDevices()\n            .then(function(devices) {\n              devices = devices.filter(function(d) {\n                return d.kind === 'videoinput';\n              });\n              var back = devices.find(function(d) {\n                return d.label.toLowerCase().indexOf('back') !== -1;\n              }) || (devices.length && devices[devices.length - 1]);\n              if (back) {\n                constraints.video.deviceId = face.exact ? {exact: back.deviceId} :\n                                                          {ideal: back.deviceId};\n              }\n              constraints.video = constraintsToChrome_(constraints.video);\n              logging('chrome: ' + JSON.stringify(constraints));\n              return func(constraints);\n            });\n          }\n        }\n        constraints.video = constraintsToChrome_(constraints.video);\n      }\n      logging('chrome: ' + JSON.stringify(constraints));\n      return func(constraints);\n    };\n  \n    var shimError_ = function(e) {\n      return {\n        name: {\n          PermissionDeniedError: 'NotAllowedError',\n          ConstraintNotSatisfiedError: 'OverconstrainedError'\n        }[e.name] || e.name,\n        message: e.message,\n        constraint: e.constraintName,\n        toString: function() {\n          return this.name + (this.message && ': ') + this.message;\n        }\n      };\n    };\n  \n    var getUserMedia_ = function(constraints, onSuccess, onError) {\n      shimConstraints_(constraints, function(c) {\n        navigator.webkitGetUserMedia(c, onSuccess, function(e) {\n          onError(shimError_(e));\n        });\n      });\n    };\n  \n    navigator.getUserMedia = getUserMedia_;\n  \n    // Returns the result of getUserMedia as a Promise.\n    var getUserMediaPromise_ = function(constraints) {\n      return new Promise(function(resolve, reject) {\n        navigator.getUserMedia(constraints, resolve, reject);\n      });\n    };\n  \n    if (!navigator.mediaDevices) {\n      navigator.mediaDevices = {\n        getUserMedia: getUserMediaPromise_,\n        enumerateDevices: function() {\n          return new Promise(function(resolve) {\n            var kinds = {audio: 'audioinput', video: 'videoinput'};\n            return MediaStreamTrack.getSources(function(devices) {\n              resolve(devices.map(function(device) {\n                return {label: device.label,\n                        kind: kinds[device.kind],\n                        deviceId: device.id,\n                        groupId: ''};\n              }));\n            });\n          });\n        }\n      };\n    }\n  \n    // A shim for getUserMedia method on the mediaDevices object.\n    // TODO(KaptenJansson) remove once implemented in Chrome stable.\n    if (!navigator.mediaDevices.getUserMedia) {\n      navigator.mediaDevices.getUserMedia = function(constraints) {\n        return getUserMediaPromise_(constraints);\n      };\n    } else {\n      // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n      // function which returns a Promise, it does not accept spec-style\n      // constraints.\n      var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n          bind(navigator.mediaDevices);\n      navigator.mediaDevices.getUserMedia = function(cs) {\n        return shimConstraints_(cs, function(c) {\n          return origGetUserMedia(c).catch(function(e) {\n            return Promise.reject(shimError_(e));\n          });\n        });\n      };\n    }\n  \n    // Dummy devicechange event methods.\n    // TODO(KaptenJansson) remove once implemented in Chrome stable.\n    if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\n      navigator.mediaDevices.addEventListener = function() {\n        logging('Dummy mediaDevices.addEventListener called.');\n      };\n    }\n    if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\n      navigator.mediaDevices.removeEventListener = function() {\n        logging('Dummy mediaDevices.removeEventListener called.');\n      };\n    }\n  };\n  \n  },{\"../utils.js\":10}],5:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n   /* eslint-env node */\n  'use strict';\n  \n  var SDPUtils = require('sdp');\n  \n  var edgeShim = {\n    shimPeerConnection: function() {\n      if (window.RTCIceGatherer) {\n        // ORTC defines an RTCIceCandidate object but no constructor.\n        // Not implemented in Edge.\n        if (!window.RTCIceCandidate) {\n          window.RTCIceCandidate = function(args) {\n            return args;\n          };\n        }\n        // ORTC does not have a session description object but\n        // other browsers (i.e. Chrome) that will support both PC and ORTC\n        // in the future might have this defined already.\n        if (!window.RTCSessionDescription) {\n          window.RTCSessionDescription = function(args) {\n            return args;\n          };\n        }\n      }\n  \n      window.RTCPeerConnection = function(config) {\n        var self = this;\n  \n        var _eventTarget = document.createDocumentFragment();\n        ['addEventListener', 'removeEventListener', 'dispatchEvent']\n            .forEach(function(method) {\n              self[method] = _eventTarget[method].bind(_eventTarget);\n            });\n  \n        this.onicecandidate = null;\n        this.onaddstream = null;\n        this.ontrack = null;\n        this.onremovestream = null;\n        this.onsignalingstatechange = null;\n        this.oniceconnectionstatechange = null;\n        this.onnegotiationneeded = null;\n        this.ondatachannel = null;\n  \n        this.localStreams = [];\n        this.remoteStreams = [];\n        this.getLocalStreams = function() {\n          return self.localStreams;\n        };\n        this.getRemoteStreams = function() {\n          return self.remoteStreams;\n        };\n  \n        this.localDescription = new RTCSessionDescription({\n          type: '',\n          sdp: ''\n        });\n        this.remoteDescription = new RTCSessionDescription({\n          type: '',\n          sdp: ''\n        });\n        this.signalingState = 'stable';\n        this.iceConnectionState = 'new';\n        this.iceGatheringState = 'new';\n  \n        this.iceOptions = {\n          gatherPolicy: 'all',\n          iceServers: []\n        };\n        if (config && config.iceTransportPolicy) {\n          switch (config.iceTransportPolicy) {\n            case 'all':\n            case 'relay':\n              this.iceOptions.gatherPolicy = config.iceTransportPolicy;\n              break;\n            case 'none':\n              // FIXME: remove once implementation and spec have added this.\n              throw new TypeError('iceTransportPolicy \"none\" not supported');\n            default:\n              // don't set iceTransportPolicy.\n              break;\n          }\n        }\n        this.usingBundle = config && config.bundlePolicy === 'max-bundle';\n  \n        if (config && config.iceServers) {\n          // Edge does not like\n          // 1) stun:\n          // 2) turn: that does not have all of turn:host:port?transport=udp\n          // 3) turn: with ipv6 addresses\n          var iceServers = JSON.parse(JSON.stringify(config.iceServers));\n          this.iceOptions.iceServers = iceServers.filter(function(server) {\n            if (server && server.urls) {\n              var urls = server.urls;\n              if (typeof urls === 'string') {\n                urls = [urls];\n              }\n              urls = urls.filter(function(url) {\n                return url.indexOf('turn:') === 0 &&\n                    url.indexOf('transport=udp') !== -1 &&\n                    url.indexOf('turn:[') === -1;\n              })[0];\n              return !!urls;\n            }\n            return false;\n          });\n        }\n  \n        // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n        // everything that is needed to describe a SDP m-line.\n        this.transceivers = [];\n  \n        // since the iceGatherer is currently created in createOffer but we\n        // must not emit candidates until after setLocalDescription we buffer\n        // them in this array.\n        this._localIceCandidatesBuffer = [];\n      };\n  \n      window.RTCPeerConnection.prototype._emitBufferedCandidates = function() {\n        var self = this;\n        var sections = SDPUtils.splitSections(self.localDescription.sdp);\n        // FIXME: need to apply ice candidates in a way which is async but\n        // in-order\n        this._localIceCandidatesBuffer.forEach(function(event) {\n          var end = !event.candidate || Object.keys(event.candidate).length === 0;\n          if (end) {\n            for (var j = 1; j < sections.length; j++) {\n              if (sections[j].indexOf('\\r\\na=end-of-candidates\\r\\n') === -1) {\n                sections[j] += 'a=end-of-candidates\\r\\n';\n              }\n            }\n          } else if (event.candidate.candidate.indexOf('typ endOfCandidates')\n              === -1) {\n            sections[event.candidate.sdpMLineIndex + 1] +=\n                'a=' + event.candidate.candidate + '\\r\\n';\n          }\n          self.localDescription.sdp = sections.join('');\n          self.dispatchEvent(event);\n          if (self.onicecandidate !== null) {\n            self.onicecandidate(event);\n          }\n          if (!event.candidate && self.iceGatheringState !== 'complete') {\n            var complete = self.transceivers.every(function(transceiver) {\n              return transceiver.iceGatherer &&\n                  transceiver.iceGatherer.state === 'completed';\n            });\n            if (complete) {\n              self.iceGatheringState = 'complete';\n            }\n          }\n        });\n        this._localIceCandidatesBuffer = [];\n      };\n  \n      window.RTCPeerConnection.prototype.addStream = function(stream) {\n        // Clone is necessary for local demos mostly, attaching directly\n        // to two different senders does not work (build 10547).\n        this.localStreams.push(stream.clone());\n        this._maybeFireNegotiationNeeded();\n      };\n  \n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\n        var idx = this.localStreams.indexOf(stream);\n        if (idx > -1) {\n          this.localStreams.splice(idx, 1);\n          this._maybeFireNegotiationNeeded();\n        }\n      };\n  \n      window.RTCPeerConnection.prototype.getSenders = function() {\n        return this.transceivers.filter(function(transceiver) {\n          return !!transceiver.rtpSender;\n        })\n        .map(function(transceiver) {\n          return transceiver.rtpSender;\n        });\n      };\n  \n      window.RTCPeerConnection.prototype.getReceivers = function() {\n        return this.transceivers.filter(function(transceiver) {\n          return !!transceiver.rtpReceiver;\n        })\n        .map(function(transceiver) {\n          return transceiver.rtpReceiver;\n        });\n      };\n  \n      // Determines the intersection of local and remote capabilities.\n      window.RTCPeerConnection.prototype._getCommonCapabilities =\n          function(localCapabilities, remoteCapabilities) {\n            var commonCapabilities = {\n              codecs: [],\n              headerExtensions: [],\n              fecMechanisms: []\n            };\n            localCapabilities.codecs.forEach(function(lCodec) {\n              for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n                var rCodec = remoteCapabilities.codecs[i];\n                if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n                    lCodec.clockRate === rCodec.clockRate &&\n                    lCodec.numChannels === rCodec.numChannels) {\n                  // push rCodec so we reply with offerer payload type\n                  commonCapabilities.codecs.push(rCodec);\n  \n                  // determine common feedback mechanisms\n                  rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n                    for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n                      if (lCodec.rtcpFeedback[j].type === fb.type &&\n                          lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n                        return true;\n                      }\n                    }\n                    return false;\n                  });\n                  // FIXME: also need to determine .parameters\n                  //  see https://github.com/openpeer/ortc/issues/569\n                  break;\n                }\n              }\n            });\n  \n            localCapabilities.headerExtensions\n                .forEach(function(lHeaderExtension) {\n                  for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n                       i++) {\n                    var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n                    if (lHeaderExtension.uri === rHeaderExtension.uri) {\n                      commonCapabilities.headerExtensions.push(rHeaderExtension);\n                      break;\n                    }\n                  }\n                });\n  \n            // FIXME: fecMechanisms\n            return commonCapabilities;\n          };\n  \n      // Create ICE gatherer, ICE transport and DTLS transport.\n      window.RTCPeerConnection.prototype._createIceAndDtlsTransports =\n          function(mid, sdpMLineIndex) {\n            var self = this;\n            var iceGatherer = new RTCIceGatherer(self.iceOptions);\n            var iceTransport = new RTCIceTransport(iceGatherer);\n            iceGatherer.onlocalcandidate = function(evt) {\n              var event = new Event('icecandidate');\n              event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n  \n              var cand = evt.candidate;\n              var end = !cand || Object.keys(cand).length === 0;\n              // Edge emits an empty object for RTCIceCandidateComplete\n              if (end) {\n                // polyfill since RTCIceGatherer.state is not implemented in\n                // Edge 10547 yet.\n                if (iceGatherer.state === undefined) {\n                  iceGatherer.state = 'completed';\n                }\n  \n                // Emit a candidate with type endOfCandidates to make the samples\n                // work. Edge requires addIceCandidate with this empty candidate\n                // to start checking. The real solution is to signal\n                // end-of-candidates to the other side when getting the null\n                // candidate but some apps (like the samples) don't do that.\n                event.candidate.candidate =\n                    'candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates';\n              } else {\n                // RTCIceCandidate doesn't have a component, needs to be added\n                cand.component = iceTransport.component === 'RTCP' ? 2 : 1;\n                event.candidate.candidate = SDPUtils.writeCandidate(cand);\n              }\n  \n              // update local description.\n              var sections = SDPUtils.splitSections(self.localDescription.sdp);\n              if (event.candidate.candidate.indexOf('typ endOfCandidates')\n                  === -1) {\n                sections[event.candidate.sdpMLineIndex + 1] +=\n                    'a=' + event.candidate.candidate + '\\r\\n';\n              } else {\n                sections[event.candidate.sdpMLineIndex + 1] +=\n                    'a=end-of-candidates\\r\\n';\n              }\n              self.localDescription.sdp = sections.join('');\n  \n              var complete = self.transceivers.every(function(transceiver) {\n                return transceiver.iceGatherer &&\n                    transceiver.iceGatherer.state === 'completed';\n              });\n  \n              // Emit candidate if localDescription is set.\n              // Also emits null candidate when all gatherers are complete.\n              switch (self.iceGatheringState) {\n                case 'new':\n                  self._localIceCandidatesBuffer.push(event);\n                  if (end && complete) {\n                    self._localIceCandidatesBuffer.push(\n                        new Event('icecandidate'));\n                  }\n                  break;\n                case 'gathering':\n                  self._emitBufferedCandidates();\n                  self.dispatchEvent(event);\n                  if (self.onicecandidate !== null) {\n                    self.onicecandidate(event);\n                  }\n                  if (complete) {\n                    self.dispatchEvent(new Event('icecandidate'));\n                    if (self.onicecandidate !== null) {\n                      self.onicecandidate(new Event('icecandidate'));\n                    }\n                    self.iceGatheringState = 'complete';\n                  }\n                  break;\n                case 'complete':\n                  // should not happen... currently!\n                  break;\n                default: // no-op.\n                  break;\n              }\n            };\n            iceTransport.onicestatechange = function() {\n              self._updateConnectionState();\n            };\n  \n            var dtlsTransport = new RTCDtlsTransport(iceTransport);\n            dtlsTransport.ondtlsstatechange = function() {\n              self._updateConnectionState();\n            };\n            dtlsTransport.onerror = function() {\n              // onerror does not set state to failed by itself.\n              dtlsTransport.state = 'failed';\n              self._updateConnectionState();\n            };\n  \n            return {\n              iceGatherer: iceGatherer,\n              iceTransport: iceTransport,\n              dtlsTransport: dtlsTransport\n            };\n          };\n  \n      // Start the RTP Sender and Receiver for a transceiver.\n      window.RTCPeerConnection.prototype._transceive = function(transceiver,\n          send, recv) {\n        var params = this._getCommonCapabilities(transceiver.localCapabilities,\n            transceiver.remoteCapabilities);\n        if (send && transceiver.rtpSender) {\n          params.encodings = transceiver.sendEncodingParameters;\n          params.rtcp = {\n            cname: SDPUtils.localCName\n          };\n          if (transceiver.recvEncodingParameters.length) {\n            params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n          }\n          transceiver.rtpSender.send(params);\n        }\n        if (recv && transceiver.rtpReceiver) {\n          params.encodings = transceiver.recvEncodingParameters;\n          params.rtcp = {\n            cname: transceiver.cname\n          };\n          if (transceiver.sendEncodingParameters.length) {\n            params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n          }\n          transceiver.rtpReceiver.receive(params);\n        }\n      };\n  \n      window.RTCPeerConnection.prototype.setLocalDescription =\n          function(description) {\n            var self = this;\n            var sections;\n            var sessionpart;\n            if (description.type === 'offer') {\n              // FIXME: What was the purpose of this empty if statement?\n              // if (!this._pendingOffer) {\n              // } else {\n              if (this._pendingOffer) {\n                // VERY limited support for SDP munging. Limited to:\n                // * changing the order of codecs\n                sections = SDPUtils.splitSections(description.sdp);\n                sessionpart = sections.shift();\n                sections.forEach(function(mediaSection, sdpMLineIndex) {\n                  var caps = SDPUtils.parseRtpParameters(mediaSection);\n                  self._pendingOffer[sdpMLineIndex].localCapabilities = caps;\n                });\n                this.transceivers = this._pendingOffer;\n                delete this._pendingOffer;\n              }\n            } else if (description.type === 'answer') {\n              sections = SDPUtils.splitSections(self.remoteDescription.sdp);\n              sessionpart = sections.shift();\n              var isIceLite = SDPUtils.matchPrefix(sessionpart,\n                  'a=ice-lite').length > 0;\n              sections.forEach(function(mediaSection, sdpMLineIndex) {\n                var transceiver = self.transceivers[sdpMLineIndex];\n                var iceGatherer = transceiver.iceGatherer;\n                var iceTransport = transceiver.iceTransport;\n                var dtlsTransport = transceiver.dtlsTransport;\n                var localCapabilities = transceiver.localCapabilities;\n                var remoteCapabilities = transceiver.remoteCapabilities;\n                var rejected = mediaSection.split('\\n', 1)[0]\n                    .split(' ', 2)[1] === '0';\n  \n                if (!rejected) {\n                  var remoteIceParameters = SDPUtils.getIceParameters(\n                      mediaSection, sessionpart);\n                  if (isIceLite) {\n                    var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n                    .map(function(cand) {\n                      return SDPUtils.parseCandidate(cand);\n                    })\n                    .filter(function(cand) {\n                      return cand.component === '1';\n                    });\n                    // ice-lite only includes host candidates in the SDP so we can\n                    // use setRemoteCandidates (which implies an\n                    // RTCIceCandidateComplete)\n                    if (cands.length) {\n                      iceTransport.setRemoteCandidates(cands);\n                    }\n                  }\n                  var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n                      mediaSection, sessionpart);\n                  if (isIceLite) {\n                    remoteDtlsParameters.role = 'server';\n                  }\n  \n                  if (!self.usingBundle || sdpMLineIndex === 0) {\n                    iceTransport.start(iceGatherer, remoteIceParameters,\n                        isIceLite ? 'controlling' : 'controlled');\n                    dtlsTransport.start(remoteDtlsParameters);\n                  }\n  \n                  // Calculate intersection of capabilities.\n                  var params = self._getCommonCapabilities(localCapabilities,\n                      remoteCapabilities);\n  \n                  // Start the RTCRtpSender. The RTCRtpReceiver for this\n                  // transceiver has already been started in setRemoteDescription.\n                  self._transceive(transceiver,\n                      params.codecs.length > 0,\n                      false);\n                }\n              });\n            }\n  \n            this.localDescription = {\n              type: description.type,\n              sdp: description.sdp\n            };\n            switch (description.type) {\n              case 'offer':\n                this._updateSignalingState('have-local-offer');\n                break;\n              case 'answer':\n                this._updateSignalingState('stable');\n                break;\n              default:\n                throw new TypeError('unsupported type \"' + description.type +\n                    '\"');\n            }\n  \n            // If a success callback was provided, emit ICE candidates after it\n            // has been executed. Otherwise, emit callback after the Promise is\n            // resolved.\n            var hasCallback = arguments.length > 1 &&\n              typeof arguments[1] === 'function';\n            if (hasCallback) {\n              var cb = arguments[1];\n              window.setTimeout(function() {\n                cb();\n                if (self.iceGatheringState === 'new') {\n                  self.iceGatheringState = 'gathering';\n                }\n                self._emitBufferedCandidates();\n              }, 0);\n            }\n            var p = Promise.resolve();\n            p.then(function() {\n              if (!hasCallback) {\n                if (self.iceGatheringState === 'new') {\n                  self.iceGatheringState = 'gathering';\n                }\n                // Usually candidates will be emitted earlier.\n                window.setTimeout(self._emitBufferedCandidates.bind(self), 500);\n              }\n            });\n            return p;\n          };\n  \n      window.RTCPeerConnection.prototype.setRemoteDescription =\n          function(description) {\n            var self = this;\n            var stream = new MediaStream();\n            var receiverList = [];\n            var sections = SDPUtils.splitSections(description.sdp);\n            var sessionpart = sections.shift();\n            var isIceLite = SDPUtils.matchPrefix(sessionpart,\n                'a=ice-lite').length > 0;\n            this.usingBundle = SDPUtils.matchPrefix(sessionpart,\n                'a=group:BUNDLE ').length > 0;\n            sections.forEach(function(mediaSection, sdpMLineIndex) {\n              var lines = SDPUtils.splitLines(mediaSection);\n              var mline = lines[0].substr(2).split(' ');\n              var kind = mline[0];\n              var rejected = mline[1] === '0';\n              var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n  \n              var transceiver;\n              var iceGatherer;\n              var iceTransport;\n              var dtlsTransport;\n              var rtpSender;\n              var rtpReceiver;\n              var sendEncodingParameters;\n              var recvEncodingParameters;\n              var localCapabilities;\n  \n              var track;\n              // FIXME: ensure the mediaSection has rtcp-mux set.\n              var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n              var remoteIceParameters;\n              var remoteDtlsParameters;\n              if (!rejected) {\n                remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n                    sessionpart);\n                remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n                    sessionpart);\n                remoteDtlsParameters.role = 'client';\n              }\n              recvEncodingParameters =\n                  SDPUtils.parseRtpEncodingParameters(mediaSection);\n  \n              var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:');\n              if (mid.length) {\n                mid = mid[0].substr(6);\n              } else {\n                mid = SDPUtils.generateIdentifier();\n              }\n  \n              var cname;\n              // Gets the first SSRC. Note that with RTX there might be multiple\n              // SSRCs.\n              var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n                  .map(function(line) {\n                    return SDPUtils.parseSsrcMedia(line);\n                  })\n                  .filter(function(obj) {\n                    return obj.attribute === 'cname';\n                  })[0];\n              if (remoteSsrc) {\n                cname = remoteSsrc.value;\n              }\n  \n              var isComplete = SDPUtils.matchPrefix(mediaSection,\n                  'a=end-of-candidates', sessionpart).length > 0;\n              var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n                  .map(function(cand) {\n                    return SDPUtils.parseCandidate(cand);\n                  })\n                  .filter(function(cand) {\n                    return cand.component === '1';\n                  });\n              if (description.type === 'offer' && !rejected) {\n                var transports = self.usingBundle && sdpMLineIndex > 0 ? {\n                  iceGatherer: self.transceivers[0].iceGatherer,\n                  iceTransport: self.transceivers[0].iceTransport,\n                  dtlsTransport: self.transceivers[0].dtlsTransport\n                } : self._createIceAndDtlsTransports(mid, sdpMLineIndex);\n  \n                if (isComplete) {\n                  transports.iceTransport.setRemoteCandidates(cands);\n                }\n  \n                localCapabilities = RTCRtpReceiver.getCapabilities(kind);\n                sendEncodingParameters = [{\n                  ssrc: (2 * sdpMLineIndex + 2) * 1001\n                }];\n  \n                rtpReceiver = new RTCRtpReceiver(transports.dtlsTransport, kind);\n  \n                track = rtpReceiver.track;\n                receiverList.push([track, rtpReceiver]);\n                // FIXME: not correct when there are multiple streams but that is\n                // not currently supported in this shim.\n                stream.addTrack(track);\n  \n                // FIXME: look at direction.\n                if (self.localStreams.length > 0 &&\n                    self.localStreams[0].getTracks().length >= sdpMLineIndex) {\n                  var localTrack;\n                  if (kind === 'audio') {\n                    localTrack = self.localStreams[0].getAudioTracks()[0];\n                  } else if (kind === 'video') {\n                    localTrack = self.localStreams[0].getVideoTracks()[0];\n                  }\n                  if (localTrack) {\n                    rtpSender = new RTCRtpSender(localTrack,\n                        transports.dtlsTransport);\n                  }\n                }\n  \n                self.transceivers[sdpMLineIndex] = {\n                  iceGatherer: transports.iceGatherer,\n                  iceTransport: transports.iceTransport,\n                  dtlsTransport: transports.dtlsTransport,\n                  localCapabilities: localCapabilities,\n                  remoteCapabilities: remoteCapabilities,\n                  rtpSender: rtpSender,\n                  rtpReceiver: rtpReceiver,\n                  kind: kind,\n                  mid: mid,\n                  cname: cname,\n                  sendEncodingParameters: sendEncodingParameters,\n                  recvEncodingParameters: recvEncodingParameters\n                };\n                // Start the RTCRtpReceiver now. The RTPSender is started in\n                // setLocalDescription.\n                self._transceive(self.transceivers[sdpMLineIndex],\n                    false,\n                    direction === 'sendrecv' || direction === 'sendonly');\n              } else if (description.type === 'answer' && !rejected) {\n                transceiver = self.transceivers[sdpMLineIndex];\n                iceGatherer = transceiver.iceGatherer;\n                iceTransport = transceiver.iceTransport;\n                dtlsTransport = transceiver.dtlsTransport;\n                rtpSender = transceiver.rtpSender;\n                rtpReceiver = transceiver.rtpReceiver;\n                sendEncodingParameters = transceiver.sendEncodingParameters;\n                localCapabilities = transceiver.localCapabilities;\n  \n                self.transceivers[sdpMLineIndex].recvEncodingParameters =\n                    recvEncodingParameters;\n                self.transceivers[sdpMLineIndex].remoteCapabilities =\n                    remoteCapabilities;\n                self.transceivers[sdpMLineIndex].cname = cname;\n  \n                if ((isIceLite || isComplete) && cands.length) {\n                  iceTransport.setRemoteCandidates(cands);\n                }\n                if (!self.usingBundle || sdpMLineIndex === 0) {\n                  iceTransport.start(iceGatherer, remoteIceParameters,\n                      'controlling');\n                  dtlsTransport.start(remoteDtlsParameters);\n                }\n  \n                self._transceive(transceiver,\n                    direction === 'sendrecv' || direction === 'recvonly',\n                    direction === 'sendrecv' || direction === 'sendonly');\n  \n                if (rtpReceiver &&\n                    (direction === 'sendrecv' || direction === 'sendonly')) {\n                  track = rtpReceiver.track;\n                  receiverList.push([track, rtpReceiver]);\n                  stream.addTrack(track);\n                } else {\n                  // FIXME: actually the receiver should be created later.\n                  delete transceiver.rtpReceiver;\n                }\n              }\n            });\n  \n            this.remoteDescription = {\n              type: description.type,\n              sdp: description.sdp\n            };\n            switch (description.type) {\n              case 'offer':\n                this._updateSignalingState('have-remote-offer');\n                break;\n              case 'answer':\n                this._updateSignalingState('stable');\n                break;\n              default:\n                throw new TypeError('unsupported type \"' + description.type +\n                    '\"');\n            }\n            if (stream.getTracks().length) {\n              self.remoteStreams.push(stream);\n              window.setTimeout(function() {\n                var event = new Event('addstream');\n                event.stream = stream;\n                self.dispatchEvent(event);\n                if (self.onaddstream !== null) {\n                  window.setTimeout(function() {\n                    self.onaddstream(event);\n                  }, 0);\n                }\n  \n                receiverList.forEach(function(item) {\n                  var track = item[0];\n                  var receiver = item[1];\n                  var trackEvent = new Event('track');\n                  trackEvent.track = track;\n                  trackEvent.receiver = receiver;\n                  trackEvent.streams = [stream];\n                  self.dispatchEvent(event);\n                  if (self.ontrack !== null) {\n                    window.setTimeout(function() {\n                      self.ontrack(trackEvent);\n                    }, 0);\n                  }\n                });\n              }, 0);\n            }\n            if (arguments.length > 1 && typeof arguments[1] === 'function') {\n              window.setTimeout(arguments[1], 0);\n            }\n            return Promise.resolve();\n          };\n  \n      window.RTCPeerConnection.prototype.close = function() {\n        this.transceivers.forEach(function(transceiver) {\n          /* not yet\n          if (transceiver.iceGatherer) {\n            transceiver.iceGatherer.close();\n          }\n          */\n          if (transceiver.iceTransport) {\n            transceiver.iceTransport.stop();\n          }\n          if (transceiver.dtlsTransport) {\n            transceiver.dtlsTransport.stop();\n          }\n          if (transceiver.rtpSender) {\n            transceiver.rtpSender.stop();\n          }\n          if (transceiver.rtpReceiver) {\n            transceiver.rtpReceiver.stop();\n          }\n        });\n        // FIXME: clean up tracks, local streams, remote streams, etc\n        this._updateSignalingState('closed');\n      };\n  \n      // Update the signaling state.\n      window.RTCPeerConnection.prototype._updateSignalingState =\n          function(newState) {\n            this.signalingState = newState;\n            var event = new Event('signalingstatechange');\n            this.dispatchEvent(event);\n            if (this.onsignalingstatechange !== null) {\n              this.onsignalingstatechange(event);\n            }\n          };\n  \n      // Determine whether to fire the negotiationneeded event.\n      window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded =\n          function() {\n            // Fire away (for now).\n            var event = new Event('negotiationneeded');\n            this.dispatchEvent(event);\n            if (this.onnegotiationneeded !== null) {\n              this.onnegotiationneeded(event);\n            }\n          };\n  \n      // Update the connection state.\n      window.RTCPeerConnection.prototype._updateConnectionState = function() {\n        var self = this;\n        var newState;\n        var states = {\n          'new': 0,\n          closed: 0,\n          connecting: 0,\n          checking: 0,\n          connected: 0,\n          completed: 0,\n          failed: 0\n        };\n        this.transceivers.forEach(function(transceiver) {\n          states[transceiver.iceTransport.state]++;\n          states[transceiver.dtlsTransport.state]++;\n        });\n        // ICETransport.completed and connected are the same for this purpose.\n        states.connected += states.completed;\n  \n        newState = 'new';\n        if (states.failed > 0) {\n          newState = 'failed';\n        } else if (states.connecting > 0 || states.checking > 0) {\n          newState = 'connecting';\n        } else if (states.disconnected > 0) {\n          newState = 'disconnected';\n        } else if (states.new > 0) {\n          newState = 'new';\n        } else if (states.connected > 0 || states.completed > 0) {\n          newState = 'connected';\n        }\n  \n        if (newState !== self.iceConnectionState) {\n          self.iceConnectionState = newState;\n          var event = new Event('iceconnectionstatechange');\n          this.dispatchEvent(event);\n          if (this.oniceconnectionstatechange !== null) {\n            this.oniceconnectionstatechange(event);\n          }\n        }\n      };\n  \n      window.RTCPeerConnection.prototype.createOffer = function() {\n        var self = this;\n        if (this._pendingOffer) {\n          throw new Error('createOffer called while there is a pending offer.');\n        }\n        var offerOptions;\n        if (arguments.length === 1 && typeof arguments[0] !== 'function') {\n          offerOptions = arguments[0];\n        } else if (arguments.length === 3) {\n          offerOptions = arguments[2];\n        }\n  \n        var tracks = [];\n        var numAudioTracks = 0;\n        var numVideoTracks = 0;\n        // Default to sendrecv.\n        if (this.localStreams.length) {\n          numAudioTracks = this.localStreams[0].getAudioTracks().length;\n          numVideoTracks = this.localStreams[0].getVideoTracks().length;\n        }\n        // Determine number of audio and video tracks we need to send/recv.\n        if (offerOptions) {\n          // Reject Chrome legacy constraints.\n          if (offerOptions.mandatory || offerOptions.optional) {\n            throw new TypeError(\n                'Legacy mandatory/optional constraints not supported.');\n          }\n          if (offerOptions.offerToReceiveAudio !== undefined) {\n            numAudioTracks = offerOptions.offerToReceiveAudio;\n          }\n          if (offerOptions.offerToReceiveVideo !== undefined) {\n            numVideoTracks = offerOptions.offerToReceiveVideo;\n          }\n        }\n        if (this.localStreams.length) {\n          // Push local streams.\n          this.localStreams[0].getTracks().forEach(function(track) {\n            tracks.push({\n              kind: track.kind,\n              track: track,\n              wantReceive: track.kind === 'audio' ?\n                  numAudioTracks > 0 : numVideoTracks > 0\n            });\n            if (track.kind === 'audio') {\n              numAudioTracks--;\n            } else if (track.kind === 'video') {\n              numVideoTracks--;\n            }\n          });\n        }\n        // Create M-lines for recvonly streams.\n        while (numAudioTracks > 0 || numVideoTracks > 0) {\n          if (numAudioTracks > 0) {\n            tracks.push({\n              kind: 'audio',\n              wantReceive: true\n            });\n            numAudioTracks--;\n          }\n          if (numVideoTracks > 0) {\n            tracks.push({\n              kind: 'video',\n              wantReceive: true\n            });\n            numVideoTracks--;\n          }\n        }\n  \n        var sdp = SDPUtils.writeSessionBoilerplate();\n        var transceivers = [];\n        tracks.forEach(function(mline, sdpMLineIndex) {\n          // For each track, create an ice gatherer, ice transport,\n          // dtls transport, potentially rtpsender and rtpreceiver.\n          var track = mline.track;\n          var kind = mline.kind;\n          var mid = SDPUtils.generateIdentifier();\n  \n          var transports = self.usingBundle && sdpMLineIndex > 0 ? {\n            iceGatherer: transceivers[0].iceGatherer,\n            iceTransport: transceivers[0].iceTransport,\n            dtlsTransport: transceivers[0].dtlsTransport\n          } : self._createIceAndDtlsTransports(mid, sdpMLineIndex);\n  \n          var localCapabilities = RTCRtpSender.getCapabilities(kind);\n          var rtpSender;\n          var rtpReceiver;\n  \n          // generate an ssrc now, to be used later in rtpSender.send\n          var sendEncodingParameters = [{\n            ssrc: (2 * sdpMLineIndex + 1) * 1001\n          }];\n          if (track) {\n            rtpSender = new RTCRtpSender(track, transports.dtlsTransport);\n          }\n  \n          if (mline.wantReceive) {\n            rtpReceiver = new RTCRtpReceiver(transports.dtlsTransport, kind);\n          }\n  \n          transceivers[sdpMLineIndex] = {\n            iceGatherer: transports.iceGatherer,\n            iceTransport: transports.iceTransport,\n            dtlsTransport: transports.dtlsTransport,\n            localCapabilities: localCapabilities,\n            remoteCapabilities: null,\n            rtpSender: rtpSender,\n            rtpReceiver: rtpReceiver,\n            kind: kind,\n            mid: mid,\n            sendEncodingParameters: sendEncodingParameters,\n            recvEncodingParameters: null\n          };\n        });\n        if (this.usingBundle) {\n          sdp += 'a=group:BUNDLE ' + transceivers.map(function(t) {\n            return t.mid;\n          }).join(' ') + '\\r\\n';\n        }\n        tracks.forEach(function(mline, sdpMLineIndex) {\n          var transceiver = transceivers[sdpMLineIndex];\n          sdp += SDPUtils.writeMediaSection(transceiver,\n              transceiver.localCapabilities, 'offer', self.localStreams[0]);\n        });\n  \n        this._pendingOffer = transceivers;\n        var desc = new RTCSessionDescription({\n          type: 'offer',\n          sdp: sdp\n        });\n        if (arguments.length && typeof arguments[0] === 'function') {\n          window.setTimeout(arguments[0], 0, desc);\n        }\n        return Promise.resolve(desc);\n      };\n  \n      window.RTCPeerConnection.prototype.createAnswer = function() {\n        var self = this;\n  \n        var sdp = SDPUtils.writeSessionBoilerplate();\n        if (this.usingBundle) {\n          sdp += 'a=group:BUNDLE ' + this.transceivers.map(function(t) {\n            return t.mid;\n          }).join(' ') + '\\r\\n';\n        }\n        this.transceivers.forEach(function(transceiver) {\n          // Calculate intersection of capabilities.\n          var commonCapabilities = self._getCommonCapabilities(\n              transceiver.localCapabilities,\n              transceiver.remoteCapabilities);\n  \n          sdp += SDPUtils.writeMediaSection(transceiver, commonCapabilities,\n              'answer', self.localStreams[0]);\n        });\n  \n        var desc = new RTCSessionDescription({\n          type: 'answer',\n          sdp: sdp\n        });\n        if (arguments.length && typeof arguments[0] === 'function') {\n          window.setTimeout(arguments[0], 0, desc);\n        }\n        return Promise.resolve(desc);\n      };\n  \n      window.RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n        if (candidate === null) {\n          this.transceivers.forEach(function(transceiver) {\n            transceiver.iceTransport.addRemoteCandidate({});\n          });\n        } else {\n          var mLineIndex = candidate.sdpMLineIndex;\n          if (candidate.sdpMid) {\n            for (var i = 0; i < this.transceivers.length; i++) {\n              if (this.transceivers[i].mid === candidate.sdpMid) {\n                mLineIndex = i;\n                break;\n              }\n            }\n          }\n          var transceiver = this.transceivers[mLineIndex];\n          if (transceiver) {\n            var cand = Object.keys(candidate.candidate).length > 0 ?\n                SDPUtils.parseCandidate(candidate.candidate) : {};\n            // Ignore Chrome's invalid candidates since Edge does not like them.\n            if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n              return;\n            }\n            // Ignore RTCP candidates, we assume RTCP-MUX.\n            if (cand.component !== '1') {\n              return;\n            }\n            // A dirty hack to make samples work.\n            if (cand.type === 'endOfCandidates') {\n              cand = {};\n            }\n            transceiver.iceTransport.addRemoteCandidate(cand);\n  \n            // update the remoteDescription.\n            var sections = SDPUtils.splitSections(this.remoteDescription.sdp);\n            sections[mLineIndex + 1] += (cand.type ? candidate.candidate.trim()\n                : 'a=end-of-candidates') + '\\r\\n';\n            this.remoteDescription.sdp = sections.join('');\n          }\n        }\n        if (arguments.length > 1 && typeof arguments[1] === 'function') {\n          window.setTimeout(arguments[1], 0);\n        }\n        return Promise.resolve();\n      };\n  \n      window.RTCPeerConnection.prototype.getStats = function() {\n        var promises = [];\n        this.transceivers.forEach(function(transceiver) {\n          ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n              'dtlsTransport'].forEach(function(method) {\n                if (transceiver[method]) {\n                  promises.push(transceiver[method].getStats());\n                }\n              });\n        });\n        var cb = arguments.length > 1 && typeof arguments[1] === 'function' &&\n            arguments[1];\n        return new Promise(function(resolve) {\n          // shim getStats with maplike support\n          var results = new Map();\n          Promise.all(promises).then(function(res) {\n            res.forEach(function(result) {\n              Object.keys(result).forEach(function(id) {\n                results.set(id, result[id]);\n                results[id] = result[id];\n              });\n            });\n            if (cb) {\n              window.setTimeout(cb, 0, results);\n            }\n            resolve(results);\n          });\n        });\n      };\n    }\n  };\n  \n  // Expose public methods.\n  module.exports = {\n    shimPeerConnection: edgeShim.shimPeerConnection,\n    shimGetUserMedia: require('./getusermedia')\n  };\n  \n  },{\"./getusermedia\":6,\"sdp\":1}],6:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n   /* eslint-env node */\n  'use strict';\n  \n  // Expose public methods.\n  module.exports = function() {\n    var shimError_ = function(e) {\n      return {\n        name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n        message: e.message,\n        constraint: e.constraint,\n        toString: function() {\n          return this.name;\n        }\n      };\n    };\n  \n    // getUserMedia error shim.\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      return origGetUserMedia(c).catch(function(e) {\n        return Promise.reject(shimError_(e));\n      });\n    };\n  };\n  \n  },{}],7:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n   /* eslint-env node */\n  'use strict';\n  \n  var browserDetails = require('../utils').browserDetails;\n  \n  var firefoxShim = {\n    shimOnTrack: function() {\n      if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n          window.RTCPeerConnection.prototype)) {\n        Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n          get: function() {\n            return this._ontrack;\n          },\n          set: function(f) {\n            if (this._ontrack) {\n              this.removeEventListener('track', this._ontrack);\n              this.removeEventListener('addstream', this._ontrackpoly);\n            }\n            this.addEventListener('track', this._ontrack = f);\n            this.addEventListener('addstream', this._ontrackpoly = function(e) {\n              e.stream.getTracks().forEach(function(track) {\n                var event = new Event('track');\n                event.track = track;\n                event.receiver = {track: track};\n                event.streams = [e.stream];\n                this.dispatchEvent(event);\n              }.bind(this));\n            }.bind(this));\n          }\n        });\n      }\n    },\n  \n    shimSourceObject: function() {\n      // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\n      if (typeof window === 'object') {\n        if (window.HTMLMediaElement &&\n          !('srcObject' in window.HTMLMediaElement.prototype)) {\n          // Shim the srcObject property, once, when HTMLMediaElement is found.\n          Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n            get: function() {\n              return this.mozSrcObject;\n            },\n            set: function(stream) {\n              this.mozSrcObject = stream;\n            }\n          });\n        }\n      }\n    },\n  \n    shimPeerConnection: function() {\n      if (typeof window !== 'object' || !(window.RTCPeerConnection ||\n          window.mozRTCPeerConnection)) {\n        return; // probably media.peerconnection.enabled=false in about:config\n      }\n      // The RTCPeerConnection object.\n      if (!window.RTCPeerConnection) {\n        window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n          if (browserDetails.version < 38) {\n            // .urls is not supported in FF < 38.\n            // create RTCIceServers with a single url.\n            if (pcConfig && pcConfig.iceServers) {\n              var newIceServers = [];\n              for (var i = 0; i < pcConfig.iceServers.length; i++) {\n                var server = pcConfig.iceServers[i];\n                if (server.hasOwnProperty('urls')) {\n                  for (var j = 0; j < server.urls.length; j++) {\n                    var newServer = {\n                      url: server.urls[j]\n                    };\n                    if (server.urls[j].indexOf('turn') === 0) {\n                      newServer.username = server.username;\n                      newServer.credential = server.credential;\n                    }\n                    newIceServers.push(newServer);\n                  }\n                } else {\n                  newIceServers.push(pcConfig.iceServers[i]);\n                }\n              }\n              pcConfig.iceServers = newIceServers;\n            }\n          }\n          return new mozRTCPeerConnection(pcConfig, pcConstraints);\n        };\n        window.RTCPeerConnection.prototype = mozRTCPeerConnection.prototype;\n  \n        // wrap static methods. Currently just generateCertificate.\n        if (mozRTCPeerConnection.generateCertificate) {\n          Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n            get: function() {\n              return mozRTCPeerConnection.generateCertificate;\n            }\n          });\n        }\n  \n        window.RTCSessionDescription = mozRTCSessionDescription;\n        window.RTCIceCandidate = mozRTCIceCandidate;\n      }\n  \n      // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n          .forEach(function(method) {\n            var nativeMethod = RTCPeerConnection.prototype[method];\n            RTCPeerConnection.prototype[method] = function() {\n              arguments[0] = new ((method === 'addIceCandidate') ?\n                  RTCIceCandidate : RTCSessionDescription)(arguments[0]);\n              return nativeMethod.apply(this, arguments);\n            };\n          });\n  \n      // support for addIceCandidate(null)\n      var nativeAddIceCandidate =\n          RTCPeerConnection.prototype.addIceCandidate;\n      RTCPeerConnection.prototype.addIceCandidate = function() {\n        return arguments[0] === null ? Promise.resolve()\n            : nativeAddIceCandidate.apply(this, arguments);\n      };\n  \n      // shim getStats with maplike support\n      var makeMapStats = function(stats) {\n        var map = new Map();\n        Object.keys(stats).forEach(function(key) {\n          map.set(key, stats[key]);\n          map[key] = stats[key];\n        });\n        return map;\n      };\n  \n      var nativeGetStats = RTCPeerConnection.prototype.getStats;\n      RTCPeerConnection.prototype.getStats = function(selector, onSucc, onErr) {\n        return nativeGetStats.apply(this, [selector || null])\n          .then(function(stats) {\n            return makeMapStats(stats);\n          })\n          .then(onSucc, onErr);\n      };\n    }\n  };\n  \n  // Expose public methods.\n  module.exports = {\n    shimOnTrack: firefoxShim.shimOnTrack,\n    shimSourceObject: firefoxShim.shimSourceObject,\n    shimPeerConnection: firefoxShim.shimPeerConnection,\n    shimGetUserMedia: require('./getusermedia')\n  };\n  \n  },{\"../utils\":10,\"./getusermedia\":8}],8:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n   /* eslint-env node */\n  'use strict';\n  \n  var logging = require('../utils').log;\n  var browserDetails = require('../utils').browserDetails;\n  \n  // Expose public methods.\n  module.exports = function() {\n    var shimError_ = function(e) {\n      return {\n        name: {\n          SecurityError: 'NotAllowedError',\n          PermissionDeniedError: 'NotAllowedError'\n        }[e.name] || e.name,\n        message: {\n          'The operation is insecure.': 'The request is not allowed by the ' +\n          'user agent or the platform in the current context.'\n        }[e.message] || e.message,\n        constraint: e.constraint,\n        toString: function() {\n          return this.name + (this.message && ': ') + this.message;\n        }\n      };\n    };\n  \n    // getUserMedia constraints shim.\n    var getUserMedia_ = function(constraints, onSuccess, onError) {\n      var constraintsToFF37_ = function(c) {\n        if (typeof c !== 'object' || c.require) {\n          return c;\n        }\n        var require = [];\n        Object.keys(c).forEach(function(key) {\n          if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n            return;\n          }\n          var r = c[key] = (typeof c[key] === 'object') ?\n              c[key] : {ideal: c[key]};\n          if (r.min !== undefined ||\n              r.max !== undefined || r.exact !== undefined) {\n            require.push(key);\n          }\n          if (r.exact !== undefined) {\n            if (typeof r.exact === 'number') {\n              r. min = r.max = r.exact;\n            } else {\n              c[key] = r.exact;\n            }\n            delete r.exact;\n          }\n          if (r.ideal !== undefined) {\n            c.advanced = c.advanced || [];\n            var oc = {};\n            if (typeof r.ideal === 'number') {\n              oc[key] = {min: r.ideal, max: r.ideal};\n            } else {\n              oc[key] = r.ideal;\n            }\n            c.advanced.push(oc);\n            delete r.ideal;\n            if (!Object.keys(r).length) {\n              delete c[key];\n            }\n          }\n        });\n        if (require.length) {\n          c.require = require;\n        }\n        return c;\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      if (browserDetails.version < 38) {\n        logging('spec: ' + JSON.stringify(constraints));\n        if (constraints.audio) {\n          constraints.audio = constraintsToFF37_(constraints.audio);\n        }\n        if (constraints.video) {\n          constraints.video = constraintsToFF37_(constraints.video);\n        }\n        logging('ff37: ' + JSON.stringify(constraints));\n      }\n      return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\n        onError(shimError_(e));\n      });\n    };\n  \n    // Returns the result of getUserMedia as a Promise.\n    var getUserMediaPromise_ = function(constraints) {\n      return new Promise(function(resolve, reject) {\n        getUserMedia_(constraints, resolve, reject);\n      });\n    };\n  \n    // Shim for mediaDevices on older versions.\n    if (!navigator.mediaDevices) {\n      navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\n        addEventListener: function() { },\n        removeEventListener: function() { }\n      };\n    }\n    navigator.mediaDevices.enumerateDevices =\n        navigator.mediaDevices.enumerateDevices || function() {\n          return new Promise(function(resolve) {\n            var infos = [\n              {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\n              {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\n            ];\n            resolve(infos);\n          });\n        };\n  \n    if (browserDetails.version < 41) {\n      // Work around http://bugzil.la/1169665\n      var orgEnumerateDevices =\n          navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\n      navigator.mediaDevices.enumerateDevices = function() {\n        return orgEnumerateDevices().then(undefined, function(e) {\n          if (e.name === 'NotFoundError') {\n            return [];\n          }\n          throw e;\n        });\n      };\n    }\n    if (browserDetails.version < 49) {\n      var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n          bind(navigator.mediaDevices);\n      navigator.mediaDevices.getUserMedia = function(c) {\n        return origGetUserMedia(c).catch(function(e) {\n          return Promise.reject(shimError_(e));\n        });\n      };\n    }\n    navigator.getUserMedia = function(constraints, onSuccess, onError) {\n      if (browserDetails.version < 44) {\n        return getUserMedia_(constraints, onSuccess, onError);\n      }\n      // Replace Firefox 44+'s deprecation warning with unprefixed version.\n      console.warn('navigator.getUserMedia has been replaced by ' +\n                   'navigator.mediaDevices.getUserMedia');\n      navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n    };\n  };\n  \n  },{\"../utils\":10}],9:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  'use strict';\n  var safariShim = {\n    // TODO: DrAlex, should be here, double check against LayoutTests\n    // shimOnTrack: function() { },\n  \n    // TODO: once the back-end for the mac port is done, add.\n    // TODO: check for webkitGTK+\n    // shimPeerConnection: function() { },\n  \n    shimGetUserMedia: function() {\n      navigator.getUserMedia = navigator.webkitGetUserMedia;\n    }\n  };\n  \n  // Expose public methods.\n  module.exports = {\n    shimGetUserMedia: safariShim.shimGetUserMedia\n    // TODO\n    // shimOnTrack: safariShim.shimOnTrack,\n    // shimPeerConnection: safariShim.shimPeerConnection\n  };\n  \n  },{}],10:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n   /* eslint-env node */\n  'use strict';\n  \n  var logDisabled_ = true;\n  \n  // Utility methods.\n  var utils = {\n    disableLog: function(bool) {\n      if (typeof bool !== 'boolean') {\n        return new Error('Argument type: ' + typeof bool +\n            '. Please use a boolean.');\n      }\n      logDisabled_ = bool;\n      return (bool) ? 'adapter.js logging disabled' :\n          'adapter.js logging enabled';\n    },\n  \n    log: function() {\n      if (typeof window === 'object') {\n        if (logDisabled_) {\n          return;\n        }\n        if (typeof console !== 'undefined' && typeof console.log === 'function') {\n          console.log.apply(console, arguments);\n        }\n      }\n    },\n  \n    /**\n     * Extract browser version out of the provided user agent string.\n     *\n     * @param {!string} uastring userAgent string.\n     * @param {!string} expr Regular expression used as match criteria.\n     * @param {!number} pos position in the version string to be returned.\n     * @return {!number} browser version.\n     */\n    extractVersion: function(uastring, expr, pos) {\n      var match = uastring.match(expr);\n      return match && match.length >= pos && parseInt(match[pos], 10);\n    },\n  \n    /**\n     * Browser detector.\n     *\n     * @return {object} result containing browser and version\n     *     properties.\n     */\n    detectBrowser: function() {\n      // Returned result object.\n      var result = {};\n      result.browser = null;\n      result.version = null;\n  \n      // Fail early if it's not a browser\n      if (typeof window === 'undefined' || !window.navigator) {\n        result.browser = 'Not a browser.';\n        return result;\n      }\n  \n      // Firefox.\n      if (navigator.mozGetUserMedia) {\n        result.browser = 'firefox';\n        result.version = this.extractVersion(navigator.userAgent,\n            /Firefox\\/([0-9]+)\\./, 1);\n  \n      // all webkit-based browsers\n      } else if (navigator.webkitGetUserMedia) {\n        // Chrome, Chromium, Webview, Opera, all use the chrome shim for now\n        if (window.webkitRTCPeerConnection) {\n          result.browser = 'chrome';\n          result.version = this.extractVersion(navigator.userAgent,\n            /Chrom(e|ium)\\/([0-9]+)\\./, 2);\n  \n        // Safari or unknown webkit-based\n        // for the time being Safari has support for MediaStreams but not webRTC\n        } else {\n          // Safari UA substrings of interest for reference:\n          // - webkit version:           AppleWebKit/602.1.25 (also used in Op,Cr)\n          // - safari UI version:        Version/9.0.3 (unique to Safari)\n          // - safari UI webkit version: Safari/601.4.4 (also used in Op,Cr)\n          //\n          // if the webkit version and safari UI webkit versions are equals,\n          // ... this is a stable version.\n          //\n          // only the internal webkit version is important today to know if\n          // media streams are supported\n          //\n          if (navigator.userAgent.match(/Version\\/(\\d+).(\\d+)/)) {\n            result.browser = 'safari';\n            result.version = this.extractVersion(navigator.userAgent,\n              /AppleWebKit\\/([0-9]+)\\./, 1);\n  \n          // unknown webkit-based browser\n          } else {\n            result.browser = 'Unsupported webkit-based browser ' +\n                'with GUM support but no WebRTC support.';\n            return result;\n          }\n        }\n  \n      // Edge.\n      } else if (navigator.mediaDevices &&\n          navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\n        result.browser = 'edge';\n        result.version = this.extractVersion(navigator.userAgent,\n            /Edge\\/(\\d+).(\\d+)$/, 2);\n  \n      // Default fallthrough: not supported.\n      } else {\n        result.browser = 'Not a supported browser.';\n        return result;\n      }\n  \n      return result;\n    }\n  };\n  \n  // Export.\n  module.exports = {\n    log: utils.log,\n    disableLog: utils.disableLog,\n    browserDetails: utils.detectBrowser(),\n    extractVersion: utils.extractVersion\n  };\n  \n  },{}]},{},[2])(2)\n});\n/* jshint ignore:end */\n\n  // END OF INJECTION OF GOOGLE'S ADAPTER.JS CONTENT\n  ///////////////////////////////////////////////////////////////////\n\n  AdapterJS.parseWebrtcDetectedBrowser();\n\n  ///////////////////////////////////////////////////////////////////\n  // EXTENSION FOR CHROME, FIREFOX AND EDGE\n  // Includes legacy functions\n  // -- createIceServer\n  // -- createIceServers\n  // -- MediaStreamTrack.getSources\n  //\n  // and additional shims\n  // -- attachMediaStream\n  // -- reattachMediaStream\n  // -- requestUserMedia\n  // -- a call to AdapterJS.maybeThroughWebRTCReady (notifies WebRTC is ready)\n\n  // Add support for legacy functions createIceServer and createIceServers\n  if ( navigator.mozGetUserMedia ) {\n    // Shim for MediaStreamTrack.getSources.\n    MediaStreamTrack.getSources = function(successCb) {\n      setTimeout(function() {\n        var infos = [\n          { kind: 'audio', id: 'default', label:'', facing:'' },\n          { kind: 'video', id: 'default', label:'', facing:'' }\n        ];\n        successCb(infos);\n      }, 0);\n    };\n\n    createIceServer = function (url, username, password) {\n      console.warn('createIceServer is deprecated. It should be replaced with an application level implementation.');\n      // Note: Google's import of AJS will auto-reverse to 'url': '...' for FF < 38\n\n      var iceServer = null;\n      var urlParts = url.split(':');\n      if (urlParts[0].indexOf('stun') === 0) {\n        iceServer = { urls : [url] };\n      } else if (urlParts[0].indexOf('turn') === 0) {\n        if (webrtcDetectedVersion < 27) {\n          var turnUrlParts = url.split('?');\n          if (turnUrlParts.length === 1 ||\n            turnUrlParts[1].indexOf('transport=udp') === 0) {\n            iceServer = {\n              urls : [turnUrlParts[0]],\n              credential : password,\n              username : username\n            };\n          }\n        } else {\n          iceServer = {\n            urls : [url],\n            credential : password,\n            username : username\n          };\n        }\n      }\n      return iceServer;\n    };\n\n    createIceServers = function (urls, username, password) {\n      console.warn('createIceServers is deprecated. It should be replaced with an application level implementation.');\n\n      var iceServers = [];\n      for (i = 0; i < urls.length; i++) {\n        var iceServer = createIceServer(urls[i], username, password);\n        if (iceServer !== null) {\n          iceServers.push(iceServer);\n        }\n      }\n      return iceServers;\n    };\n  } else if ( navigator.webkitGetUserMedia ) {\n    createIceServer = function (url, username, password) {\n      console.warn('createIceServer is deprecated. It should be replaced with an application level implementation.');\n\n      var iceServer = null;\n      var urlParts = url.split(':');\n      if (urlParts[0].indexOf('stun') === 0) {\n        iceServer = { 'url' : url };\n      } else if (urlParts[0].indexOf('turn') === 0) {\n        iceServer = {\n          'url' : url,\n          'credential' : password,\n          'username' : username\n        };\n      }\n      return iceServer;\n    };\n\n    createIceServers = function (urls, username, password) {\n      console.warn('createIceServers is deprecated. It should be replaced with an application level implementation.');\n\n      var iceServers = [];\n      if (webrtcDetectedVersion >= 34) {\n        iceServers = {\n          'urls' : urls,\n          'credential' : password,\n          'username' : username\n        };\n      } else {\n        for (i = 0; i < urls.length; i++) {\n          var iceServer = createIceServer(urls[i], username, password);\n          if (iceServer !== null) {\n            iceServers.push(iceServer);\n          }\n        }\n      }\n      return iceServers;\n    };\n  }\n\n  // adapter.js by Google currently doesn't suppport\n  // attachMediaStream and reattachMediaStream for Egde\n  if (navigator.mediaDevices && navigator.userAgent.match(\n      /Edge\\/(\\d+).(\\d+)$/)) {\n    getUserMedia = window.getUserMedia = navigator.getUserMedia.bind(navigator);\n    attachMediaStream = function(element, stream) {\n      element.srcObject = stream;\n      return element;\n    };\n    reattachMediaStream = function(to, from) {\n      to.srcObject = from.srcObject;\n      return to;\n    };\n  }\n\n  // Need to override attachMediaStream and reattachMediaStream\n  // to support the plugin's logic\n    if (attachMediaStream) {\n\tattachMediaStream_base = attachMediaStream;\n\tattachMediaStream = function (element, stream) {\n\t    if ((webrtcDetectedBrowser === 'chrome' ||\n\t\t webrtcDetectedBrowser === 'opera') && \n\t\t!stream) {\n\t\t// Chrome does not support \"src = null\"\n\t\telement.src = '';\n\t    } else {\n\t\tattachMediaStream_base(element, stream);\n\t    }\n\t    return element;\n\t};\n    }\n    if (reattachMediaStream) {\n\treattachMediaStream_base = reattachMediaStream;\n\treattachMediaStream = function (to, from) {\n\t    reattachMediaStream_base(to, from);\n\t    return to;\n\t};\n    }\n\n  // Propagate attachMediaStream and gUM in window and AdapterJS\n  window.attachMediaStream      = attachMediaStream;\n  window.reattachMediaStream    = reattachMediaStream;\n  window.getUserMedia           = getUserMedia;\n  AdapterJS.attachMediaStream   = attachMediaStream;\n  AdapterJS.reattachMediaStream = reattachMediaStream;\n  AdapterJS.getUserMedia        = getUserMedia;\n\n  // Removed Google defined promises when promise is not defined\n  if (typeof Promise === 'undefined') {\n    requestUserMedia = null;\n  }\n\n  AdapterJS.maybeThroughWebRTCReady();\n\n  // END OF EXTENSION OF CHROME, FIREFOX AND EDGE\n  ///////////////////////////////////////////////////////////////////\n\n} else { // TRY TO USE PLUGIN\n\n  ///////////////////////////////////////////////////////////////////\n  // WEBRTC PLUGIN SHIM\n  // Will automatically check if the plugin is available and inject it\n  // into the DOM if it is.\n  // When the plugin is not available, will prompt a banner to suggest installing it\n  // Use AdapterJS.options.hidePluginInstallPrompt to prevent this banner from popping\n  //\n  // Shims the follwing:\n  // -- getUserMedia\n  // -- MediaStreamTrack\n  // -- MediaStreamTrack.getSources\n  // -- RTCPeerConnection\n  // -- RTCSessionDescription\n  // -- RTCIceCandidate\n  // -- createIceServer\n  // -- createIceServers\n  // -- attachMediaStream\n  // -- reattachMediaStream\n  // -- webrtcDetectedBrowser\n  // -- webrtcDetectedVersion\n\n  // IE 9 is not offering an implementation of console.log until you open a console\n  if (typeof console !== 'object' || typeof console.log !== 'function') {\n    /* jshint -W020 */\n    console = {} || console;\n    // Implemented based on console specs from MDN\n    // You may override these functions\n    console.log = function (arg) {};\n    console.info = function (arg) {};\n    console.error = function (arg) {};\n    console.dir = function (arg) {};\n    console.exception = function (arg) {};\n    console.trace = function (arg) {};\n    console.warn = function (arg) {};\n    console.count = function (arg) {};\n    console.debug = function (arg) {};\n    console.count = function (arg) {};\n    console.time = function (arg) {};\n    console.timeEnd = function (arg) {};\n    console.group = function (arg) {};\n    console.groupCollapsed = function (arg) {};\n    console.groupEnd = function (arg) {};\n    /* jshint +W020 */\n  }\n  AdapterJS.parseWebrtcDetectedBrowser();\n  isIE = webrtcDetectedBrowser === 'IE';\n\n  /* jshint -W035 */\n  AdapterJS.WebRTCPlugin.WaitForPluginReady = function() {\n    while (AdapterJS.WebRTCPlugin.pluginState !== AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY) {\n      /* empty because it needs to prevent the function from running. */\n    }\n  };\n  /* jshint +W035 */\n\n  AdapterJS.WebRTCPlugin.callWhenPluginReady = function (callback) {\n    if (AdapterJS.WebRTCPlugin.pluginState === AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY) {\n      // Call immediately if possible\n      // Once the plugin is set, the code will always take this path\n      callback();\n    } else {\n      // otherwise start a 100ms interval\n      var checkPluginReadyState = setInterval(function () {\n        if (AdapterJS.WebRTCPlugin.pluginState === AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY) {\n          clearInterval(checkPluginReadyState);\n          callback();\n        }\n      }, 100);\n    }\n  };\n\n  AdapterJS.WebRTCPlugin.setLogLevel = function(logLevel) {\n    AdapterJS.WebRTCPlugin.callWhenPluginReady(function() {\n      AdapterJS.WebRTCPlugin.plugin.setLogLevel(logLevel);\n    });\n  };\n\n  AdapterJS.WebRTCPlugin.injectPlugin = function () {\n    // only inject once the page is ready\n    if (document.readyState !== 'complete') {\n      return;\n    }\n\n    // Prevent multiple injections\n    if (AdapterJS.WebRTCPlugin.pluginState !== AdapterJS.WebRTCPlugin.PLUGIN_STATES.INITIALIZING) {\n      return;\n    }\n\n    AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.INJECTING;\n\n    if (webrtcDetectedBrowser === 'IE' && webrtcDetectedVersion <= 10) {\n      var frag = document.createDocumentFragment();\n      AdapterJS.WebRTCPlugin.plugin = document.createElement('div');\n      AdapterJS.WebRTCPlugin.plugin.innerHTML = '<object id=\"' +\n        AdapterJS.WebRTCPlugin.pluginInfo.pluginId + '\" type=\"' +\n        AdapterJS.WebRTCPlugin.pluginInfo.type + '\" ' + 'width=\"1\" height=\"1\">' +\n        '<param name=\"pluginId\" value=\"' +\n        AdapterJS.WebRTCPlugin.pluginInfo.pluginId + '\" /> ' +\n        '<param name=\"windowless\" value=\"false\" /> ' +\n        '<param name=\"pageId\" value=\"' + AdapterJS.WebRTCPlugin.pageId + '\" /> ' +\n        '<param name=\"onload\" value=\"' + AdapterJS.WebRTCPlugin.pluginInfo.onload + '\" />' +\n        '<param name=\"tag\" value=\"' + AdapterJS.WebRTCPlugin.TAGS.NONE + '\" />' +\n        // uncomment to be able to use virtual cams\n        (AdapterJS.options.getAllCams ? '<param name=\"forceGetAllCams\" value=\"True\" />':'') +\n\n        '</object>';\n      while (AdapterJS.WebRTCPlugin.plugin.firstChild) {\n        frag.appendChild(AdapterJS.WebRTCPlugin.plugin.firstChild);\n      }\n      document.body.appendChild(frag);\n\n      // Need to re-fetch the plugin\n      AdapterJS.WebRTCPlugin.plugin =\n        document.getElementById(AdapterJS.WebRTCPlugin.pluginInfo.pluginId);\n    } else {\n      // Load Plugin\n      AdapterJS.WebRTCPlugin.plugin = document.createElement('object');\n      AdapterJS.WebRTCPlugin.plugin.id =\n        AdapterJS.WebRTCPlugin.pluginInfo.pluginId;\n      // IE will only start the plugin if it's ACTUALLY visible\n      if (isIE) {\n        AdapterJS.WebRTCPlugin.plugin.width = '1px';\n        AdapterJS.WebRTCPlugin.plugin.height = '1px';\n      } else { // The size of the plugin on Safari should be 0x0px\n              // so that the autorisation prompt is at the top\n        AdapterJS.WebRTCPlugin.plugin.width = '0px';\n        AdapterJS.WebRTCPlugin.plugin.height = '0px';\n      }\n      AdapterJS.WebRTCPlugin.plugin.type = AdapterJS.WebRTCPlugin.pluginInfo.type;\n      AdapterJS.WebRTCPlugin.plugin.innerHTML = '<param name=\"onload\" value=\"' +\n        AdapterJS.WebRTCPlugin.pluginInfo.onload + '\">' +\n        '<param name=\"pluginId\" value=\"' +\n        AdapterJS.WebRTCPlugin.pluginInfo.pluginId + '\">' +\n        '<param name=\"windowless\" value=\"false\" /> ' +\n        (AdapterJS.options.getAllCams ? '<param name=\"forceGetAllCams\" value=\"True\" />':'') +\n        '<param name=\"pageId\" value=\"' + AdapterJS.WebRTCPlugin.pageId + '\">' +\n        '<param name=\"tag\" value=\"' + AdapterJS.WebRTCPlugin.TAGS.NONE + '\" />';\n      document.body.appendChild(AdapterJS.WebRTCPlugin.plugin);\n    }\n\n\n    AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.INJECTED;\n  };\n\n  AdapterJS.WebRTCPlugin.isPluginInstalled =\n    function (comName, plugName, installedCb, notInstalledCb) {\n    if (!isIE) {\n      var pluginArray = navigator.plugins;\n      for (var i = 0; i < pluginArray.length; i++) {\n        if (pluginArray[i].name.indexOf(plugName) >= 0) {\n          installedCb();\n          return;\n        }\n      }\n      notInstalledCb();\n    } else {\n      try {\n        var axo = new ActiveXObject(comName + '.' + plugName);\n      } catch (e) {\n        notInstalledCb();\n        return;\n      }\n      installedCb();\n    }\n  };\n\n  AdapterJS.WebRTCPlugin.defineWebRTCInterface = function () {\n    if (AdapterJS.WebRTCPlugin.pluginState ===\n        AdapterJS.WebRTCPlugin.PLUGIN_STATES.READY) {\n      console.error('AdapterJS - WebRTC interface has already been defined');\n      return;\n    }\n\n    AdapterJS.WebRTCPlugin.pluginState = AdapterJS.WebRTCPlugin.PLUGIN_STATES.INITIALIZING;\n\n    AdapterJS.isDefined = function (variable) {\n      return variable !== null && variable !== undefined;\n    };\n\n    createIceServer = function (url, username, password) {\n      var iceServer = null;\n      var urlParts = url.split(':');\n      if (urlParts[0].indexOf('stun') === 0) {\n        iceServer = {\n          'url' : url,\n          'hasCredentials' : false\n        };\n      } else if (urlParts[0].indexOf('turn') === 0) {\n        iceServer = {\n          'url' : url,\n          'hasCredentials' : true,\n          'credential' : password,\n          'username' : username\n        };\n      }\n      return iceServer;\n    };\n\n    createIceServers = function (urls, username, password) {\n      var iceServers = [];\n      for (var i = 0; i < urls.length; ++i) {\n        iceServers.push(createIceServer(urls[i], username, password));\n      }\n      return iceServers;\n    };\n\n    RTCSessionDescription = function (info) {\n      AdapterJS.WebRTCPlugin.WaitForPluginReady();\n      return AdapterJS.WebRTCPlugin.plugin.\n        ConstructSessionDescription(info.type, info.sdp);\n    };\n\n    RTCPeerConnection = function (servers, constraints) {\n      // Validate server argumenr\n      if (!(servers === undefined ||\n            servers === null ||\n            Array.isArray(servers.iceServers))) {\n        throw new Error('Failed to construct \\'RTCPeerConnection\\': Malformed RTCConfiguration');\n      }\n\n      // Validate constraints argument\n      if (typeof constraints !== 'undefined' && constraints !== null) {\n        var invalidConstraits = false;\n        invalidConstraits |= typeof constraints !== 'object';\n        invalidConstraits |= constraints.hasOwnProperty('mandatory') && \n                              constraints.mandatory !== undefined && \n                              constraints.mandatory !== null && \n                              constraints.mandatory.constructor !== Object;\n        invalidConstraits |= constraints.hasOwnProperty('optional') && \n                              constraints.optional !== undefined &&\n                              constraints.optional !== null &&\n                              !Array.isArray(constraints.optional);\n        if (invalidConstraits) {\n          throw new Error('Failed to construct \\'RTCPeerConnection\\': Malformed constraints object');\n        }\n      }\n\n      // Call relevant PeerConnection constructor according to plugin version\n      AdapterJS.WebRTCPlugin.WaitForPluginReady();\n\n      // RTCPeerConnection prototype from the old spec\n      var iceServers = null;\n      if (servers && Array.isArray(servers.iceServers)) {\n        iceServers = servers.iceServers;\n        for (var i = 0; i < iceServers.length; i++) {\n          // Legacy plugin versions compatibility\n          if (iceServers[i].urls && !iceServers[i].url) {\n            iceServers[i].url = iceServers[i].urls;\n          }\n          iceServers[i].hasCredentials = AdapterJS.\n            isDefined(iceServers[i].username) &&\n            AdapterJS.isDefined(iceServers[i].credential);\n        }\n      }\n\n      if (AdapterJS.WebRTCPlugin.plugin.PEER_CONNECTION_VERSION &&\n          AdapterJS.WebRTCPlugin.plugin.PEER_CONNECTION_VERSION > 1) {\n        // RTCPeerConnection prototype from the new spec\n        if (iceServers) {\n          servers.iceServers = iceServers;\n        }\n        return AdapterJS.WebRTCPlugin.plugin.PeerConnection(servers);\n      } else {\n        var mandatory = (constraints && constraints.mandatory) ?\n          constraints.mandatory : null;\n        var optional = (constraints && constraints.optional) ?\n          constraints.optional : null;\n        return AdapterJS.WebRTCPlugin.plugin.\n          PeerConnection(AdapterJS.WebRTCPlugin.pageId,\n          iceServers, mandatory, optional);\n      }\n    };\n\n    MediaStreamTrack = function(){};\n    MediaStreamTrack.getSources = function (callback) {\n      AdapterJS.WebRTCPlugin.callWhenPluginReady(function() {\n        AdapterJS.WebRTCPlugin.plugin.GetSources(callback);\n      });\n    };\n\n    getUserMedia = function (constraints, successCallback, failureCallback) {\n      constraints.audio = constraints.audio || false;\n      constraints.video = constraints.video || false;\n\n      AdapterJS.WebRTCPlugin.callWhenPluginReady(function() {\n        AdapterJS.WebRTCPlugin.plugin.\n          getUserMedia(constraints, successCallback, failureCallback);\n      });\n    };\n    window.navigator.getUserMedia = getUserMedia;\n\n    // Defined mediaDevices when promises are available\n    if ( !navigator.mediaDevices &&\n      typeof Promise !== 'undefined') {\n      requestUserMedia = function(constraints) {\n        return new Promise(function(resolve, reject) {\n          getUserMedia(constraints, resolve, reject);\n        });\n      };\n      navigator.mediaDevices = {getUserMedia: requestUserMedia,\n                                enumerateDevices: function() {\n        return new Promise(function(resolve) {\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\n          return MediaStreamTrack.getSources(function(devices) {\n            resolve(devices.map(function(device) {\n              return {label: device.label,\n                      kind: kinds[device.kind],\n                      id: device.id,\n                      deviceId: device.id,\n                      groupId: ''};\n            }));\n          });\n        });\n      }};\n    }\n\n    attachMediaStream = function (element, stream) {\n      if (!element || !element.parentNode) {\n        return;\n      }\n\n      var streamId;\n      if (stream === null) {\n        streamId = '';\n      } else {\n        if (typeof stream.enableSoundTracks !== 'undefined') {\n          stream.enableSoundTracks(true);\n        }\n        streamId = stream.id;\n      }\n\n      var elementId = element.id.length === 0 ? Math.random().toString(36).slice(2) : element.id;\n      var nodeName = element.nodeName.toLowerCase();\n      if (nodeName !== 'object') { // not a plugin <object> tag yet\n        var tag;\n        switch(nodeName) {\n          case 'audio':\n            tag = AdapterJS.WebRTCPlugin.TAGS.AUDIO;\n            break;\n          case 'video':\n            tag = AdapterJS.WebRTCPlugin.TAGS.VIDEO;\n            break;\n          default:\n            tag = AdapterJS.WebRTCPlugin.TAGS.NONE;\n          }\n\n        var frag = document.createDocumentFragment();\n        var temp = document.createElement('div');\n        var classHTML = '';\n        if (element.className) {\n          classHTML = 'class=\"' + element.className + '\" ';\n        } else if (element.attributes && element.attributes['class']) {\n          classHTML = 'class=\"' + element.attributes['class'].value + '\" ';\n        }\n\n        temp.innerHTML = '<object id=\"' + elementId + '\" ' + classHTML +\n          'type=\"' + AdapterJS.WebRTCPlugin.pluginInfo.type + '\">' +\n          '<param name=\"pluginId\" value=\"' + elementId + '\" /> ' +\n          '<param name=\"pageId\" value=\"' + AdapterJS.WebRTCPlugin.pageId + '\" /> ' +\n          '<param name=\"windowless\" value=\"true\" /> ' +\n          '<param name=\"streamId\" value=\"' + streamId + '\" /> ' +\n          '<param name=\"tag\" value=\"' + tag + '\" /> ' +\n          '</object>';\n        while (temp.firstChild) {\n          frag.appendChild(temp.firstChild);\n        }\n\n        var height = '';\n        var width = '';\n        if (element.clientWidth || element.clientHeight) {\n          width = element.clientWidth;\n          height = element.clientHeight;\n        }\n        else if (element.width || element.height) {\n          width = element.width;\n          height = element.height;\n        }\n\n        element.parentNode.insertBefore(frag, element);\n        frag = document.getElementById(elementId);\n        frag.width = width;\n        frag.height = height;\n        element.parentNode.removeChild(element);\n      } else { // already an <object> tag, just change the stream id\n        var children = element.children;\n        for (var i = 0; i !== children.length; ++i) {\n          if (children[i].name === 'streamId') {\n            children[i].value = streamId;\n            break;\n          }\n        }\n        element.setStreamId(streamId);\n      }\n      var newElement = document.getElementById(elementId);\n      AdapterJS.forwardEventHandlers(newElement, element, Object.getPrototypeOf(element));\n\n      return newElement;\n    };\n\n    reattachMediaStream = function (to, from) {\n      var stream = null;\n      var children = from.children;\n      for (var i = 0; i !== children.length; ++i) {\n        if (children[i].name === 'streamId') {\n          AdapterJS.WebRTCPlugin.WaitForPluginReady();\n          stream = AdapterJS.WebRTCPlugin.plugin\n            .getStreamWithId(AdapterJS.WebRTCPlugin.pageId, children[i].value);\n          break;\n        }\n      }\n      if (stream !== null) {\n        return attachMediaStream(to, stream);\n      } else {\n        console.log('Could not find the stream associated with this element');\n      }\n    };\n\n    // Propagate attachMediaStream and gUM in window and AdapterJS\n    window.attachMediaStream      = attachMediaStream;\n    window.reattachMediaStream    = reattachMediaStream;\n    window.getUserMedia           = getUserMedia;\n    AdapterJS.attachMediaStream   = attachMediaStream;\n    AdapterJS.reattachMediaStream = reattachMediaStream;\n    AdapterJS.getUserMedia        = getUserMedia;\n\n    AdapterJS.forwardEventHandlers = function (destElem, srcElem, prototype) {\n      properties = Object.getOwnPropertyNames( prototype );\n      for(var prop in properties) {\n        if (prop) {\n          propName = properties[prop];\n\n          if (typeof propName.slice === 'function' &&\n              propName.slice(0,2) === 'on' && \n              typeof srcElem[propName] === 'function') {\n              AdapterJS.addEvent(destElem, propName.slice(2), srcElem[propName]);\n          }\n        }\n      }\n      var subPrototype = Object.getPrototypeOf(prototype);\n      if(!!subPrototype) {\n        AdapterJS.forwardEventHandlers(destElem, srcElem, subPrototype);\n      }\n    };\n\n    RTCIceCandidate = function (candidate) {\n      if (!candidate.sdpMid) {\n        candidate.sdpMid = '';\n      }\n\n      AdapterJS.WebRTCPlugin.WaitForPluginReady();\n      return AdapterJS.WebRTCPlugin.plugin.ConstructIceCandidate(\n        candidate.sdpMid, candidate.sdpMLineIndex, candidate.candidate\n      );\n    };\n\n    // inject plugin\n    AdapterJS.addEvent(document, 'readystatechange', AdapterJS.WebRTCPlugin.injectPlugin);\n    AdapterJS.WebRTCPlugin.injectPlugin();\n  };\n\n  // This function will be called if the plugin is needed (browser different\n  // from Chrome or Firefox), but the plugin is not installed.\n  AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb = AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb ||\n    function() {\n      AdapterJS.addEvent(document,\n                        'readystatechange',\n                         AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv);\n      AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv();\n    };\n\n  AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCbPriv = function () {\n    if (AdapterJS.options.hidePluginInstallPrompt) {\n      return;\n    }\n\n    var downloadLink = AdapterJS.WebRTCPlugin.pluginInfo.downloadLink;\n    if(downloadLink) { // if download link\n      var popupString;\n      if (AdapterJS.WebRTCPlugin.pluginInfo.portalLink) { // is portal link\n       popupString = 'This website requires you to install the ' +\n        ' <a href=\"' + AdapterJS.WebRTCPlugin.pluginInfo.portalLink +\n        '\" target=\"_blank\">' + AdapterJS.WebRTCPlugin.pluginInfo.companyName +\n        ' WebRTC Plugin</a>' +\n        ' to work on this browser.';\n      } else { // no portal link, just print a generic explanation\n       popupString = AdapterJS.TEXT.PLUGIN.REQUIRE_INSTALLATION;\n      }\n\n      AdapterJS.renderNotificationBar(popupString, AdapterJS.TEXT.PLUGIN.BUTTON, downloadLink);\n    } else { // no download link, just print a generic explanation\n      AdapterJS.renderNotificationBar(AdapterJS.TEXT.PLUGIN.NOT_SUPPORTED);\n    }\n  };\n\n  // Try to detect the plugin and act accordingly\n  AdapterJS.WebRTCPlugin.isPluginInstalled(\n    AdapterJS.WebRTCPlugin.pluginInfo.prefix,\n    AdapterJS.WebRTCPlugin.pluginInfo.plugName,\n    AdapterJS.WebRTCPlugin.defineWebRTCInterface,\n    AdapterJS.WebRTCPlugin.pluginNeededButNotInstalledCb);\n\n  // END OF WEBRTC PLUGIN SHIM\n  ///////////////////////////////////////////////////////////////////\n}\n\n// Last time updated at Oct 24, 2015, 08:32:23\n\n// Latest file can be found here: https://cdn.webrtc-experiment.com/getScreenId.js\n\n// Muaz Khan         - www.MuazKhan.com\n// MIT License       - www.WebRTC-Experiment.com/licence\n// Documentation     - https://github.com/muaz-khan/getScreenId.\n\n// ______________\n// getScreenId.js\n\n/*\ngetScreenId(function (error, sourceId, screen_constraints) {\n    // error    == null || 'permission-denied' || 'not-installed' || 'installed-disabled' || 'not-chrome'\n    // sourceId == null || 'string' || 'firefox'\n\n    if(sourceId == 'firefox') {\n        navigator.mozGetUserMedia(screen_constraints, onSuccess, onFailure);\n    }\n    else navigator.webkitGetUserMedia(screen_constraints, onSuccess, onFailure);\n});\n*/\n\n(function() {\n    window.getScreenId = function(callback) {\n        // for Firefox:\n        // sourceId == 'firefox'\n        // screen_constraints = {...}\n        if (!!navigator.mozGetUserMedia) {\n            callback(null, 'firefox', {\n                video: {\n                    mozMediaSource: 'window',\n                    mediaSource: 'window'\n                }\n            });\n            return;\n        }\n\n        postMessage();\n\n        window.addEventListener('message', onIFrameCallback);\n\n        function onIFrameCallback(event) {\n            if (!event.data) return;\n\n            if (event.data.chromeMediaSourceId) {\n                if (event.data.chromeMediaSourceId === 'PermissionDeniedError') {\n                    callback('permission-denied');\n                } else callback(null, event.data.chromeMediaSourceId, getScreenConstraints(null, event.data.chromeMediaSourceId));\n            }\n\n            if (event.data.chromeExtensionStatus) {\n                callback(event.data.chromeExtensionStatus, null, getScreenConstraints(event.data.chromeExtensionStatus));\n            }\n\n            // this event listener is no more needed\n            window.removeEventListener('message', onIFrameCallback);\n        }\n    };\n\n    function getScreenConstraints(error, sourceId) {\n        var screen_constraints = {\n            audio: false,\n            video: {\n                mandatory: {\n                    chromeMediaSource: error ? 'screen' : 'desktop',\n                    maxWidth: window.screen.width > 1920 ? window.screen.width : 1920,\n                    maxHeight: window.screen.height > 1080 ? window.screen.height : 1080\n                },\n                optional: []\n            }\n        };\n\n        if (sourceId) {\n            screen_constraints.video.mandatory.chromeMediaSourceId = sourceId;\n        }\n\n        return screen_constraints;\n    }\n\n    function postMessage() {\n        if (!iframe) {\n            loadIFrame(postMessage);\n            return;\n        }\n\n        if (!iframe.isLoaded) {\n            setTimeout(postMessage, 100);\n            return;\n        }\n\n        iframe.contentWindow.postMessage({\n            captureSourceId: true\n        }, '*');\n    }\n\n    function loadIFrame(loadCallback) {\n        if (iframe) {\n            loadCallback();\n            return;\n        }\n\n        iframe = document.createElement('iframe');\n        iframe.onload = function() {\n            iframe.isLoaded = true;\n\n            loadCallback();\n        };\n        iframe.src = 'https://www.webrtc-experiment.com/getSourceId/'; // https://wwww.yourdomain.com/getScreenId.html\n        iframe.style.display = 'none';\n        (document.body || document.documentElement).appendChild(iframe);\n    }\n\n    var iframe;\n\n    // this function is used in v3.0\n    window.getScreenConstraints = function(callback) {\n        loadIFrame(function() {\n            getScreenId(function(error, sourceId, screen_constraints) {\n                callback(error, screen_constraints.video);\n            });\n        });\n    };\n})();\n\n(function() {\n    if(document.domain.indexOf('webrtc-experiment.com') === -1) {\n        return;\n    }\n\n    window.getScreenId = function(callback) {\n        // for Firefox:\n        // sourceId == 'firefox'\n        // screen_constraints = {...}\n        if (!!navigator.mozGetUserMedia) {\n            callback(null, 'firefox', {\n                video: {\n                    mozMediaSource: 'window',\n                    mediaSource: 'window'\n                }\n            });\n            return;\n        }\n\n        postMessage();\n\n        window.addEventListener('message', onIFrameCallback);\n\n        function onIFrameCallback(event) {\n            if (!event.data) return;\n\n            if (event.data.chromeMediaSourceId) {\n                if (event.data.chromeMediaSourceId === 'PermissionDeniedError') {\n                    callback('permission-denied');\n                } else callback(null, event.data.chromeMediaSourceId, getScreenConstraints(null, event.data.chromeMediaSourceId));\n            }\n\n            if (event.data.chromeExtensionStatus) {\n                callback(event.data.chromeExtensionStatus, null, getScreenConstraints(event.data.chromeExtensionStatus));\n            }\n\n            // this event listener is no more needed\n            window.removeEventListener('message', onIFrameCallback);\n        }\n    };\n\n    function getScreenConstraints(error, sourceId) {\n        var screen_constraints = {\n            audio: false,\n            video: {\n                mandatory: {\n                    chromeMediaSource: error ? 'screen' : 'desktop',\n                    maxWidth: window.screen.width > 1920 ? window.screen.width : 1920,\n                    maxHeight: window.screen.height > 1080 ? window.screen.height : 1080\n                },\n                optional: []\n            }\n        };\n\n        if (sourceId) {\n            screen_constraints.video.mandatory.chromeMediaSourceId = sourceId;\n        }\n\n        return screen_constraints;\n    }\n\n    function postMessage() {\n        if (!iframe) {\n            loadIFrame(postMessage);\n            return;\n        }\n\n        if (!iframe.isLoaded) {\n            setTimeout(postMessage, 100);\n            return;\n        }\n\n        iframe.contentWindow.postMessage({\n            captureSourceId: true\n        }, '*');\n    }\n\n    function loadIFrame(loadCallback) {\n        if (iframe) {\n            loadCallback();\n            return;\n        }\n\n        iframe = document.createElement('iframe');\n        iframe.onload = function() {\n            iframe.isLoaded = true;\n\n            loadCallback();\n        };\n        iframe.src = 'https://www.webrtc-experiment.com/getSourceId/'; // https://wwww.yourdomain.com/getScreenId.html\n        iframe.style.display = 'none';\n        (document.body || document.documentElement).appendChild(iframe);\n    }\n\n    var iframe;\n\n    // this function is used in v3.0\n    window.getScreenConstraints = function(callback) {\n        loadIFrame(function() {\n            getScreenId(function(error, sourceId, screen_constraints) {\n                callback(error, screen_constraints.video);\n            });\n        });\n    };\n})();\n\n/*\n * JavaScript MD5 1.0.1\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n!function(a){\"use strict\";function b(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[(c+64>>>9<<4)+14]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[m,n,o,p]}function j(a){var b,c=\"\";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function k(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c}function l(a){return j(i(k(a),8*a.length))}function m(a,b){var c,d,e=k(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=i(e,8*a.length)),c=0;16>c;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=i(f.concat(k(b)),512+8*b.length),j(i(g.concat(d),640))}function n(a){var b,c,d=\"0123456789abcdef\",e=\"\";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}function t(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}\"function\"==typeof define&&define.amd?define(function(){return t}):a.md5=t}(this);\n/*\nThe MIT License (MIT)\n\nCopyright (c) 2014 Chris Wilson\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n/*\n\nUsage:\naudioNode = createAudioMeter(audioContext,clipLevel,averaging,clipLag);\n\naudioContext: the AudioContext you're using.\nclipLevel: the level (0 to 1) that you would consider \"clipping\".\n   Defaults to 0.98.\naveraging: how \"smoothed\" you would like the meter to be over time.\n   Should be between 0 and less than 1.  Defaults to 0.95.\nclipLag: how long you would like the \"clipping\" indicator to show\n   after clipping has occured, in milliseconds.  Defaults to 750ms.\n\nAccess the clipping through node.checkClipping(); use node.shutdown to get rid of it.\n*/\n\nfunction createAudioMeter(audioContext,clipLevel,averaging,clipLag) {\n\tvar processor = audioContext.createScriptProcessor(512);\n\tprocessor.onaudioprocess = volumeAudioProcess;\n\tprocessor.clipping = false;\n\tprocessor.lastClip = 0;\n\tprocessor.volume = 0;\n\tprocessor.clipLevel = clipLevel || 0.98;\n\tprocessor.averaging = averaging || 0.95;\n\tprocessor.clipLag = clipLag || 750;\n\n\t// this will have no effect, since we don't copy the input to the output,\n\t// but works around a current Chrome bug.\n\tprocessor.connect(audioContext.destination);\n\n\tprocessor.checkClipping =\n\t\tfunction(){\n\t\t\tif (!this.clipping)\n\t\t\t\treturn false;\n\t\t\tif ((this.lastClip + this.clipLag) < window.performance.now())\n\t\t\t\tthis.clipping = false;\n\t\t\treturn this.clipping;\n\t\t};\n\n\tprocessor.shutdown =\n\t\tfunction(){\n\t\t\tthis.disconnect();\n\t\t\tthis.onaudioprocess = null;\n\t\t};\n\n\treturn processor;\n}\n\nfunction volumeAudioProcess( event ) {\n\tvar buf = event.inputBuffer.getChannelData(0);\n    var bufLength = buf.length;\n\tvar sum = 0;\n    var x;\n\n\t// Do a root-mean-square on the samples: sum up the squares...\n    for (var i=0; i<bufLength; i++) {\n    \tx = buf[i];\n    \tif (Math.abs(x)>=this.clipLevel) {\n    \t\tthis.clipping = true;\n    \t\tthis.lastClip = window.performance.now();\n    \t}\n    \tsum += x * x;\n    }\n\n    // ... then take the square root of the sum.\n    var rms =  Math.sqrt(sum / bufLength);\n\n    // Now smooth this out with the averaging factor applied\n    // to the previous sample - take the max here because we\n    // want \"fast attack, slow release.\"\n    this.volume = Math.max(rms, this.volume*this.averaging);\n}\n\n(function() {\n  'use strict';\n\n  var vertoApp = angular.module('vertoApp', [\n    'timer',\n    'ngRoute',\n    'vertoControllers',\n    'vertoDirectives',\n    'vertoFilters',\n    'ngStorage',\n    'ngAnimate',\n    'ngSanitize',\n    'toastr',\n    'FBAngular',\n    'cgPrompt',\n    '720kb.tooltips',\n    'ui.gravatar',\n    'ui.bootstrap',\n    'directive.g+signin',\n    'pascalprecht.translate',\n    'angular-click-outside',\n  ]);\n\n  vertoApp.constant('configLanguages', {\n    'languages' : [\n         {id: 'en', name: 'English'},\n         {id: 'it', name: 'Italiano'},\n         {id: 'fr', name: 'Franais'},\n         {id: 'de', name: 'Deutsch'},\n         {id: 'pt', name: 'Portugus'},\n         {id: 'pl', name: 'Polski'},\n         {id: 'zh', name: ''},\n         {id: 'ru', name: 'P'},\n         {id: 'sv', name: 'Svenska'},\n         {id: 'da', name: 'Dansk'},\n         {id: 'es', name: 'Espaol'},\n         {id: 'id', name: 'Indonesia'}\n    ],\n\n    'dialects' : {\n        'en': 'en',\n        'en_GB': 'en',\n        'en_US': 'en',\n        'it': 'it',\n        'it_IT': 'it',\n        'fr': 'fr',\n        'fr_FR': 'fr',\n        'fr_CA': 'fr',\n        'pt': 'pt',\n        'pt_BR': 'pt',\n        'pt_PT': 'pt',\n        'de': 'de',\n        'de_DE': 'de',\n        'es': 'es',\n        'es_ES': 'es',\n        'pl': 'pl',\n        'pl_PL': 'pl',\n        'ru': 'ru',\n        'ru_RU': 'ru',\n        'sv': 'sv',\n        'sv_SV': 'sv',\n        'sv_FI': 'sv',\n        'da': 'da',\n        'da_DK': 'da',\n        'id': 'id',\n        'id_ID': 'id',\n        'zh': 'zh',\n        'zh_CN': 'zh',\n        'zh_TW': 'zh',\n        'zh_HK': 'zh'\n    }\n  });\n\n  vertoApp.config(['$routeProvider', 'gravatarServiceProvider', '$translateProvider', 'configLanguages',\n    function($routeProvider, gravatarServiceProvider, $translateProvider, configLanguages) {\n      $routeProvider.\n      when('/', {\n        title: 'Loading',\n        templateUrl: 'partials/splash_screen.html',\n        controller: 'SplashScreenController'\n      }).\n      when('/login', {\n        title: 'Login',\n        templateUrl: 'partials/login.html',\n        controller: 'LoginController'\n      }).\n      when('/dialpad', {\n        title: 'Dialpad',\n        templateUrl: 'partials/dialpad.html',\n        controller: 'DialPadController'\n      }).\n      when('/incall', {\n          title: 'In a Call',\n          templateUrl: 'partials/incall.html',\n          controller: 'InCallController'\n        }).\n      when('/preview', {\n        title: 'Preview Video',\n        templateUrl: 'partials/preview.html',\n        controller: 'PreviewController'\n      }).\n      when('/browser-upgrade', {\n        title: '',\n        templateUrl: 'partials/browser_upgrade.html',\n        controller: 'BrowserUpgradeController'\n      }).\n      otherwise({\n        redirectTo: '/'\n      });\n\n      gravatarServiceProvider.defaults = {\n        default: 'mm'  // Mystery man as default for missing avatars\n      };\n\n      var reg_langs = [];\n      angular.forEach(configLanguages.languages, function(value, key) {\n        reg_langs.push(value.id);\n      });\n\n      $translateProvider\n      .useStaticFilesLoader({\n        prefix: 'locales/locale-',\n        suffix: '.json'\n      })\n      .registerAvailableLanguageKeys(reg_langs, configLanguages.dialects)\n      .preferredLanguage('en')\n      .determinePreferredLanguage()\n      .fallbackLanguage('en')\n      .useSanitizeValueStrategy(null);\n    }\n  ]);\n\n  vertoApp.run(['$rootScope', '$location', 'toastr', 'prompt', 'verto',\n    function($rootScope, $location, toastr, prompt, verto) {\n\n      $rootScope.$on( \"$routeChangeStart\", function(event, next, current) {\n        if (!verto.data.connected) {\n          if ( next.templateUrl === \"partials/login.html\") {\n            // pass\n          } else {\n            $location.path(\"/\");\n          }\n        }\n      });\n\n      $rootScope.$on('$routeChangeSuccess', function(event, current, previous) {\n        $rootScope.title = current.$$route.title;\n      });\n\n      $rootScope.safeProtocol = false;\n\n      if (window.location.protocol == 'https:') {\n        $rootScope.safeProtocol = true;\n      }\n\n\n      $rootScope.promptInput = function(title, message, label, callback) {\n        var ret = prompt({\n          title: title,\n          message: message,\n          input: true,\n          label: label\n        }).then(function(ret) {\n          if (angular.isFunction(callback)) {\n            callback(ret);\n          }\n        }, function() {\n\n        });\n\n      };\n\n    }\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  var vertoControllers = angular.module('vertoControllers', [\n    'ui.bootstrap',\n    'vertoService',\n    'storageService',\n    'ui.gravatar'\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('vertoControllers')\n  .controller('SplashScreenController', ['$scope', '$rootScope', '$location', '$timeout', 'storage', 'splashscreen', 'prompt', 'verto',\n    function($scope, $rootScope, $location, $timeout, storage, splashscreen, prompt, verto) {\n      console.debug('Executing SplashScreenController.');\n\n      $scope.progress_percentage = splashscreen.progress_percentage;\n      $scope.message = '';\n      $scope.interrupt_next = false;\n      $scope.errors = [];\n\n      var redirectTo = function(link, activity) {\n        if(activity) {\n          if(activity == 'browser-upgrade') {\n            link = activity;\n          }\n        }\n\n        $location.path(link);\n      }\n\n      var checkProgressState = function(current_progress, status, promise, activity, soft, interrupt, message) {\n        $scope.progress_percentage = splashscreen.calculate(current_progress);\n        $scope.message = message;\n\n        if(interrupt && status == 'error') {\n          $scope.errors.push(message);\n          if(!soft) {\n            redirectTo('', activity);\n            return;\n          } else {\n            message = message + '. Continue?';\n          };\n\n          if(!confirm(message)) {\n            $scope.interrupt_next = true;\n          };\n        };\n\n        if($scope.interrupt_next) {\n          return;\n        };\n\n        $scope.message = splashscreen.getProgressMessage(current_progress+1);\n\n        return true;\n      };\n\n      $rootScope.$on('progress.next', function(ev, current_progress, status, promise, activity, soft, interrupt, message) {\n        $timeout(function() {\n          if(promise) {\n            promise.then(function(response) {\n              message = response['message'];\n              status = response['status'];\n              if(checkProgressState(current_progress, status, promise, activity, soft, interrupt, message)) {\n                splashscreen.next();\n              };\n            });\n\n            return;\n          }\n\n          if(!checkProgressState(current_progress, status, promise, activity, soft, interrupt, message)) {\n            return;\n          }\n\n          splashscreen.next();\n        }, 400);\n      });\n\n      $rootScope.$on('progress.complete', function(ev, current_progress) {\n        $scope.message = 'Complete';\n        if(verto.data.connected) {\n          if (0 && storage.data.preview) {\n            $location.path('/preview');\n          }\n          else {\n            $location.path('/dialpad');\n          }\n        } else {\n          redirectTo('/login');\n          $location.path('/login');\n        }\n      });\n\n      splashscreen.next();\n\n    }]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('BrowserUpgradeController', ['$scope', '$http',\n      '$location', 'verto', 'storage', 'Fullscreen',\n      function($scope, $http, $location, verto, storage, Fullscreen) {\n        console.debug('Executing BrowserUpgradeController.');\n\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('vertoControllers')\n  .controller('ChatController', ['$scope', '$rootScope', '$http',\n    '$location', '$anchorScroll', '$timeout', 'verto', 'prompt', '$translate',\n    function($scope, $rootScope, $http, $location, $anchorScroll, $timeout,\n      verto, prompt, $translate) {\n      console.debug('Executing ChatController.');\n\n      function scrollToChatBottom() {\n        // Going to the bottom of chat messages.\n        var obj = document.querySelector('.chat-messages');\n        obj.scrollTop = obj.scrollHeight;\n        //var chat_messages_top = jQuery('.chat-messages').scrollTop();\n        //var marker_position = jQuery('#chat-message-bottom').position().top;\n        //jQuery('.chat-messages').scrollTop(chat_messages_top + marker_position);\n      }\n\n      var CLEAN_MESSAGE = '';\n\n      function clearConferenceChat() {\n        $scope.members = [];\n        $scope.messages = [];\n        $scope.message = CLEAN_MESSAGE;\n      }\n      clearConferenceChat();\n\n      $scope.$watch('activePane', function() {\n        if ($scope.activePane == 'chat') {\n          $rootScope.chat_counter = 0;\n        }\n        $rootScope.activePane = $scope.activePane;\n      });\n\n      $rootScope.$on('chat.newMessage', function(event, data) {\n        data.created_at = new Date();\n        console.log('chat.newMessage', data);\n        $scope.$apply(function() {\n          $scope.messages.push(data);\n          if (data.from != verto.data.name &&\n              (!$scope.chatStatus && $scope.activePane != 'chat')) {\n            ++$rootScope.chat_counter;\n          }\n          $timeout(function() {\n            scrollToChatBottom();\n          }, 300);\n        });\n      });\n\n      $rootScope.$on('call.conference', function(event, data) {\n        $timeout(function() {\n          $scope.conf = verto.data.conf.params.laData;\n        });\n      });\n\n      $rootScope.$on('changedVideoLayout', function(event, layout) {\n        $scope.resIDs = getResByLayout(layout);\n\n        // remove resIDs param to clear every members resID.\n        // passing $scope.resIDs results in preserving resIDs compatible\n        // with the current layout\n        clearMembersResID($scope.resIDs);\n      });\n\n      $rootScope.$on('conference.canvasInfo', function(event, data) {\n        $scope.currentLayout = data[0].layoutName;\n        $scope.resIDs = getResByLayout($scope.currentLayout);\n      });\n\n      function getResByLayout(layout) {\n        var layoutsData = verto.data.confLayoutsData;\n        for (var i = 0; i < layoutsData.length; i++) {\n          if (layoutsData[i].name === layout) {\n            return layoutsData[i].resIDS;\n          }\n        }\n      }\n\n      // @preserve - a array of values to be preserved\n      function clearMembersResID(preserve) {\n        $scope.members.forEach(function(member) {\n          var resID = member.status.video.reservationID;\n          console.debug(\"resID to clear: \" + resID);\n          if (resID && preserve && preserve.indexOf(resID) !== -1) return;\n          if (resID){\n            console.debug(\"clearing resid [\" + resID + \"] from [\" + member.id + \"]\");\n            $scope.confResID(member.id, resID);\n          }\n        });\n      };\n\n      function findMemberByUUID(uuid) {\n        var found = false;\n        for (var idx in $scope.members) {\n          var member = $scope.members[idx];\n          if (member.uuid == uuid) {\n            found = true;\n            break;\n          }\n        }\n        if (found) {\n          return idx;\n        } else {\n          return -1;\n        }\n      }\n\n      function translateMember(member) {\n        return {\n          'uuid': member[0],\n          'id': member[1][0],\n          'number': member[1][1],\n          'name': member[1][2],\n          'codec': member[1][3],\n          'status': JSON.parse(member[1][4]),\n          'email': member[1][5].email\n        };\n      }\n\n      function addMember(member) {\n        $scope.members.push(translateMember(member));\n      }\n\n      $rootScope.$on('hangupCall', function() {\n        $scope.openId = null;\n      });\n\n      $rootScope.$on('members.boot', function(event, members) {\n        $scope.$apply(function() {\n          clearConferenceChat();\n          for (var idx in members) {\n            var member = members[idx];\n            addMember(member);\n          }\n        })\n      });\n\n      $rootScope.$on('members.add', function(event, member) {\n        $scope.$apply(function() {\n          addMember(member);\n        });\n      });\n\n      $rootScope.$on('members.del', function(event, uuid) {\n        if ($rootScope.watcher && $rootScope.master === uuid) {\n          verto.hangup();\n          window.close();\n        }\n\n        $scope.$apply(function() {\n          var memberIdx = findMemberByUUID(uuid);\n          if (memberIdx != -1) {\n            // Removing the member.\n            $scope.members.splice(memberIdx, 1);\n          }\n        });\n      });\n\n      $rootScope.$on('members.update', function(event, member) {\n        member = translateMember(member);\n        var memberIdx = findMemberByUUID(member.uuid);\n        if (memberIdx < 0) {\n          console.log('Didn\\'t find the member uuid ' + member.uuid);\n        } else {\n          $scope.$apply(function() {\n            // console.log('Updating', memberIdx, ' <', $scope.members[memberIdx],\n              // '> with <', member, '>');\n            // Checking if it's me\n            if (parseInt(member.id) == parseInt(verto.data.conferenceMemberID)) {\n              verto.data.mutedMic = member.status.audio.muted;\n              verto.data.mutedVideo = member.status.video.muted;\n\t\t\t  verto.data.call.setMute(member.status.audio.muted ? \"off\" : \"on\");\n\t\t\t  verto.data.call.setVideoMute(member.status.video.muted ? \"off\" : \"on\");\n            }\n            angular.extend($scope.members[memberIdx], member);\n          });\n        }\n      });\n\n      $rootScope.$on('members.clear', function(event) {\n        $scope.$applyAsync(function() {\n          clearConferenceChat();\n          $scope.closeChat();\n        });\n      });\n\n      /**\n       * Public methods.\n       */\n\n      $scope.toggleModMenu = function(index) {\n        if (verto.data.confRole != 'moderator') return;\n        $scope.openId = $scope.openId == index ? null : index;\n      };\n\n      $scope.send = function(event) {\n        // Only conferencing chat is supported for now\n        // but still calling method with the conference prefix\n        // so we know that explicitly.\n        if (event && event.type == 'keydown') {\n          event.preventDefault();\n        }\n        verto.sendConferenceChat($scope.message);\n        $scope.message = CLEAN_MESSAGE;\n      };\n\n      // Participants moderation.\n      $scope.confKick = function(memberID) {\n        console.log('$scope.confKick');\n        verto.data.conf.kick(memberID);\n      };\n\n      $scope.confMuteMic = function(memberID) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confMuteMic');\n          verto.data.conf.muteMic(memberID);\n        }\n      };\n\n      $scope.confMuteVideo = function(memberID) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confMuteVideo');\n          verto.data.conf.muteVideo(memberID);\n        }\n      };\n\n      $scope.confPresenter = function(memberID) {\n        console.log('$scope.confPresenter');\n        verto.data.conf.presenter(memberID);\n      };\n\n      $scope.confResID = function(memberID, resID) {\n        console.log('Set', memberID, 'to', resID);\n        verto.setResevartionId(memberID, resID);\n      };\n\n      $scope.confVideoFloor = function(memberID) {\n        console.log('$scope.confVideoFloor');\n        verto.data.conf.videoFloor(memberID);\n      };\n\n      $scope.confBanner = function(memberID) {\n        console.log('$scope.confBanner');\n\n        prompt({\n          title: $translate.instant('TITLE_INSERT_BANNER'),\n          input: true,\n          label: '',\n          value: '',\n        }).then(function(text) {\n          if (text) {\n            verto.data.conf.banner(memberID, text);\n          }\n        });\n      };\n\n      $scope.confCanvasIn = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setCanvasIn(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_CANVAS_ID'), function(canvasID) {\n          console.log(memberID, canvasID);\n          verto.setCanvasIn(memberID, canvasID);\n        });\n\n      };\n\n      $scope.confCanvasOut = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setCanvasOut(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_CANVAS_ID'), function(canvasID) {\n          verto.setCanvasOut(memberID, canvasID);\n        });\n      };\n\n      $scope.confLayer = function(memberID, canvasID) {\n        if (canvasID) {\n          verto.setLayer(memberID, canvasID);\n          return;\n        }\n\n        shortPrompt($translate.instant('TITLE_INSERT_LAYER'), function(canvasID) {\n          verto.setLayer(memberID, canvasID);\n        });\n      };\n\n      $scope.confResetBanner = function(memberID) {\n        console.log('$scope.confResetBanner');\n        var text = 'reset';\n        verto.data.conf.banner(memberID, text);\n      };\n\n      $scope.confVolumeDown = function(memberID) {\n        console.log('$scope.confVolumeDown');\n        verto.data.conf.volumeDown(memberID);\n      };\n\n      $scope.confVolumeUp = function(memberID) {\n        console.log('$scope.confVolumeUp');\n        verto.data.conf.volumeUp(memberID);\n      };\n\n      $scope.confGainDown = function(memberID) {\n        console.log('$scope.confGainDown');\n        verto.data.conf.gainDown(memberID);\n      };\n\n      $scope.confGainUp = function(memberID) {\n        console.log('$scope.confGainUp');\n        verto.data.conf.gainUp(memberID);\n      };\n\n      $scope.confTransfer = function(memberID) {\n        console.log('$scope.confTransfer');\n        prompt({\n          title: $translate.instant('TITLE_TRANSFER'),\n          message: $translate.instant('MESSAGE_TRANSFER'),\n          input: true,\n          label: $translate.instant('LABEL_TRANSFER'),\n          value: '',\n        }).then(function(exten) {\n          if (exten) {\n            verto.data.conf.transfer(memberID, exten);\n          }\n        });\n      };\n\n      $scope.confToggleDeaf = function(member) {\n        if(verto.data.confRole == 'moderator') {\n          console.log('$scope.confToggleDeaf');\n\n          if (member.status.audio.deaf) {\n            verto.data.conf.undeaf(member.id);\n          } else {\n            verto.data.conf.deaf(member.id);\n          }\n        }\n      };\n\n      function shortPrompt(text, cb) {\n        prompt({\n          title: text,\n          input: true,\n          label: '',\n          value: '',\n        }).then(function(val) {\n          if (val && cb) {\n            cb(val);\n          }\n        });\n      }\n    }\n  ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ContributorsController', ['$scope', '$http',\n      'toastr',\n      function($scope, $http, toastr) {\n        var url = window.location.origin + window.location.pathname;\n        $http.get(url + 'contributors.txt')\n          .success(function(data) {\n\n            var contributors = [];\n\n            angular.forEach(data, function(value, key) {\n              var re = /(.*) <(.*)>/;\n              var name = value.replace(re, \"$1\");\n              var email = value.replace(re, \"$2\");\n\n              this.push({\n                'name': name,\n                'email': email\n              });\n            }, contributors);\n\n            $scope.contributors = contributors;\n          })\n          .error(function() {\n            toastr.error('contributors not found.');\n          });\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('AboutController', ['$scope', '$http',\n      'toastr',\n      function($scope, $http, toastr) {\n\t    var githash = '<%= meta.revision %>' || 'something is not right';\n            $scope.githash = githash;\n\n\t/* leave this here for later, but its not needed right now\n        $http.get(window.location.pathname + '/contributors.txt')\n          .success(function(data) {\n\n          })\n          .error(function() {\n            toastr.error('contributors not found.');\n          });\n\t */\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('DialPadController', ['$rootScope', '$scope',\n      '$http', '$location', 'toastr', 'verto', 'storage', 'CallHistory', 'eventQueue', '$timeout',\n      function($rootScope, $scope, $http, $location, toastr, verto, storage, CallHistory, eventQueue, $timeout) {\n        console.debug('Executing DialPadController.');\n\n        eventQueue.process();\n\n        if ($location.search().autocall) {\n            $rootScope.dialpadNumber = $location.search().autocall;\n            delete $location.search().autocall;\n            call($rootScope.dialpadNumber);\n            if($rootScope.watcher) {\n              return;\n            }\n        }\n\n        $scope.call_history = CallHistory.all();\n        $scope.history_control = CallHistory.all_control();\n        $scope.has_history = Object.keys($scope.call_history).length;\n        storage.data.videoCall = false;\n        storage.data.userStatus = 'connecting';\n        storage.data.calling = false;\n\n        $scope.clearCallHistory = function() {\n          CallHistory.clear();\n          $scope.call_history = CallHistory.all();\n          $scope.history_control = CallHistory.all_control();\n          $scope.has_history = Object.keys($scope.call_history).length;\n          return $scope.history_control;\n        };\n\n        $scope.viewCallsList = function(calls) {\n          return $scope.call_list = calls;\n        };\n\n        /**\n         * fill dialpad via querystring [?autocall=\\d+]\n         */\n\n\t/**\n\t * fill in dialpad via config.json\n\t */\n        if ('autocall' in verto.data) {\n          $rootScope.dialpadNumber = verto.data.autocall;\n\t  delete verto.data.autocall;\n          call($rootScope.dialpadNumber);\n        }\n\n        /**\n         * used to bind click on number in call history to fill dialpad\n         * 'cause inside a ng-repeat the angular isnt in ctrl scope\n         */\n        $scope.fillDialpadNumber = function(number) {\n          $rootScope.dialpadNumber = number;\n        };\n\n        $scope.preview = function() {\n          $location.path('/preview');\n        };\n\n        $rootScope.transfer = function() {\n          if (!$rootScope.dialpadNumber) {\n            return false;\n          }\n          verto.data.call.transfer($rootScope.dialpadNumber);\n        };\n\n        function call(extension) {\n          storage.data.onHold = false;\n          storage.data.cur_call = 0;\n          $rootScope.dialpadNumber = extension;\n          if (!$rootScope.dialpadNumber && storage.data.called_number) {\n            $rootScope.dialpadNumber = storage.data.called_number;\n            return false;\n          } else if (!$rootScope.dialpadNumber && !storage.data.called_number) {\n            toastr.warning('Enter an extension, please.');\n            return false;\n          }\n\n          if (verto.data.call) {\n            console.debug('A call is already in progress.');\n            return false;\n          }\n\n          if (extension.indexOf('-canvas-') != -1) {\n            $rootScope.watcher = true;\n            verto.call($rootScope.dialpadNumber, null,\n              {\n                useCamera: \"none\",\n                useMic: \"none\",\n                useSpeak: \"none\",\n                caller_id_name: null,\n                userVariables: {},\n                caller_id_number: null,\n                mirrorInput: false\n              }\n            );\n            $location.path('/incall');\n            return;\n          }\n\n          storage.data.mutedVideo = false;\n          storage.data.mutedMic = false;\n\n          storage.data.videoCall = false;\n          verto.call($rootScope.dialpadNumber);\n\n          storage.data.called_number = $rootScope.dialpadNumber;\n          CallHistory.add($rootScope.dialpadNumber, 'outbound');\n          $location.path('/incall');\n        }\n\n        /**\n         * Call to the number in the $rootScope.dialpadNumber.\n         */\n        $scope.loading = false;\n        $scope.cancelled = false;\n        $rootScope.call = function(extension) {\n          if (!storage.data.testSpeedJoin || !$rootScope.dialpadNumber) {\n            return call(extension);\n          }\n          $scope.loading = true;\n\n          verto.testSpeed(function() {\n            if ($scope.cancelled) {\n              $scope.cancelled = false;\n              $scope.loading = false;\n              return;\n            } else {\n              call(extension);\n            }\n          });\n        }\n\n        $rootScope.cancel = function() {\n          $scope.cancelled = true;\n        }\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('InCallController', ['$rootScope', '$scope',\n      '$http', '$location', '$modal', '$timeout', 'toastr', 'verto', 'storage', 'prompt', 'Fullscreen', '$translate',\n      function($rootScope, $scope, $http, $location, $modal, $timeout, toastr,\n        verto, storage, prompt, Fullscreen, $translate) {\n\n        console.debug('Executing InCallController.');\n        $scope.layout = null;\n        $rootScope.dialpadNumber = '';\n        $scope.callTemplate = 'partials/phone_call.html';\n        $scope.dialpadTemplate = '';\n        $scope.incall = true;\n\n        if (storage.data.videoCall) {\n          $scope.callTemplate = 'partials/video_call.html';\n        }\n\n        $rootScope.$on('call.conference', function(event, data) {\n          $timeout(function() {\n            if($scope.chatStatus) {\n              $scope.openChat();\n            }\n            buildCanvasesData();\n          });\n        });\n\n        $rootScope.$on('call.video', function(event, data) {\n          $timeout(function() {\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        });\n\n        /**\n         * toggle dialpad in incall page\n         */\n        $scope.toggleDialpad = function() {\n          $scope.openModal('partials/dialpad_widget.html',\n            'ModalDialpadController');\n\n          /*\n          if(!$scope.dialpadTemplate) {\n            $scope.dialpadTemplate = 'partials/dialpad_widget.html';\n          } else {\n            $scope.dialpadTemplate = '';\n          }\n          */\n        }\n\n        /**\n         * TODO: useless?\n         */\n        $scope.videoCall = function() {\n          prompt({\n            title: $translate.instant('TITLE_ENABLE_VIDEO'),\n            message: $translate.instant('MESSAGE_ENABLE_VIDEO')\n          }).then(function() {\n            storage.data.videoCall = true;\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        };\n\n        $scope.cbMuteVideo = function(event, data) {\n          storage.data.mutedVideo = !storage.data.mutedVideo;\n        }\n\n        $scope.cbMuteMic = function(event, data) {\n          storage.data.mutedMic = !storage.data.mutedMic;\n        }\n\n        $scope.confChangeVideoLayout = function(layout) {\n          verto.data.conf.setVideoLayout(layout);\n          $scope.videoLayout = layout;\n          $rootScope.$emit('changedVideoLayout', layout);\n        };\n\n        $scope.confChangeSpeaker = function(speakerId) {\n          storage.data.selectedSpeaker = speakerId;\n          $rootScope.$emit('changedSpeaker', speakerId);\n        };\n\n        $scope.confPopup = function(canvas_id) {\n          var video = document.getElementById('webcam');\n          var s = window.location.href;\n          var curCall = verto.data.call.callID;\n          var extension = verto.data.call.params.remote_caller_id_number;\n          var width = webcam.offsetWidth;\n          var height = webcam.offsetHeight + 100;\n          var x = (screen.width - width)/2\n          var y = (screen.height - height)/2\n\n          s = s.replace(/\\#.*/, '');\n          s += \"#/?sessid=random&master=\" + curCall + \"&watcher=true&extension=\" + extension+ \"&canvas_id=\" + canvas_id;\n\n          console.log(\"opening new window to \" + s);\n          var popup = window.open(s, \"canvas_window_\" + canvas_id, \"toolbar=0,location=0,menubar=0,directories=0,width=\" + width + \",height=\" + height, + ',left=' + x + ',top=' + y);\n          popup.moveTo(x, y);\n        };\n\n        $scope.screenshare = function() {\n          if(verto.data.shareCall) {\n            verto.screenshareHangup();\n            return false;\n          }\n          if (verto.data.conf) {\n            console.log('Screenshare inside conferece: ', verto.data.conf);\n            // Setting the destination of the screenshare call as the conference\n            // number we last joined\n            verto.screenshare(verto.data.conf.params.laData.laName);\n          }\n          else {\n            verto.screenshare(storage.data.called_number);\n          }\n        };\n\n        function buildCanvasesData() {\n          $scope.conf = verto.data.conf.params.laData;\n          $scope.canvases = [{ id: 1, name: 'Super Canvas' }];\n          for (var i = 1; i < $scope.conf.canvasCount; i++) {\n            $scope.canvases.push({ id: i+1, name: 'Canvas ' + (i+1) });\n          }\n        }\n\n        $scope.muteMic = verto.muteMic;\n        $scope.muteVideo = verto.muteVideo;\n\n        $rootScope.$on('ScreenShareExtensionStatus', function(event, error) {\n          var pluginUrl = 'https://chrome.google.com/webstore/detail/screen-capturing/ajhifddimkapgcifgcodmmfdlknahffk';\n          switch(error) {\n            case 'permission-denied':\n              toastr.info('Please allow the plugin in order to use Screen Share', 'Error'); break;\n            case 'not-installed':\n              toastr.warning('Please <a target=\"_blank\" class=\"install\" href=\"'+ pluginUrl +'\">install</a> the plugin in order to use Screen Share', 'Warning', { allowHtml: true }); break;\n            case 'installed-disabled':\n              toastr.info('Please enable the plugin in order to use Screen Share', 'Error'); break;\n            // case 'not-chrome'\n            //   toastr.info('Chrome', 'Error');\n          }\n        });\n\n        $timeout(function() {\n          console.log('broadcast time-start incall');\n          $scope.$broadcast('timer-start');\n        }, 1000);\n\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('LoginController', ['$scope', '$http', '$location', 'verto', \n      function($scope, $http, $location, verto) {\n        var preRoute = function() {\n          if(verto.data.connected) {\n            $location.path('/dialpad');\n          }\n        }\n        preRoute();\n        \n        verto.data.name = $scope.storage.data.name;\n        verto.data.email = $scope.storage.data.email;\n\n        console.debug('Executing LoginController.');\n      }\n    ]);\n\n})();\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('MainController',\n      [\"$scope\", \"$rootScope\", \"$location\", \"$modal\", \"$timeout\", \"$q\", \"verto\", \"storage\", \"CallHistory\", \"toastr\", \"Fullscreen\", \"prompt\", \"eventQueue\", \"$translate\", \"$window\", function($scope, $rootScope, $location, $modal, $timeout, $q, verto, storage, CallHistory, toastr, Fullscreen, prompt, eventQueue, $translate, $window) {\n\n      console.debug('Executing MainController.');\n      $rootScope.dtmfHistory = { value: '' };\n      $rootScope.onKeydownDtmfEnabled = true;\n\n      if (storage.data.language && storage.data.language !== 'browser') {\n        $translate.use(storage.data.language);\n      } else {\n        storage.data.language = 'browser';\n      }\n\n      $rootScope.master = $location.search().master;\n      if ($location.search().watcher === 'true') {\n        $rootScope.watcher = true;\n        angular.element(document.body).addClass('watcher');\n        var dialpad;\n        var extension = dialpad = $location.search().extension;\n        var canvasID = $location.search().canvas_id;\n\n        if (dialpad) {\n          if (canvasID) {\n            dialpad += '-canvas-' + canvasID;\n          }\n          $rootScope.extension = extension;\n          $rootScope.canvasID = canvasID;\n          $location.search().autocall = dialpad;\n        }\n      }\n\n      var myVideo = document.getElementById(\"webcam\");\n      $scope.verto = verto;\n      $scope.storage = storage;\n      $scope.call_history = angular.element(\"#call_history\").hasClass('active');\n      $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n      $scope.showReconnectModal = true;\n      /**\n       * (explanation) scope in another controller extends rootScope (singleton)\n       */\n      $rootScope.chat_counter = 0;\n      $rootScope.activePane = 'members';\n      /**\n       * The number that will be called.\n       * @type {string}\n       */\n      $rootScope.dialpadNumber = '';\n\n      // If verto is not connected, redirects to login page.\n      if (!verto.data.connected) {\n        console.debug('MainController: WebSocket not connected. Redirecting to login.');\n        $location.path('/');\n      }\n\n      $rootScope.$on('config.http.success', function(ev) {\n        $scope.login(false);\n      });\n\n      $rootScope.$on('changedSpeaker', function(event, speakerId) {\n        if (verto.data.call) {\n          verto.data.call.setAudioPlaybackDevice(speakerId, sinkIdCallback);\n        }\n      });\n\n      /**\n       * Login the user to verto server and\n       * redirects him to dialpad page.\n       */\n      $scope.login = function(redirect) {\n        if(redirect == undefined) {\n          redirect = true;\n        }\n        var connectCallback = function(v, connected) {\n          $scope.$apply(function() {\n          verto.data.connecting = false;\n          if (connected) {\n            storage.data.hostname = verto.data.hostname;\n            storage.data.wsURL = verto.data.wsURL;\n            storage.data.ui_connected = verto.data.connected;\n            storage.data.ws_connected = verto.data.connected;\n            storage.data.name = verto.data.name;\n            storage.data.email = verto.data.email;\n            storage.data.login = verto.data.login;\n            storage.data.password = verto.data.password;\n            if (storage.data.autoBand) {\n              verto.testSpeed();\n            }\n\n            if (redirect && storage.data.preview) {\n              $location.path('/preview');\n            } else if (redirect) {\n              $location.path('/dialpad');\n            }\n          }\n          });\n        };\n\n        verto.data.connecting = true;\n        verto.connect(connectCallback);\n      };\n\n      /**\n       * Logout the user from verto server and\n       * redirects him to login page.\n       */\n      $rootScope.logout = function() {\n        var disconnect = function() {\n          var disconnectCallback = function(v, connected) {\n            console.debug('Redirecting to login page.');\n            storage.reset();\n\t\t\tif (typeof gapi !== 'undefined'){\n\t\t\t\tconsole.debug(gapi);\n\t\t\t\tgapi.auth.signOut();\n\t\t\t}\n            $location.path('/login');\n          };\n\n          if (verto.data.call) {\n            verto.hangup();\n          }\n\n          $scope.closeChat();\n          $scope.showReconnectModal = false;\n          verto.disconnect(disconnectCallback);\n\n          verto.hangup();\n        };\n\n        if (verto.data.call) {\n          prompt({\n            title: $translate.instant('TITLE_ACTIVE_CALL'),\n            message: $translate.instant('MESSAGE_ACTIVE_CALL_HANGUP')\n          }).then(function() {\n            disconnect();\n          });\n        } else {\n          disconnect();\n        }\n\n      };\n\n      /**\n       * Shows a modal with the settings.\n       */\n      $scope.openModalSettings = function() {\n        var modalInstance = $modal.open({\n          animation: $scope.animationsEnabled,\n          templateUrl: 'partials/modal_settings.html',\n          controller: 'ModalSettingsController',\n        });\n\n        modalInstance.result.then(\n          function(result) {\n            console.log(result);\n          },\n          function() {\n            console.info('Modal dismissed at: ' + new Date());\n          }\n        );\n\n        modalInstance.rendered.then(\n          function() {\n            jQuery.material.init();\n          }\n        );\n      };\n\n      $rootScope.openModal = function(templateUrl, controller, _options) {\n        var options = {\n          animation: $scope.animationsEnabled,\n          templateUrl: templateUrl,\n          controller: controller,\n        };\n\n        angular.extend(options, _options);\n\n        var modalInstance = $modal.open(options);\n\n        modalInstance.result.then(\n          function(result) {\n            console.log(result);\n          },\n          function() {\n            console.info('Modal dismissed at: ' + new Date());\n          }\n        );\n\n        modalInstance.rendered.then(\n          function() {\n            jQuery.material.init();\n          }\n        );\n\n        return modalInstance;\n      };\n\n      $rootScope.$on('ws.close', onWSClose);\n      $rootScope.$on('ws.login', onWSLogin);\n\n      $rootScope.ws_modalInstance;\n\n      function onWSClose(ev, data) {\n        if($rootScope.ws_modalInstance) {\n          return;\n        };\n        var options = {\n          backdrop: 'static',\n          keyboard: false\n        };\n          if ($scope.showReconnectModal) {\n            $rootScope.ws_modalInstance = $scope.openModal('partials/ws_reconnect.html', 'ModalWsReconnectController', options);\n          };\n      };\n\n      function onWSLogin(ev, data) {\n        if(storage.data.autoBand) {\n          verto.testSpeed();\n        }\n        if(!$rootScope.ws_modalInstance) {\n          return;\n        };\n\n        $rootScope.ws_modalInstance.close();\n        $rootScope.ws_modalInstance = null;\n      };\n\n      $scope.showAbout = function() {\n        $scope.openModal('partials/about.html', 'AboutController');\n      };\n\n      $scope.showContributors = function() {\n        $scope.openModal('partials/contributors.html', 'ContributorsController');\n      };\n\n      /**\n       * Updates the display adding the new number touched.\n       *\n       * @param {String} number - New touched number.\n       */\n      $rootScope.dtmf = function(number) {\n        console.log('dtmf', number);\n        $rootScope.dialpadNumber = $rootScope.dialpadNumber + number;\n        if (verto.data.call) {\n          verto.dtmf(number);\n        }\n      };\n\n      /**\n       * Removes the last character from the number.\n       */\n      $rootScope.backspace = function() {\n        var number = $rootScope.dialpadNumber;\n        var len = number.length;\n        $rootScope.dialpadNumber = number.substring(0, len - 1);\n      };\n\n\n      $scope.toggleCallHistory = function() {\n        if (!$scope.call_history) {\n          angular.element(\"#call_history\").addClass('active');\n          angular.element(\"#call-history-wrapper\").addClass('active');\n        } else {\n          angular.element(\"#call_history\").removeClass('active');\n          angular.element(\"#call-history-wrapper\").removeClass('active');\n        }\n        $scope.call_history = angular.element(\"#call_history\").hasClass('active');\n      };\n\n      $scope.toggleChat = function() {\n        if ($rootScope.chatStatus && $rootScope.activePane === 'chat') {\n          $rootScope.chat_counter = 0;\n        }\n        angular.element('#wrapper').toggleClass('toggled');\n        $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n      };\n\n      $rootScope.openChat = function() {\n        $rootScope.chatStatus = false;\n        angular.element('#wrapper').removeClass('toggled');\n      };\n\n      $scope.closeChat = function() {\n        $rootScope.chatStatus = true;\n        angular.element('#wrapper').addClass('toggled');\n      };\n\n      $scope.toggleSettings = function() {\n        var settingsEl = angular.element(document.querySelector('#settings'));\n        settingsEl.toggleClass('toggled');\n        $rootScope.$emit('toggledSettings', settingsEl.hasClass('toggled'));\n      };\n\n      $scope.closeSettings = function() {\n        var settingsEl = angular.element(document.querySelector('#settings'));\n        if (settingsEl.hasClass('toggled')) {\n          settingsEl.removeClass('toggled');\n          $rootScope.$emit('toggledSettings', settingsEl.hasClass('toggled'));\n        }\n      };\n\n      $scope.goFullscreen = function() {\n        if (storage.data.userStatus !== 'connected') {\n          return;\n        }\n        $rootScope.fullscreenEnabled = !Fullscreen.isEnabled();\n        if (Fullscreen.isEnabled()) {\n          Fullscreen.cancel();\n        } else {\n          Fullscreen.enable(document.getElementsByTagName('body')[0]);\n        }\n      };\n\n      $rootScope.$on('call.video', function(event) {\n        storage.data.videoCall = true;\n      });\n\n      $rootScope.$on('call.hangup', function(event, data) {\n        if (Fullscreen.isEnabled()) {\n          Fullscreen.cancel();\n        }\n\n        if (!$rootScope.chatStatus) {\n          angular.element('#wrapper').toggleClass('toggled');\n          $rootScope.chatStatus = angular.element('#wrapper').hasClass('toggled');\n        }\n\n        $rootScope.dialpadNumber = '';\n        console.debug('Redirecting to dialpad page.');\n        $location.path('/dialpad');\n\n        try {\n          $rootScope.$digest();\n        } catch (e) {\n          console.log('not digest');\n        }\n      });\n\n      $rootScope.$on('page.incall', function(event, data) {\n        var page_incall = function() {\n          return $q(function(resolve, reject) {\n            if (storage.data.askRecoverCall) {\n              prompt({\n                title: $translate.instant('TITLE_ACTIVE_CALL'),\n                message: $translate.instant('MESSAGE_ACTIVE_CALL_BACK')\n              }).then(function() {\n                console.log('redirect to incall page');\n                $location.path('/incall');\n              }, function() {\n                storage.data.userStatus = 'connecting';\n                verto.hangup();\n              });\n            } else {\n              console.log('redirect to incall page');\n              $location.path('/incall');\n            }\n            resolve();\n          });\n        };\n        eventQueue.events.push(page_incall);\n      });\n\n      $scope.$on('event:google-plus-signin-success', function (event,authResult) {\n        // Send login to server or save into cookie\n        console.log('Google+ Login Success');\n\tconsole.log(authResult);\n\tgapi.client.load('plus', 'v1', gapiClientLoaded);\n      });\n\n      function gapiClientLoaded() {\n\tgapi.client.plus.people.get({userId: 'me'}).execute(handleEmailResponse);\n      }\n\n      function handleEmailResponse(resp){\n        var primaryEmail;\n\tfor (var i=0; i < resp.emails.length; i++) {\n\t  if (resp.emails[i].type === 'account') primaryEmail = resp.emails[i].value;\n        }\n\tconsole.debug(\"Primary Email: \" + primaryEmail );\n\tconsole.debug(\"display name: \" + resp.displayName);\n\tconsole.debug(\"imageurl: \" + resp.image.url);\n\tconsole.debug(resp);\n\tconsole.debug(verto.data);\n\tverto.data.email = primaryEmail;\n\tverto.data.name = resp.displayName;\n\tstorage.data.name = verto.data.name;\n\tstorage.data.email = verto.data.email;\n\n\t$scope.login();\n      }\n\n      $scope.$on('event:google-plus-signin-failure', function (event,authResult) {\n        // Auth failure or signout detected\n        console.log('Google+ Login Failure');\n      });\n\n      $rootScope.callActive = function(data, params) {\n        verto.data.mutedMic = storage.data.mutedMic;\n        verto.data.mutedVideo = storage.data.mutedVideo;\n\n        if (!storage.data.cur_call) {\n          storage.data.call_start = new Date();\n        }\n        storage.data.userStatus = 'connected';\n        var call_start = new Date(storage.data.call_start);\n        $rootScope.start_time = call_start;\n\n        $timeout(function() {\n          $scope.$broadcast('timer-start');\n        });\n        myVideo.play();\n        storage.data.calling = false;\n\n        storage.data.cur_call = 1;\n\n        $location.path('/incall');\n\n        if(params.useVideo) {\n          $rootScope.$emit('call.video', 'video');\n        }\n      };\n\n      $rootScope.$on('call.active', function(event, data, params) {\n        $rootScope.callActive(data, params);\n      });\n\n      $rootScope.$on('call.calling', function(event, data) {\n        storage.data.calling = true;\n      });\n\n      $rootScope.$on('call.incoming', function(event, data) {\n        console.log('Incoming call from: ' + data);\n\n        storage.data.cur_call = 0;\n        $scope.incomingCall = true;\n        storage.data.videoCall = false;\n        storage.data.mutedVideo = false;\n        storage.data.mutedMic = false;\n\n        prompt({\n          title: $translate.instant('TITLE_INCOMING_CALL'),\n          message: $translate.instant('MESSAGE_INCOMING_CALL') + data\n        }).then(function() {\n          var call_start = new Date(storage.data.call_start);\n          $rootScope.start_time = call_start;\n          console.log($rootScope.start_time);\n\n          $scope.answerCall();\n          storage.data.called_number = data;\n          CallHistory.add(data, 'inbound', true);\n          $location.path('/incall');\n        }, function() {\n          $scope.declineCall();\n          CallHistory.add(data, 'inbound', false);\n        });\n      });\n\n      $scope.hold = function() {\n        storage.data.onHold = !storage.data.onHold;\n        verto.data.call.toggleHold();\n      };\n\n      /**\n       * Hangup the current call.\n       */\n      $scope.hangup = function() {\n        if (!verto.data.call) {\n          toastr.warning($translate.instant('MESSAGE_NO_HANGUP_CALL'));\n          $location.path('/dialpad');\n          return;\n        }\n\n        if ($rootScope.watcher) {\n          window.close();\n          return;\n        }\n\n        //var hangupCallback = function(v, hangup) {\n        //  if (hangup) {\n        //    $location.path('/dialpad');\n        //  } else {\n        //    console.debug('The call could not be hangup.');\n        //  }\n        //};\n        //\n        //verto.hangup(hangupCallback);\n        if (verto.data.shareCall) {\n          verto.screenshareHangup();\n        }\n\n        verto.hangup();\n\n        $rootScope.$emit('hangupCall');\n        $location.path('/dialpad');\n      };\n\n      $scope.answerCall = function() {\n        storage.data.onHold = false;\n\n        verto.data.call.answer({\n          useStereo: storage.data.useStereo,\n          useCamera: storage.data.selectedVideo,\n          useVideo: storage.data.useVideo,\n          useMic: storage.data.useMic,\n          callee_id_name: verto.data.name,\n          callee_id_number: verto.data.login\n        });\n\n\n        $location.path('/incall');\n      };\n\n      $scope.declineCall = function() {\n        $scope.hangup();\n        $scope.incomingCall = false;\n      };\n\n      $scope.play = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.play(file);\n            console.log('play file :', file);\n          });\n\n      };\n\n      $scope.stop = function() {\n        verto.data.conf.stop();\n      };\n\n      $scope.record = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.record(file);\n            console.log('recording file :', file);\n          });\n      };\n\n      $scope.stopRecord = function() {\n        verto.data.conf.stopRecord();\n      };\n\n      $scope.snapshot = function() {\n        var file = $scope.promptInput($translate.instant('MESSAGE_ENTER_FILENAME'), '', 'File',\n          function(file) {\n            verto.data.conf.snapshot(file);\n            console.log('snapshot file :', file);\n          });\n      };\n\n      function sinkIdCallback(success, deviceName) {\n        if (success) {\n          toastr.info('Speaker is now <span class=\"install\">' + deviceName + '</a>', 'Success', { allowHtml: true });\n        } else {\n          toastr.error('Your browser doesn\\'t seem to support this feature', 'Error');\n        }\n      }\n\n      $rootScope.dtmfWidget = function(number) {\n        $rootScope.dtmfHistory.value = $rootScope.dtmfHistory.value + number;\n        if (verto.data.call) {\n          verto.dtmf(number);\n        }\n      }\n\n      $rootScope.disableOnKeydownDtmf = function() {\n        $rootScope.onKeydownDtmfEnabled = false;\n      };\n\n      $rootScope.enableOnKeydownDtmf = function() {\n        $rootScope.onKeydownDtmfEnabled = true;\n      };\n\n      $rootScope.$on(\"$routeChangeStart\", function(event, next, current) {\n        if (next.$$route.originalPath === '/incall') {\n          $rootScope.dtmfHistory.value = '';\n          angular.element($window).bind('keydown', onKeydownDtmfHistory);\n        } else {\n          angular.element($window).unbind('keydown', onKeydownDtmfHistory);\n        }\n      });\n\n      function onKeydownDtmfHistory(event) {\n        var caracter = event.key;\n        if ($rootScope.onKeydownDtmfEnabled && caracter.match(/^(\\*|\\#|[0-9a-dA-D])$/g)) {\n          $rootScope.dtmfWidget(caracter);\n          $scope.$applyAsync();\n        }\n      }\n\n    }]\n  );\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n\t.controller('MenuController', ['$scope', '$http', '$location',\n\t  'verto', 'storage', '$rootScope',\n\t  function($scope, $http, $location, verto, storage, $rootScope) {\n\t    console.debug('Executing MenuController.');\n      $scope.storage = storage;\n\n      $rootScope.$on('testSpeed', function(e, data) {\n        var vidQual = storage.data.vidQual;\n\tvar bwp = 4;\n\n        $scope.bandDown = data.downKPS;\n        $scope.bandUp = data.upKPS;\n\n        if (data.downKPS < 2000) {\n          bwp--;\n        }\n\n        if (data.upKPS < 2000) {\n           bwp--;\n        }\n\n        $scope.iconClass = 'mdi-device-signal-wifi-4-bar green';                      \n\n        if (bwp < 4) {\n           $scope.iconClass = 'mdi-device-signal-wifi-3-bar yellow';\n        } else if (bwp < 2) {\n           $scope.iconClass = 'mdi-device-signal-wifi-1-bar red';\n        }\n\n        verto.videoQuality.forEach(function(vid) {\n          if (vid.id == vidQual){\n            $scope.vidRes = vid.label;\n          }\n        });\n\n        $scope.$apply();\n      });\n    }\n\t]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalDialpadController', ['$scope',\n      '$modalInstance',\n      function($scope, $modalInstance) {\n\n        $scope.ok = function() {\n          $modalInstance.close('Ok.');\n        };\n\n        $scope.cancel = function() {\n          $modalInstance.dismiss('cancel');\n        };\n\n      }\n    ]);\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalWsReconnectController', ModalWsReconnectController);\n\n    ModalWsReconnectController.$inject = ['$rootScope', '$scope', 'storage', 'verto'];\n\n    function ModalWsReconnectController($rootScope, $scope, storage, verto) {\n      console.debug('Executing ModalWsReconnectController'); \n\n      $scope.closeReconnect = closeReconnect;\n\n      function closeReconnect() {\n        if ($rootScope.ws_modalInstance && verto.data.instance) {\n          verto.data.instance.rpcClient.stopRetrying();\n          $rootScope.ws_modalInstance.close();\n          delete verto.data.instance;\n        }\n      };\n    };\n                \n                \n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('ModalLoginInformationController', ['$scope',\n      '$http', '$location', '$modalInstance', 'verto', 'storage',\n      function($scope, $http, $location, $modalInstance, verto, storage) {\n        console.debug('Executing ModalLoginInformationController.');\n\n        $scope.verto = verto;\n        $scope.storage = storage;\n\n        $scope.ok = function() {\n          $modalInstance.close('Ok.');\n        };\n\n        $scope.cancel = function() {\n          $modalInstance.dismiss('cancel');\n        };\n\n      }\n    ]);\n    \n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('SettingsController', ['$scope', '$http',\n      '$location', '$rootScope', 'storage', 'verto', '$translate', 'toastr', 'configLanguages',\n      function($scope, $http, $location, $rootScope, storage, verto, $translate, toastr, configLanguages) {\n        console.debug('Executing ModalSettingsController.');\n\n        $.material.init();\n\n        $scope.speakerFeature = typeof document.getElementById('webcam').sinkId !== 'undefined';\n        $scope.storage = storage;\n        $scope.verto = verto;\n        $scope.mydata = angular.copy(storage.data);\n        $scope.languages = configLanguages.languages;\n        $scope.languages.unshift({id: 'browser', name : $translate.instant('BROWSER_LANGUAGE')});\n        $scope.mydata.language = storage.data.language || 'browser';\n\n        $rootScope.$on('$translateChangeSuccess', function () {\n          $translate('BROWSER_LANGUAGE').then(function (translation) {\n          $scope.languages[0].name = translation;\n          });\n        });\n\n        $rootScope.$on('toggledSettings', function(e, status) {\n          if (status) {\n            $scope.mydata = angular.copy(storage.data);\n          } else {\n            $scope.ok();\n          }\n        });\n\n        $scope.ok = function() {\n          console.log('Camera Selected is', $scope.mydata.selectedVideo, $scope.verto.data.videoDevices);\n\n          angular.forEach(verto.data.videoDevices, function(video) {\n            console.log('checking video ', video);\n            if (video.id == $scope.mydata.selectedVideo) {\n              $scope.mydata.selectedVideoName = video.label;\n              console.log('Setting selectedVideoName to ', video.label);\n            }\n          })\n          if ($scope.mydata.selectedSpeaker != storage.data.selectedSpeaker) {\n            $rootScope.$emit('changedSpeaker', $scope.mydata.selectedSpeaker);\n          }\n          storage.changeData($scope.mydata);\n          verto.data.instance.iceServers(storage.data.useSTUN);\n\n          if (storage.data.autoBand) {\n            $scope.testSpeed();\n          }\n        };\n\n        $scope.changedLanguage = function(langKey){\n          if (langKey === 'browser'){\n           storage.data.language = 'browser';\n            var browserlang = $translate.preferredLanguage();\n            $translate.use(browserlang).then(\n              function(lang) {}, function(fail_lang) {\n                $translate.use('en');\n               });\n          } else {\n            $translate.use(langKey);\n            storage.data.language = langKey;\n          }\n        };\n\n        $scope.refreshDeviceList = function() {\n          return verto.refreshDevices();\n        };\n\n        $scope.showPreview = function() {\n          var settingsEl = angular.element(document.querySelector('#settings'));\n          settingsEl.toggleClass('toggled');\n          if (!verto.data.call) {\n            $location.path('/preview');\n            return;\n          }\n          else {\n            toastr.warning($translate.instant('MESSAGE_DISPLAY_SETTINGS'));\n          }\n        };\n\n        $scope.testSpeed = function() {\n          return verto.testSpeed(cb);\n\n          function cb(data) {\n            $scope.mydata.vidQual = storage.data.vidQual;\n            $scope.speedMsg = 'Up: ' + data.upKPS + ' Down: ' + data.downKPS;\n            $scope.$apply();\n          }\n        };\n\n        $scope.resetSettings = function() {\n\t  if (confirm('Factory Reset Settings?')) {\n            storage.factoryReset();\n            $scope.logout();\n\t    window.location.reload();\n\t  };\n        };\n\n        $scope.checkAutoBand = function(option) {\n          $scope.mydata.useDedenc = false;\n          var bestres = videoQuality[videoQuality.length-1];\n          $scope.mydata.vidQual = bestres.id;\n          storage.data.vidQual = bestres.id;\n          verto.data.instance.videoParams({\n            minWidth: bestres.width,\n            minHeight: bestres.height,\n            maxWidth: bestres.width,\n            maxHeight: bestres.height,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n          storage.data.vidQual = bestres.id;\n          if (!option) {\n            $scope.mydata.outgoingBandwidth = 'default';\n            $scope.mydata.incomingBandwidth = 'default';\n            $scope.mydata.testSpeedJoin = false;\n\n          } else {\n            $scope.mydata.testSpeedJoin = true;\n          }\n        };\n\n        $scope.checkUseDedRemoteEncoder = function(option) {\n          if (['0', 'default', '5120'].indexOf(option) != -1) {\n            $scope.mydata.useDedenc = false;\n          } else {\n            $scope.mydata.useDedenc = true;\n          }\n        };\n\n        $scope.checkVideoQuality = function(resolution) {\n          var w = videoResolution[resolution]['width'];\n          var h = videoResolution[resolution]['height'];\n          storage.data.vidQual = resolution;\n          verto.data.instance.videoParams({\n            minWidth: w,\n            minHeight: h,\n            maxWidth: w,\n            maxHeight: h,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n\n        };\n\n      }\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('vertoControllers')\n    .controller('PreviewController', ['$rootScope', '$scope',\n      '$http', '$location', '$modal', '$timeout', 'toastr', 'verto', 'storage', 'prompt', 'Fullscreen', '$translate',\n      function($rootScope, $scope, $http, $location, $modal, $timeout, toastr,\n        verto, storage, prompt, Fullscreen, $translate) {\n\n        $scope.storage = storage;\n        console.debug('Executing PreviewController.');\n        var localVideo = document.getElementById('videopreview');\n        var volumes = document.querySelector('#mic-meter .volumes');\n        if (volumes) {\n          volumes = volumes.children;\n        }\n\n        $scope.localVideo = function() {\n          var constraints = {\n            mirrored: true,\n            audio: {\n              optional: [{ sourceId: storage.data.selectedAudio }]\n            }\n          };\n\n          if (storage.data.selectedVideo !== 'none') {\n            constraints.video = {\n              optional: [{ sourceId: storage.data.selectedVideo }]\n            };\n          }\n\n          navigator.getUserMedia(constraints, handleMedia, function(err, data) {\n\n          });\n        };\n        var audioContext = null;\n        if (typeof AudioContext !== \"undefined\") {\n          audioContext = new AudioContext();\n        }\n\n        var mediaStreamSource = null;\n        var meter = null;\n        var streamObj = {};\n\n        function stopMedia(stream) {\n          if (typeof stream == 'function') {\n            stream.stop();\n          } else {\n            if (stream.active) {\n              var tracks = stream.getTracks();\n              tracks.forEach(function(track, index) {\n                track.stop();\n              })\n            }\n          }\n        }\n        function handleMedia(stream) {\n          if (streamObj) {\n            stopMedia(streamObj);\n          }\n\n          streamObj = stream;\n          FSRTCattachMediaStream(localVideo, stream);\n          if (audioContext) {\n            mediaStreamSource = audioContext.createMediaStreamSource(stream);\n            meter = createAudioMeter(audioContext);\n            mediaStreamSource.connect(meter);\n          };\n        }\n\n        function renderMic() {\n          // meter.volume;\n          var n = Math.round(meter.volume * 25);\n          for(var i = volumes.length -1, j = 0; i >= 0; i--, j++) {\n            var el = angular.element(volumes[j]);\n            if (i >= n) el.removeClass('active');\n            else        el.addClass('active');\n          }\n\n          if(!verto.data.call) {\n            window.requestAnimationFrame(renderMic);\n          }\n        }\n        /**\n         * TODO: useless?\n         */\n\n        $scope.refreshDeviceList = function() {\n         return verto.refreshDevices();\n        };\n\n        $scope.videoCall = function() {\n          prompt({\n            title: $translate.instant('TITLE_ENABLE_VIDEO'),\n            message: $translate.instant('MESSAGE_ENABLE_VIDEO')\n          }).then(function() {\n            storage.data.videoCall = true;\n            $scope.callTemplate = 'partials/video_call.html';\n          });\n        };\n\n        $scope.cbMuteVideo = function(event, data) {\n          storage.data.mutedVideo = !storage.data.mutedVideo;\n        }\n\n        $scope.cbMuteMic = function(event, data) {\n          storage.data.mutedMic = !storage.data.mutedMic;\n        }\n\n        $scope.confChangeVideoLayout = function(layout) {\n          verto.data.conf.setVideoLayout(layout);\n        };\n\n        $scope.endPreview = function() {\n          localVideo.src = null;\n          if (audioContext) {\n            meter.shutdown();\n            meter.onaudioprocess = null;\n          };\n          stopMedia(streamObj);\n          $location.path('/dialpad');\n          storage.data.preview = false;\n        };\n\n        $scope.localVideo();\n      }\n    ]);\n})();\n\n(function() {\n  'use strict';\n  var vertoDirectives = angular.module('vertoDirectives', []);\n})();\n\n/*\nSometimes autofocus HTML5 directive just isn't enough with SPAs.\nThis directive will force autofocus to work properly under those circumstances.\n*/\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('autofocus', ['$timeout',\n    function ($timeout) {\n      return {\n        restrict: 'A',\n        link: function ($scope, $element) {\n          $timeout(function () {\n            $element[0].focus();\n          });\n        }\n      };\n    }\n  ]);\n})();\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('showControls',\n  [\"Fullscreen\", function(Fullscreen) {\n    var link = function(scope, element, attrs) {\n      var i = null;\n      jQuery('.video-footer').fadeIn('slow');\n      jQuery('.video-hover-buttons').fadeIn('slow');\n      element.parent().bind('mousemove', function() {\n        if (Fullscreen.isEnabled()) {\n          clearTimeout(i);\n          jQuery('.video-footer').fadeIn('slow');\n          jQuery('.video-hover-buttons').fadeIn(500);\n          i = setTimeout(function() {\n            if (Fullscreen.isEnabled()) {\n              jQuery('.video-footer').fadeOut('slow');\n              jQuery('.video-hover-buttons').fadeOut(500);\n            }\n          }, 3000);\n        }\n      });\n      element.parent().bind('mouseleave', function() {\n        jQuery('.video-footer').fadeIn();\n        jQuery('.video-hover-buttons').fadeIn();\n      });\n    }\n\n\n    return {\n      link: link\n    };\n  }]);\n\n})();\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives').directive('userStatus',\n  function() {\n    var link = function(scope, element, attrs) {\n      scope.$watch('condition', function(condition) {\n        element.removeClass('connected');\n        element.removeClass('disconnected');\n        element.removeClass('connecting');\n\n        element.addClass(condition);\n\n      });\n    }\n\n    return {\n      scope: {\n        'condition': '='\n      },\n      link: link\n    };\n\n  });\n\n})();\n/**\n * To RTC work properly we need to give a <video> tag as soon as possible\n * because it needs to attach the video and audio stream to the tag.\n *\n * This directive is responsible for moving the video tag from the body to\n * the right place when a call start and move back to the body when the\n * call ends. It also hides and display the tag when its convenient.\n */\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoDirectives')\n  .directive('videoTag',\n  function() {\n\n    function link(scope, element, attrs) {\n      // Moving the video tag to the new place inside the incall page.\n      console.log('Moving the video to element.');\n      var videoElem = jQuery('#webcam');\n\n      var newParent = document.getElementsByClassName('video-tag-wrapper');\n\tnewParent[0].appendChild(document.getElementById('webcam'));\n\n\t$(\"#webcam\").resize(function() {\n\t    updateVideoSize();\n\t});\n\n\t$(window).resize(function() {\n\t    updateVideoSize();\n\t});\n\n\tupdateVideoSize();\n\t\n\tvideoElem.removeClass('hide');\n\tvideoElem.css('display', 'block');\n\n      scope.callActive(\"\", {useVideo: true});\n\n      element.on('$destroy', function() {\n        // Move the video back to the body.\n        console.log('Moving the video back to body.');\n        videoElem.addClass('hide').appendTo(jQuery('body'));\n        $(window).unbind('resize');\n      });\n    }\n\n    return {\n      link: link\n    }\n  });\n\n})();\n\n(function() {\n  'use strict';\n  var vertoFilters = angular.module('vertoFilters', []);\n})();\n\n(function () {\n  'use strict';\n\n  angular\n  .module('vertoFilters')\n  .filter('picturify', function() {\n    var regex = /<a (|target=\"\\s*\\S*\" )href=\"(\\s*\\S*.(png|jpg|svg|gif|webp|bmp))\">\\s*\\S*<\\/a>/i;\n    var regex64 = /data:image\\/(\\s*\\S*);base64,((?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=))/g;\n\n    return function (text, width, n) {\n      var i = 0;\n      width = width || 150; //default width\n      if(regex64.test(text)) {\n        text = text.replace(regex64, '<a href=\"$1\" target=\"_blank\"><img class=\"chat-img\" width=\"'+ width +'\" src=\"data:image/png;base64,$2\"/></a>')\n      }\n\n      do {\n        text = text.replace(regex, '<a $1href=\"$2\"><img class=\"chat-img\" width=\"'+ width +'\" src=\"$2\"/></a>');\n      } while((!n || (n && i++ < n)) && regex.test(text));\n\n      return text;\n    }\n\n  });\n\n})();\n\n(function() {\n  'use strict';\n  var vertoService = angular.module('vertoService', []);\n})();\n\n'use strict';\n\n/* Controllers */\nvar videoQuality = [];\nvar videoQualitySource = [{\n  id: 'qqvga',\n  label: 'QQVGA 160x120',\n  width: 160,\n  height: 120\n}, {\n  id: 'qvga',\n  label: 'QVGA 320x240',\n  width: 320,\n  height: 240\n}, {\n  id: 'vga',\n  label: 'VGA 640x480',\n  width: 640,\n  height: 480\n}, {\n  id: 'qvga_wide',\n  label: 'QVGA WIDE 320x180',\n  width: 320,\n  height: 180\n}, {\n  id: 'vga_wide',\n  label: 'VGA WIDE 640x360',\n  width: 640,\n  height: 360\n}, {\n  id: 'hd',\n  label: 'HD 1280x720',\n  width: 1280,\n  height: 720\n}, {\n  id: 'hhd',\n  label: 'HHD 1920x1080',\n  width: 1920,\n  height: 1080\n}, ];\n\nvar videoResolution = {\n  qqvga: {\n    width: 160,\n    height: 120\n  },\n  qvga: {\n    width: 320,\n    height: 240\n  },\n  vga: {\n    width: 640,\n    height: 480\n  },\n  qvga_wide: {\n    width: 320,\n    height: 180\n  },\n  vga_wide: {\n    width: 640,\n    height: 360\n  },\n  hd: {\n    width: 1280,\n    height: 720\n  },\n  hhd: {\n    width: 1920,\n    height: 1080\n  },\n};\n\nvar bandwidth = [{\n  id: '250',\n  label: '250kb'\n}, {\n  id: '500',\n  label: '500kb'\n}, {\n  id: '1024',\n  label: '1mb'\n}, {\n  id: '1536',\n  label: '1.5mb'\n}, {\n  id: '2048',\n  label: '2mb'\n}, {\n  id: '3196',\n  label: '3mb'\n}, {\n  id: '4192',\n  label: '4mb'\n}, {\n  id: '5120',\n  label: '5mb'\n}, {\n  id: '0',\n  label: 'No Limit'\n}, {\n  id: 'default',\n  label: 'Server Default'\n}, ];\n\nvar framerate = [{\n  id: '15',\n  label: '15 FPS'\n}, {\n  id: '20',\n  label: '20 FPS'\n}, {\n  id: '30',\n  label: '30 FPS'\n}, ];\n\nvar updateReq;\n\nvar updateVideoSize = function(ms) {\n    if (!ms) ms = 500;\n    \n    clearTimeout(updateReq);\n    updateReq = setTimeout(function () {\n        var videoElem = jQuery('#webcam');\n        videoElem.width(\"\");\n        videoElem.height(\"\");\n\t\n        var w = videoElem.width();\n        var h = videoElem.height();\n        var new_w, new_h;\n        var aspect = 1920 / 1080;\n        var videoContainer = jQuery('div.video-wrapper');\n        if (w > h) {\n            new_w = videoContainer.width();\n            new_h = Math.round(videoContainer.width() / aspect);\n        } else {\n            new_h = videoContainer.height();\n            new_w = Math.round(videoContainer.height() / aspect);\n        }\n        videoElem.width(new_w);\n        videoElem.height(new_h);\n        console.log('Setting video size to ' + new_w + '/' + new_h);\n    }, ms);\n}\n\nvar vertoService = angular.module('vertoService', ['ngCookies']);\n\nvertoService.service('verto', ['$rootScope', '$cookieStore', '$location', 'storage',\n  function($rootScope, $cookieStore, $location, storage) {\n    var data = {\n      // Connection data.\n      instance: null,\n      connected: false,\n\n      // Call data.\n      call: null,\n      shareCall: null,\n      callState: null,\n      conf: null,\n      confLayouts: [],\n      confRole: null,\n      chattingWith: null,\n      liveArray: null,\n\n      // Settings data.\n      videoDevices: [],\n      audioDevices: [],\n      shareDevices: [],\n      videoQuality: [],\n      extension: $cookieStore.get('verto_demo_ext'),\n      name: $cookieStore.get('verto_demo_name'),\n      email: $cookieStore.get('verto_demo_email'),\n      cid: $cookieStore.get('verto_demo_cid'),\n      textTo: $cookieStore.get('verto_demo_textto') || \"1000\",\n      login: $cookieStore.get('verto_demo_login') || \"1008\",\n      password: $cookieStore.get('verto_demo_passwd') || \"1234\",\n      hostname: window.location.hostname,\n      wsURL: (\"wss://\" + window.location.hostname + \":8082\")\n    };\n\n    function cleanShareCall(that) {\n      data.shareCall = null;\n      data.callState = 'active';\n      that.refreshDevices();\n    }\n\n    function cleanCall() {\n      data.call = null;\n      data.callState = null;\n      data.conf = null;\n      data.confLayouts = [];\n      data.confRole = null;\n      data.chattingWith = null;\n\n      $rootScope.$emit('call.hangup', 'hangup');\n    }\n\n    function inCall() {\n      $rootScope.$emit('page.incall', 'call');\n    }\n\n    function callActive(last_state, params) {\n      $rootScope.$emit('call.active', last_state, params);\n    }\n\n    function calling() {\n      $rootScope.$emit('call.calling', 'calling');\n    }\n\n    function incomingCall(number) {\n      $rootScope.$emit('call.incoming', number);\n    }\n\n    function updateResolutions(supportedResolutions) {\n      console.debug('Attempting to sync supported and available resolutions');\n\n      //var removed = 0;\n\n      console.debug(\"VQ length: \" + videoQualitySource.length);\n      console.debug(supportedResolutions);\n\n      angular.forEach(videoQualitySource, function(resolution, id) {\n        angular.forEach(supportedResolutions, function(res) {\n          var width = res[0];\n          var height = res[1];\n\n          if(resolution.width == width && resolution.height == height) {\n            videoQuality.push(resolution);\n          }\n        });\n      });\n\n      // videoQuality.length = videoQuality.length - removed;\n      console.debug(\"VQ length 2: \" + videoQuality.length);\n      data.videoQuality = videoQuality;\n      console.debug(videoQuality);\n      data.vidQual = (videoQuality.length > 0) ? videoQuality[videoQuality.length - 1].id : null;\n      console.debug(data.vidQual);\n\n      return videoQuality;\n    };\n\n    var callState = {\n      muteMic: false,\n      muteVideo: false\n    };\n\n    return {\n      data: data,\n      callState: callState,\n\n      // Options to compose the interface.\n      videoQuality: videoQuality,\n      videoResolution: videoResolution,\n      bandwidth: bandwidth,\n      framerate: framerate,\n\n      refreshDevicesCallback : function refreshDevicesCallback(callback) {\n        data.videoDevices = [{\n          id: 'none',\n          label: 'No Camera'\n        }];\n        data.shareDevices = [{\n          id: 'screen',\n          label: 'Screen'\n        }];\n        data.audioDevices = [];\n        data.speakerDevices = [];\n\n        if(!storage.data.selectedShare) {\n          storage.data.selectedShare = data.shareDevices[0]['id'];\n        }\n\n        for (var i in jQuery.verto.videoDevices) {\n          var device = jQuery.verto.videoDevices[i];\n          if (!device.label) {\n            data.videoDevices.push({\n              id: 'Camera ' + i,\n              label: 'Camera ' + i\n            });\n          } else {\n            data.videoDevices.push({\n              id: device.id,\n              label: device.label || device.id\n            });\n          }\n\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedVideo) {\n            storage.data.selectedVideo = device.id;\n          }\n\n          if (!device.label) {\n            data.shareDevices.push({\n              id: 'Share Device ' + i,\n              label: 'Share Device ' + i\n            });\n            continue;\n          }\n\n          data.shareDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n\n        for (var i in jQuery.verto.audioInDevices) {\n          var device = jQuery.verto.audioInDevices[i];\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedAudio) {\n            storage.data.selectedAudio = device.id;\n          }\n\n          if (!device.label) {\n            data.audioDevices.push({\n              id: 'Microphone ' + i,\n              label: 'Microphone ' + i\n            });\n            continue;\n          }\n          data.audioDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n\n        for (var i in jQuery.verto.audioOutDevices) {\n          var device = jQuery.verto.audioOutDevices[i];\n          // Selecting the first source.\n          if (i == 0 && !storage.data.selectedSpeaker) {\n            storage.data.selectedSpeaker = device.id;\n          }\n\n          if (!device.label) {\n            data.speakerDevices.push({\n              id: 'Speaker ' + i,\n              label: 'Speaker ' + i\n            });\n            continue;\n          }\n          data.speakerDevices.push({\n            id: device.id,\n            label: device.label || device.id\n          });\n        }\n        console.debug('Devices were refreshed, checking that we have cameras.');\n\n        // Verify if selected devices are valid\n        var videoFlag = data.videoDevices.some(function(device) {\n          console.log('Evaluating device ', device);\n          if (device.label == storage.data.selectedVideoName) {\n            console.log('Matched video selection by name: ', device.label);\n            storage.data.selectedVideo = device.id;\n            return true;\n          }\n          return device.id == storage.data.selectedVideo && storage.data.selectedVideo !== \"none\";\n        });\n\n        var shareFlag = data.shareDevices.some(function(device) {\n          return device.id == storage.data.selectedShare;\n        });\n\n        var audioFlag = data.audioDevices.some(function(device) {\n          return device.id == storage.data.selectedAudio;\n        });\n\n        var speakerFlag = data.speakerDevices.some(function(device) {\n          return device.id == storage.data.selectedSpeaker;\n        });\n\n        console.log('Storage Video: ', storage.data.selectedVideo);\n        console.log('Video Flag: ', videoFlag)\n\n        if (!videoFlag) storage.data.selectedVideo = data.videoDevices[data.videoDevices.length - 1].id;\n        if (!shareFlag) storage.data.selectedShare = data.shareDevices[0].id;\n        if (!audioFlag) storage.data.selectedAudio = data.audioDevices[0].id;\n        if (!speakerFlag && data.speakerDevices.length > 0) storage.data.selectedSpeaker = data.speakerDevices[0].id;\n\n        // This means that we cannot use video!\n        if (data.videoDevices.length === 0) {\n          console.log('No camera, disabling video.');\n          data.canVideo = false;\n          data.videoDevices.push({\n            id: 'none',\n            label: 'No camera'\n          });\n        } else {\n          data.canVideo = true;\n        }\n\n        if(angular.isFunction(callback)) {\n          callback();\n        }\n      },\n\n      refreshDevices: function(callback) {\n        console.debug('Attempting to refresh the devices.');\n        if(callback) {\n          jQuery.verto.refreshDevices(callback);\n        } else {\n          jQuery.verto.refreshDevices(this.refreshDevicesCallback);\n        }\n      },\n\n      /**\n       * Updates the video resolutions based on settings.\n       */\n      refreshVideoResolution: function(resolutions) {\n        console.debug('Attempting to refresh video resolutions.');\n\n        if (data.instance) {\n          var w = resolutions['bestResSupported'][0];\n          var h = resolutions['bestResSupported'][1];\n\n          if (h === 1080) {\n            w = 1280;\n            h = 720;\n          }\n\n          updateResolutions(resolutions['validRes']);\n          data.instance.videoParams({\n            minWidth: w,\n            minHeight: h,\n            maxWidth: w,\n            maxHeight: h,\n            minFrameRate: 15,\n            vertoBestFrameRate: storage.data.bestFrameRate\n          });\n          videoQuality.forEach(function(qual){\n            if (w === qual.width && h === qual.height) {\n              if (storage.data.vidQual !== qual.id || storage.data.vidQual === undefined) {\n                storage.data.vidQual = qual.id;\n              }\n            }\n\n          });\n\n        } else {\n          console.debug('There is no instance of verto.');\n        }\n      },\n\n      /**\n       * Connects to the verto server. Automatically calls `onWSLogin`\n       * callback set in the verto object.\n       *\n       * @param callback\n       */\n      connect: function(callback) {\n        console.debug('Attempting to connect to verto.');\n        var that = this;\n\n        function startConference(v, dialog, pvtData) {\n          $rootScope.$emit('call.video', 'video');\n          $rootScope.$emit('call.conference', 'conference');\n          data.chattingWith = pvtData.chatID;\n          data.confRole = pvtData.role;\n          data.conferenceMemberID = pvtData.conferenceMemberID;\n          var conf = new $.verto.conf(v, {\n            dialog: dialog,\n            hasVid: storage.data.useVideo,\n            laData: pvtData,\n            chatCallback: function(v, e) {\n              var from = e.data.fromDisplay || e.data.from || \"Unknown\";\n              var message = e.data.message || \"\";\n              $rootScope.$emit('chat.newMessage', {\n                from: from,\n                body: message\n              });\n            },\n            onBroadcast: function(v, conf, message) {\n              console.log('>>> conf.onBroadcast:', arguments);\n              if (message.action == 'response') {\n                // This is a response with the video layouts list.\n                if (message['conf-command'] == 'list-videoLayouts') {\n                  var rdata = [];\n\n                  for (var i in message.responseData) {\n                    rdata.push(message.responseData[i].name);\n                  }\n\n                  var options = rdata.sort(function(a, b) {\n                    var ga = a.substring(0, 6) == \"group:\" ? true : false;\n                    var gb = b.substring(0, 6) == \"group:\" ? true : false;\n\n                    if ((ga || gb) && ga != gb) {\n                      return ga ? -1 : 1;\n                    }\n\n                    return ( ( a == b ) ? 0 : ( ( a > b ) ? 1 : -1 ) );\n                  });\n                  data.confLayoutsData = message.responseData;\n                  data.confLayouts = options;\n                } else if (message['conf-command'] == 'canvasInfo') {\n                  data.canvasInfo = message.responseData;\n                  $rootScope.$emit('conference.canvasInfo', message.responseData);\n                } else {\n                  $rootScope.$emit('conference.broadcast', message);\n                }\n              }\n            }\n          });\n\n          if (data.confRole == \"moderator\") {\n            console.log('>>> conf.listVideoLayouts();');\n            conf.listVideoLayouts();\n            conf.modCommand('canvasInfo');\n          }\n\n          data.conf = conf;\n\n          data.liveArray = new $.verto.liveArray(\n            data.instance, pvtData.laChannel,\n            pvtData.laName, {\n              subParams: {\n                callID: dialog ? dialog.callID : null\n              }\n            });\n\n          data.liveArray.onErr = function(obj, args) {\n            console.log('liveArray.onErr', obj, args);\n          };\n\n          data.liveArray.onChange = function(obj, args) {\n            // console.log('liveArray.onChange', obj, args);\n            switch (args.action) {\n              case 'bootObj':\n                $rootScope.$emit('members.boot', args.data);\n                args.data.forEach(function(member){\n                  var callId = member[0];\n                  var status = angular.fromJson(member[1][4]);\n                  if (callId === data.call.callID) {\n                    $rootScope.$apply(function(){\n                      data.mutedMic = status.audio.muted;\n                      data.mutedVideo = status.video.muted;\n                    });\n                  }\n                });\n                break;\n              case 'add':\n                var member = [args.key, args.data];\n                $rootScope.$emit('members.add', member);\n                break;\n              case 'del':\n                var uuid = args.key;\n                $rootScope.$emit('members.del', uuid);\n                break;\n              case 'clear':\n                $rootScope.$emit('members.clear');\n                break;\n              case 'modify':\n                var member = [args.key, args.data];\n                $rootScope.$emit('members.update', member);\n                break;\n              default:\n                console.log('NotImplemented', args.action);\n            }\n          };\n        }\n\n        function stopConference() {\n          console.log('stopConference()');\n          if (data.liveArray) {\n            data.liveArray.destroy();\n            console.log('Has data.liveArray.');\n            $rootScope.$emit('members.clear');\n            data.liveArray = null;\n          } else {\n            console.log('Doesn\\'t found data.liveArray.');\n          }\n\n          if (data.conf) {\n            data.conf.destroy();\n            data.conf = null;\n          }\n        }\n\n        var callbacks = {\n          onWSLogin: function(v, success) {\n            data.connected = success;\n            $rootScope.$emit('ws.login', success);\n            console.debug('Connected to verto server:', success);\n\n            if (angular.isFunction(callback)) {\n              callback(v, success);\n            }\n          },\n\n          onMessage: function(v, dialog, msg, params) {\n            console.debug('onMessage:', v, dialog, msg, params);\n\n            switch (msg) {\n              case $.verto.enum.message.pvtEvent:\n                if (params.pvtData) {\n                  switch (params.pvtData.action) {\n                    case \"conference-liveArray-join\":\n\t\t      if (!params.pvtData.screenShare && !params.pvtData.videoOnly) {\n\t\t\t  console.log(\"conference-liveArray-join\");\n\t\t\t  stopConference();\n\t\t\t  startConference(v, dialog, params.pvtData);\n\t\t\t  updateVideoSize();\n\t\t      }\n                      break;\n                    case \"conference-liveArray-part\":\n\t\t      if (!params.pvtData.screenShare && !params.pvtData.videoOnly) {\n\t\t\t  console.log(\"conference-liveArray-part\");\n\t\t\t  stopConference();\n\t\t      }\n                      break;\n                  }\n                }\n                break;\n              /**\n                * This is not being used for conferencing chat\n                * anymore (see conf.chatCallback for that).\n                */\n              case $.verto.enum.message.info:\n                var body = params.body;\n                var from = params.from_msg_name || params.from;\n                if (!body) {\n                  console.log('Received an empty body: ', params);\n                  return;\n                }\n                $rootScope.$emit('chat.newMessage', {\n                  from: from,\n                  body: body\n                });\n                break;\n              case $.verto.enum.message.display:\n                    $rootScope.$apply(function() {});\n                    break;\n              default:\n                console.warn('Got a not implemented message:', msg, dialog, params);\n                break;\n            }\n          },\n\n          onDialogState: function(d) {\n            if (!data.call) {\n              data.call = d;\n\n            }\n\n            console.debug('onDialogState:', d);\n            switch (d.state.name) {\n              case \"ringing\":\n                incomingCall(d.params.caller_id_number);\n                break;\n              case \"trying\":\n                console.debug('Calling:', d.cidString());\n                data.callState = 'trying';\n                break;\n              case \"early\":\n                console.debug('Talking to:', d.cidString());\n                data.callState = 'active';\n                calling();\n                break;\n              case \"active\":\n                console.debug('Talking to:', d.cidString());\n                data.callState = 'active';\n                callActive(d.lastState.name, d.params);\n\t\tupdateVideoSize();\n                break;\n              case \"hangup\":\n                console.debug('Call ended with cause: ' + d.cause);\n                data.callState = 'hangup';\n                break;\n              case \"destroy\":\n                console.debug('Destroying: ' + d.cause);\n                if (d.params.screenShare) {\n                  cleanShareCall(that);\n                } else {\n                  stopConference();\n                  if (!that.reloaded) {\n                    cleanCall();\n                  }\n                }\n                break;\n              default:\n                console.warn('Got a not implemented state:', d);\n                break;\n            }\n          },\n\n          onWSClose: function(v, success) {\n            console.debug('onWSClose:', success);\n\n            $rootScope.$emit('ws.close', success);\n          },\n\n          onEvent: function(v, e) {\n            console.debug('onEvent:', e);\n          }\n        };\n\n        var that = this;\n        function ourBootstrap() {\n          var sessid = $location.search().sessid;\n          if (sessid === 'random') {\n            sessid = $.verto.genUUID();\n            $location.search().sessid = sessid;\n          }\n          // Checking if we have a failed connection attempt before\n          // connecting again.\n          if (data.instance && !data.instance.rpcClient.socketReady()) {\n            data.instance.rpcClient.stopRetrying();\n            data.instance.logout();\n            data.instance.login();\n            return;\n          };\n          data.instance = new jQuery.verto({\n            login: data.login + '@' + data.hostname,\n            passwd: data.password,\n            socketUrl: data.wsURL,\n            tag: \"webcam\",\n            ringFile: \"sounds/bell_ring2.wav\",\n            // TODO: Add options for this.\n            audioParams: {\n                googEchoCancellation: storage.data.googEchoCancellation === undefined ? true : storage.data.googEchoCancellation,\n                googNoiseSuppression: storage.data.googNoiseSuppression === undefined ? true : storage.data.googNoiseSuppression,\n                googHighpassFilter: storage.data.googHighpassFilter === undefined ? true : storage.data.googHighpassFilter,\n                googAutoGainControl: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl,\n                googAutoGainControl2: storage.data.googAutoGainControl === undefined ? true : storage.data.googAutoGainControl\n            },\n            sessid: sessid,\n            iceServers: storage.data.useSTUN\n          }, callbacks);\n\n          // We need to know when user reloaded page and not react to\n          // verto events in order to not stop the reload and redirect user back\n          // to the dialpad.\n          that.reloaded = false;\n          jQuery.verto.unloadJobs.push(function() {\n            that.reloaded = true;\n          });\n\n          data.instance.deviceParams({\n            useCamera: storage.data.selectedVideo,\n            useSpeak: storage.data.selectedSpeaker,\n            useMic: storage.data.selectedAudio,\n            onResCheck: that.refreshVideoResolution\n          });\n        }\n        if (data.mediaPerm) {\n          ourBootstrap();\n        } else {\n          $.FSRTC.checkPerms(ourBootstrap, true, true);\n        }\n      },\n\n      mediaPerm: function(callback) {\n        $.FSRTC.checkPerms(callback, true, true);\n      },\n\n      /**\n       * Login the client.\n       *\n       * @param callback\n       */\n      login: function(callback) {\n        data.instance.loginData({\n          login: data.login + '@' + data.hostname,\n          passwd: data.password\n        });\n        data.instance.login();\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Disconnects from the verto server. Automatically calls `onWSClose`\n       * callback set in the verto object.\n       *\n       * @param callback\n       */\n      disconnect: function(callback) {\n        console.debug('Attempting to disconnect to verto.');\n\n        data.instance.logout();\n        data.connected = false;\n\n        console.debug('Disconnected from verto server.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, data.connected);\n        }\n      },\n\n      /**\n       * Make a call.\n       *\n       * @param callback\n       */\n      call: function(destination, callback, custom) {\n        console.debug('Attempting to call destination ' + destination + '.');\n\n        var call = data.instance.newCall(angular.extend({\n          destination_number: destination,\n          caller_id_name: data.name,\n          caller_id_number: data.callerid ? data.callerid : data.email,\n          outgoingBandwidth: storage.data.outgoingBandwidth,\n          incomingBandwidth: storage.data.incomingBandwidth,\n          useVideo: storage.data.useVideo,\n          useStereo: storage.data.useStereo,\n          useCamera: storage.data.selectedVideo,\n          useSpeak: storage.data.selectedSpeaker,\n          useMic: storage.data.selectedAudio,\n          dedEnc: storage.data.useDedenc,\n          mirrorInput: storage.data.mirrorInput,\n          userVariables: {\n            email : storage.data.email,\n            avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n          }\n        }, custom));\n\n        data.call = call;\n\n        data.mutedMic = false;\n        data.mutedVideo = false;\n\n        this.refreshDevices();\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, call);\n        }\n      },\n\n      screenshare: function(destination, callback) {\n\n\t  \n          var that = this;\n\t  \n\t  if (storage.data.selectedShare !== \"screen\") {\n\n              console.log('share screen from device ' + storage.data.selectedShare);\n\n\t      var call = data.instance.newCall({\n\t\t  destination_number: destination + \"-screen\",\n\t\t  caller_id_name: data.name + \" (Screen)\",\n\t\t  caller_id_number: data.login + \" (screen)\",\n\t\t  outgoingBandwidth: storage.data.outgoingBandwidth,\n\t\t  incomingBandwidth: storage.data.incomingBandwidth,\n\t\t  useCamera: storage.data.selectedShare,\n\t\t  useVideo: true,\n\t\t  screenShare: true,\n\t\t  dedEnc: storage.data.useDedenc,\n\t\t  mirrorInput: storage.data.mirrorInput,\n\t\t  userVariables: {\n\t\t      email : storage.data.email,\n\t\t      avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n\t\t  }\n\t      });\n\n              // Override onStream callback in $.FSRTC instance\n              call.rtc.options.callbacks.onStream = function(rtc, stream) {\n\t\t  if(stream) {\n\t\t      var StreamTrack = stream.getVideoTracks()[0];\n\t\t      StreamTrack.addEventListener('ended', stopSharing);\n\t\t      // (stream.getVideoTracks()[0]).onended = stopSharing;\n\t\t  }\n\t\t  \n\t\t  console.log(\"screenshare started\");\n\t\t  \n\t\t  function stopSharing() {\n\t\t      if(that.data.shareCall) {\n\t\t\t  that.screenshareHangup();\n\t\t\t  console.log(\"screenshare ended\");\n\t\t      }\n\t\t  }\n              };\n\t      \n              data.shareCall = call;\n\t      \n              console.log('shareCall', data);\n\t      \n              data.mutedMic = false;\n              data.mutedVideo = false;\n\t      \n              that.refreshDevices();\n\t      \n\t      return;\n\t  }\n\n\n        console.log('share screen from plugin');\n\n        getScreenId(function(error, sourceId, screen_constraints) {\n\n          if(error) {\n            $rootScope.$emit('ScreenShareExtensionStatus', error);\n            return;\n          }\n\n          var call = data.instance.newCall({\n            destination_number: destination + '-screen',\n            caller_id_name: data.name + ' (Screen)',\n            caller_id_number: data.login + ' (Screen)',\n            outgoingBandwidth: storage.data.outgoingBandwidth,\n            incomingBandwidth: storage.data.incomingBandwidth,\n            videoParams: screen_constraints.video.mandatory,\n            useVideo: true,\n            screenShare: true,\n            dedEnc: storage.data.useDedenc,\n            mirrorInput: storage.data.mirrorInput,\n            userVariables: {\n              email : storage.data.email,\n              avatar: \"http://gravatar.com/avatar/\" + md5(storage.data.email) + \".png?s=600\"\n            }\n          });\n\n          // Override onStream callback in $.FSRTC instance\n          call.rtc.options.callbacks.onStream = function(rtc, stream) {\n            if(stream) {\n              var StreamTrack = stream.getVideoTracks()[0];\n              StreamTrack.addEventListener('ended', stopSharing);\n              // (stream.getVideoTracks()[0]).onended = stopSharing;\n            }\n\n            console.log(\"screenshare started\");\n\n            function stopSharing() {\n              if(that.data.shareCall) {\n                that.screenshareHangup();\n                console.log(\"screenshare ended\");\n              }\n            }\n          };\n\n          data.shareCall = call;\n\n          console.log('shareCall', data);\n\n          data.mutedMic = false;\n          data.mutedVideo = false;\n\n          that.refreshDevices();\n\n        });\n\n      },\n\n      screenshareHangup: function() {\n        if (!data.shareCall) {\n          console.debug('There is no call to hangup.');\n          return false;\n        }\n\n        console.log('shareCall End', data.shareCall);\n        data.shareCall.hangup();\n\n        console.debug('The screencall was hangup.');\n\n      },\n\n      /**\n       * Hangup the current call.\n       *\n       * @param callback\n       */\n      hangup: function(callback) {\n        console.debug('Attempting to hangup the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to hangup.');\n          return false;\n        }\n\n        data.call.hangup();\n\n        if (data.conf) {\n          data.conf.destroy();\n          data.conf = null;\n        }\n\n        console.debug('The call was hangup.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Send a DTMF to the current call.\n       *\n       * @param {string|integer} number\n       * @param callback\n       */\n      dtmf: function(number, callback) {\n        console.debug('Attempting to send DTMF \"' + number + '\".');\n\n        if (!data.call) {\n          console.debug('There is no call to send DTMF.');\n          return false;\n        }\n\n        data.call.dtmf(number.toString());\n        console.debug('The DTMF was sent for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Do speed test.\n       *\n       * @param callback\n       */\n      testSpeed: function(cb) {\n\n        data.instance.rpcClient.speedTest(1024 * 256, function(e, data) {\n          var upBand = Math.ceil(data.upKPS * .75),\n              downBand = Math.ceil(data.downKPS * .75);\n\n\n          if (storage.data.autoBand) {\n            storage.data.incomingBandwidth = downBand;\n            storage.data.outgoingBandwidth = upBand;\n            storage.data.useDedenc = false;\n            storage.data.vidQual = 'hd';\n\n            if (upBand < 256) {\n              storage.data.vidQual = 'qqvga';\n            }\n            else if (upBand < 512) {\n              storage.data.vidQual = 'qvga';\n            }\n            else if (upBand < 1024) {\n              storage.data.vidQual = 'vga';\n            }\n          }\n\n          if(cb) {\n            cb(data);\n          }\n\n          $rootScope.$emit('testSpeed', data);\n        });\n      },\n      /**\n       * Mute the microphone for the current call.\n       *\n       * @param callback\n       */\n      muteMic: function(callback) {\n        console.debug('Attempting to mute mic for the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to mute.');\n          return false;\n        }\n\n        data.call.dtmf('0');\n        data.mutedMic = !data.mutedMic;\n        console.debug('The mic was muted for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n\n      /**\n       * Mute the video for the current call.\n       *\n       * @param callback\n       */\n      muteVideo: function(callback) {\n        console.debug('Attempting to mute video for the current call.');\n\n        if (!data.call) {\n          console.debug('There is no call to mute.');\n          return false;\n        }\n\n        data.call.dtmf('*0');\n        data.mutedVideo = !data.mutedVideo;\n        console.debug('The video was muted for the call.');\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      },\n      /*\n      * Method is used to send conference chats ONLY.\n      */\n      sendConferenceChat: function(message) {\n        data.conf.sendChat(message, \"message\");\n      },\n      setCanvasIn: function(memberID, canvasID) {\n        data.conf.modCommand('vid-canvas', memberID, canvasID);\n      },\n      setCanvasOut: function(memberID, canvasID) {\n        data.conf.modCommand('vid-watching-canvas', memberID, canvasID);\n      },\n      setLayer: function(memberID, canvasID) {\n        data.conf.modCommand('vid-layer', memberID, canvasID);\n      },\n      /*\n      * Method is used to set a member's resevartion Id.\n      */\n      setResevartionId: function(memberID, resID) {\n        data.conf.modCommand('vid-res-id', memberID, resID);\n      },\n      /*\n      * Method is used to send user2user chats.\n      * VC does not yet support that.\n      */\n      sendMessage: function(body, callback) {\n        data.call.message({\n          to: data.chattingWith,\n          body: body,\n          from_msg_name: data.name,\n          from_msg_number: data.cid\n        });\n\n        if (angular.isFunction(callback)) {\n          callback(data.instance, true);\n        }\n      }\n    };\n  }\n]);\n\n'use strict';\n\nvar vertoService = angular.module('vertoService');\n\nvertoService.service('config', ['$rootScope', '$http', '$location', 'storage', 'verto',\n  function($rootScope, $http, $location, storage, verto) {\n    var configure = function() {\n      /**\n       * Load stored user info into verto service\n       */\n      if(storage.data.name) {\n        verto.data.name = storage.data.name;\n      }\n      if(storage.data.email) {\n        verto.data.email = storage.data.email;\n      }\n      if(storage.data.login) {\n        verto.data.login = storage.data.login;\n      }\n      if(storage.data.password) {\n        verto.data.password = storage.data.password;\n      }\n\n      /*\n       * Load the Configs before logging in\n       * with cache buster\n       */\n      var url = window.location.origin + window.location.pathname;\n      var httpRequest = $http.get(url + 'config.json?cachebuster=' + Math.floor((Math.random()*1000000)+1));\n\n      var httpReturn = httpRequest.then(function(response) {\n        var data = response.data;\n\n        /* save these for later as we're about to possibly over write them */\n        var name = verto.data.name;\n        var email = verto.data.email;\n\n        console.debug(\"googlelogin: \" + data.googlelogin);\n        if (data.googlelogin){\n          verto.data.googlelogin = data.googlelogin;\n          verto.data.googleclientid = data.googleclientid;\n        }\n\n        angular.extend(verto.data, data);\n\n        /**\n         * use stored data (localStorage) for login, allow config.json to take precedence\n         */\n\n        if (name != '' && data.name == '') {\n          verto.data.name = name;\n        }\n        if (email != '' && data.email == '') {\n          verto.data.email = email;\n        }\n        if (verto.data.login == '' && verto.data.password == '' && storage.data.login != '' && storage.data.password != '') {\n          verto.data.login = storage.data.login;\n          verto.data.password = storage.data.password;\n        }\n\n        if (verto.data.autologin == \"true\" && !verto.data.autologin_done) {\n          console.debug(\"auto login per config.json\");\n          verto.data.autologin_done = true;\n        }\n\n        if(verto.data.autologin && storage.data.name.length && storage.data.email.length && storage.data.login.length && storage.data.password.length) {\n          $rootScope.$emit('config.http.success', data);\n        };\n        return response;\n      }, function(response) {\n        $rootScope.$emit('config.http.error', response);\n        return response;\n      });\n\n      return httpReturn;\n    };\n\n    return {\n      'configure': configure\n    };\n  }]);\n\n'use strict';\n\n  angular\n    .module('vertoService')\n    .service('eventQueue', ['$rootScope', '$q', 'storage', 'verto',\n      function($rootScope, $q, storage, verto) {\n        \n        var events = [];\n        \n        var next = function() {\n          var fn, fn_return;\n          \n          fn = events.shift();\n          \n          if (fn == undefined) {\n            $rootScope.$emit('eventqueue.complete');\n            return;\n          }\n          fn_return = fn();\n\n          var emitNextProgress = function() {\n            $rootScope.$emit('eventqueue.next');\n          };\n\n          fn_return.then(\n            function() {\n              emitNextProgress();\n            }, \n            function() {\n              emitNextProgress();\n            }\n          );\n        };\n\n        var process = function() {\n          $rootScope.$on('eventqueue.next', function (ev){\n            next();\n          });\n          \n          next(); \n        };\n\n        return {\n          'next': next,\n          'process': process,\n          'events': events\n        };\n\n      }]);\n \n\n(function() {\n  'use strict';\n  var vertoService = angular.module('storageService', ['ngStorage']);\n})();\n\n'use strict';\n\n  angular\n  .module('storageService')\n  .service('storage', ['$rootScope', '$localStorage',\n  function($rootScope, $localStorage) {\n    var data = $localStorage,\n\tdefaultSettings = {\n\t  ui_connected: false,\n          ws_connected: false,\n          cur_call: 0,\n          called_number: '',\n          useVideo: true,\n          call_history: {},\n          history_control: [],\n          call_start: false,\n          name: '',\n          email: '',\n          login: '',\n          password: '',\n          userStatus: 'disconnected',\n          mutedVideo: false,\n          mutedMic: false,\n          preview: true,\n          selectedVideo: null,\n          selectedVideoName: null,\n          selectedAudio: null,\n          selectedShare: null,\n          selectedSpeaker: null,\n          useStereo: true,\n          useSTUN: true,\n          useDedenc: false,\n          mirrorInput: false,\n          outgoingBandwidth: 'default',\n          incomingBandwidth: 'default',\n          vidQual: undefined,\n          askRecoverCall: false,\n          googNoiseSuppression: true,\n          googHighpassFilter: true,\n          googEchoCancellation: true,\n          googAutoGainControl: true,\n          autoBand: true,\n          testSpeedJoin: true,\n          bestFrameRate: \"15\",\n          language: undefined\n       };\n\n    data.$default(defaultSettings);\n\n    function changeData(verto_data) {\n      jQuery.extend(true, data, verto_data);\n    }\n\n    return {\n      data: data,\n      changeData: changeData,\n      reset: function() {\n        data.ui_connected = false;\n        data.ws_connected = false;\n        data.cur_call = 0;\n        data.userStatus = 'disconnected';\n      },\n      factoryReset: function() {\n        localStorage.clear();\n        // set defaultSettings again\n        data.$reset(defaultSettings);\n      },\n    };\n  }\n]);\n\n'use strict';\n\n  angular\n  .module('storageService')\n  .factory('CallHistory', [\"storage\", function(storage) {\n\n    var history = storage.data.call_history;\n    var history_control = storage.data.history_control;\n\n    var addCallToHistory = function(number, direction, status) {\n      if(history[number] == undefined) {\n        history[number] = [];\n      }\n\n      history[number].unshift({\n        'number': number,\n        'direction': direction,\n        'status': status,\n        'call_start': Date()\n      });\n\n      var index = history_control.indexOf(number);\n      console.log(index);\n      if(index > -1) {\n        history_control.splice(index, 1);\n      }\n\n      history_control.unshift(number);\n\n    };\n\n    var getCallsFromHistory = function(number) {\n      return history[number];\n    };\n\n    return {\n      all: function() {\n        return history;\n      },\n      all_control: function() {\n        return history_control;\n      },\n      get: function(number) {\n        return getCallsFromHistory(number);\n      },\n      add: function(number, direction, status) {\n        return addCallToHistory(number, direction, status);\n      },\n      clear: function() {\n        storage.data.call_history = {};\n        storage.data.history_control = [];\n        history = storage.data.call_history;\n        history_control = storage.data.history_control;\n        return history_control;\n      }\n    }\n}]);\n\n'use strict';\n\n  angular\n    .module('storageService')\n    .service('splashscreen', ['$rootScope', '$q', 'storage', 'config', 'verto', '$translate',\n      function($rootScope, $q, storage, config, verto, $translate) {\n\n        var checkBrowser = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'browser-upgrade';\n            var result = {\n              'activity': activity,\n              'soft': false,\n              'status': 'success',\n              'message': $translate.instant('BROWSER_COMPATIBILITY')\n            };\n            if (!navigator.mediaDevices.getUserMedia) {\n              result['status'] = 'error';\n              result['message'] = $translate.instant('BROWSER_WITHOUT_WEBRTC');\n              reject(result);\n            }\n\n            resolve(result);\n\n          });\n        };\n\n        var checkMediaPerm = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'media-perm';\n            var result = {\n              'activity': activity,\n              'soft': false,\n              'status': 'success',\n              'message': $translate.instant('CHECK_PERMISSION_MEDIA')\n            };\n\n            verto.mediaPerm(function(status) {\n              if(!status) {\n                result['status'] = 'error';\n                result['message'] = $translate.instant('ERROR_PERMISSION_MEDIA');\n                verto.data.mediaPerm = false;\n                reject(result);\n              }\n              verto.data.mediaPerm = true;\n              resolve(result);\n            });\n          });\n        };\n\n        var refreshMediaDevices = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'refresh-devices';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('REFRESH_MEDIA_DEVICES')\n            };\n\n            verto.refreshDevices(function(status) {\n              verto.refreshDevicesCallback(function() {\n                resolve(result);\n              });\n            });\n\n          });\n        };\n\n        var checkConnectionSpeed = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'check-connection-speed';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_CONNECTION_SPEED')\n            };\n\n            if (storage.data.autoBand && verto.data.instance) {\n              verto.testSpeed(cb);\n            } else {\n              resolve(result);\n            }\n\n            function cb(data) {\n              resolve(result);\n            }\n          });\n        };\n\n        var provisionConfig = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'provision-config';\n            var result = {\n              'status': 'promise',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_PROVISIONING_CONF')\n            };\n\n            var configResponse = config.configure();\n\n            var configPromise = configResponse.then(\n              function(response) {\n                /**\n                 * from angular docs:\n                 * A response status code between 200 and 299 is considered a success status and will result in the success callback being called\n                 */\n                if(response.status >= 200 && response.status <= 299) {\n                  return result;\n                } else {\n                  result['status'] = 'error';\n                  result['message'] = $translate.instant('ERROR_PROVISIONING_CONF');\n                  return result;\n                }\n              });\n\n              result['promise'] = configPromise;\n\n              resolve(result);\n          });\n        };\n\n        var checkLogin = function() {\n          return $q(function(resolve, reject) {\n            var activity = 'check-login';\n            var result = {\n              'status': 'success',\n              'soft': true,\n              'activity': activity,\n              'message': $translate.instant('CHECK_LOGIN'),\n            };\n\n            if(verto.data.connecting || verto.data.connected) {\n              resolve(result);\n              return;\n            };\n\n            var checkUserStored = function() {\n              /**\n               * if user data saved, use stored data for logon and not connecting\n               * not connecting prevent two connects\n               */\n              if (storage.data.ui_connected && storage.data.ws_connected && !verto.data.connecting) {\n                verto.data.hostname = storage.data.hostname || verto.data.hostname;\n                verto.data.wsURL = storage.data.wsURL || verto.data.wsURL;\n                verto.data.name = storage.data.name;\n                verto.data.email = storage.data.email;\n                verto.data.login = storage.data.login;\n                verto.data.password = storage.data.password;\n\n                verto.data.connecting = true;\n                verto.connect(function(v, connected) {\n                  verto.data.connecting = false;\n                  resolve(result);\n                });\n              };\n            };\n\n            if(storage.data.ui_connected && storage.data.ws_connected) {\n              checkUserStored();\n            } else {\n              resolve(result);\n            };\n          });\n        };\n\n        var progress = [\n          checkBrowser,\n          checkMediaPerm,\n          refreshMediaDevices,\n          provisionConfig,\n          checkLogin,\n          checkConnectionSpeed\n        ];\n\n        var progress_message = [\n          $translate.instant('BROWSER_COMPATIBILITY'),\n          $translate.instant('CHECK_PERMISSION_MEDIA'),\n          $translate.instant('REFRESH_MEDIA_DEVICES'),\n          $translate.instant('CHECK_PROVISIONING_CONF'),\n          $translate.instant('CHECK_LOGIN'),\n          $translate.instant('CHECK_CONNECTION_SPEED'),\n        ];\n\n        var getProgressMessage = function(current_progress) {\n          if(progress_message[current_progress] != undefined) {\n            return progress_message[current_progress];\n          } else {\n            return $translate.instant('PLEASE_WAIT');\n          }\n        };\n\n        var current_progress = -1;\n        var progress_percentage = 0;\n\n        var calculateProgress = function(index) {\n          var _progress;\n\n          _progress = index + 1;\n          progress_percentage = (_progress / progress.length) * 100;\n          return progress_percentage;\n        };\n\n        var nextProgress = function() {\n          var fn, fn_return, status, interrupt, activity, soft, message, promise;\n          interrupt = false;\n          current_progress++;\n\n          if(current_progress >= progress.length) {\n            $rootScope.$emit('progress.complete', current_progress);\n            return;\n          }\n\n          fn = progress[current_progress];\n          fn_return = fn();\n\n          var emitNextProgress = function(fn_return) {\n            if(fn_return['promise'] != undefined) {\n              promise = fn_return['promise'];\n            }\n\n            status = fn_return['status'];\n            soft = fn_return['soft'];\n            activity = fn_return['activity'];\n            message = fn_return['message'];\n\n            if(status != 'success') {\n              interrupt = true;\n            }\n\n            $rootScope.$emit('progress.next', current_progress, status, promise, activity, soft, interrupt, message);\n\n          };\n\n          fn_return.then(\n            function(fn_return) {\n              emitNextProgress(fn_return);\n            },\n            function(fn_return) {\n              emitNextProgress(fn_return);\n            }\n          );\n\n        };\n\n        return {\n          'next': nextProgress,\n          'getProgressMessage': getProgressMessage,\n          'progress_percentage': progress_percentage,\n          'calculate': calculateProgress\n        };\n\n      }]);\n"]}